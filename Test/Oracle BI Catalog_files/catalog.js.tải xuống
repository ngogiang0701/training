if(!saw.catalog.CatalogModel){saw.catalog.CatalogBrowser=function(f,g,c,b,e,d,a){this.resourceManager=obips.ResourceManager.getSingleton();this.webCatalogManager=saw.catalog.getCatalogManager();this.dragdrop=d;this.multiPanelPane=new saw.catalog.MultiPanelPane(this,g,c,e,d,a);this.objectList=b?b:new saw.catalog.ObjectList(this.webCatalogManager,null,null,null,d,a);this.objectList.addEventListener(new obips.Observable.EventListener(saw.catalog.ObjectList.EventType.ITEM_EXEC_ACTION,new obips.Callback(this,this.objectListItemExecActionHandler)))};saw.catalog.CatalogBrowser.prototype.getLocalizedString=function(a){return saw.catalog.getLocalizedString.apply(null,arguments)};saw.catalog.CatalogBrowser.prototype.isVpatMode=function(){return saw.getSessionInfos().isEnableSection508()};saw.catalog.CatalogBrowser.prototype.renderPanelSelectToolbar=function(a){var d=new Array();var c=new obips.UberBar.IconSet(saw.catalog.getImgUrl("catalog/treeview_ena.png"),saw.catalog.getImgUrl("catalog/treeview_dis.png"),saw.catalog.getImgUrl("catalog/treeview_ovr.png"),saw.catalog.getImgUrl("catalog/treeview_dwn.png"));var b=new obips.UberBar.IconButtonModel("folderTree",c,this.getLocalizedString("kmsgCatalogShowFolderTree"),new obips.Callback(this,this.onFolderTreeButtonPress),true,true);b.isDown=true;d.push(b);c=new obips.UberBar.IconSet(saw.catalog.getImgUrl("catalog/favoritefolderclose_ena.png"),saw.catalog.getImgUrl("catalog/favoritefolderclose_dis.png"),saw.catalog.getImgUrl("catalog/favoritefolderclose_ovr.png"),saw.catalog.getImgUrl("catalog/favoritefolderclose_dwn.png"));b=new obips.UberBar.IconButtonModel("favoriteFolders",c,this.getLocalizedString("kmsgCatalogShowFavorites"),new obips.Callback(this,this.onFavoriteFolderButtonPress),true,true);d.push(b);var e=false;this.panelSelectToolbarModel=new obips.UberBar.Model("viewSwitchToolbar"+new Date().valueOf(),d,e);saw.removeAllChildren(a);this.panelSelectToolbarViewer=new obips.UberBar.Viewer(this.panelSelectToolbarModel,a)};saw.catalog.CatalogBrowser.prototype.showHiddenItems=function(a){if(a){this.multiPanelPane.folderTreeViewer.treeViewer.viewModel.showSystemNodes();this.objectList.showHiddenItems()}else{this.multiPanelPane.folderTreeViewer.treeViewer.viewModel.hideSystemNodes();this.objectList.hideHiddenItems()}};saw.catalog.CatalogBrowser.prototype.setItemInfoDetailLevel=function(a){this.itemInfoDetailLevel=a};saw.catalog.CatalogBrowser.prototype.getItemInfoDetailLevel=function(){return this.itemInfoDetailLevel};saw.catalog.CatalogBrowser.prototype.openFolderInListView=function(b,a){this.setItemInfoDetailLevel(a);this.objectList.showFolderContent(b,this.getItemInfoDetailLevel());this.addFolderToRecentList(b)};saw.catalog.CatalogBrowser.prototype.onFolderTreeButtonPress=function(){this.panelSelectToolbarViewer.model.setToggleState("folderTree",true);this.panelSelectToolbarViewer.model.setToggleState("favoriteFolders",false);this.multiPanelPane.switchPanel("folderTree")};saw.catalog.CatalogBrowser.prototype.onFavoriteFolderButtonPress=function(){this.panelSelectToolbarViewer.model.setToggleState("favoriteFolders",true);this.panelSelectToolbarViewer.model.setToggleState("folderTree",false);this.multiPanelPane.switchPanel("favoriteFolders")};saw.catalog.CatalogBrowser.State=function(a,c,d,e,b){this.action=a;this.location=c;this.mask=d;this.type=e;this.favorite=b};saw.catalog.CatalogBrowser.prototype.setState=function(c,b,a){this.currentState=c};saw.catalog.CatalogBrowser.prototype.folderTreeFolderOpenHandler=function(c){var d=c.context;if(saw.getSessionInfos().isEnableSection508()){this.openFolderInListView(unescape(d.id),null)}else{this.openFolderInListView(d.id,null)}this.setState({location:c.context.id},true,c.context.itemInfo.caption);var a=c.context.itemInfo.path;if(a){var b=saw.storage.ClientStorageManager.getSingleton();b.setState(saw.catalog.StateID.LAST_OPEN_FOLDER,a)}};saw.catalog.CatalogBrowser.prototype.openFolder=function(a){if(a==saw.catalogtree.ksVirtualRootNodeId){return}this.multiPanelPane.folderTreeViewer.openFolder(null,a,true,true);this.openFolderInListView(a,null);var b=saw.storage.ClientStorageManager.getSingleton();b.setState(saw.catalog.StateID.LAST_OPEN_FOLDER,a)};saw.catalog.CatalogBrowser.prototype.selectFivoriteLink=function(a){this.showFavoritesPanel();this.multiPanelPane.favoritesList.selectById(a)};saw.catalog.CatalogBrowser.prototype.addFolderToRecentList=function(c,a){var b=this.locationSelector||this.locationSelect;if(!b){return}if(c){if(!a){a=this.multiPanelPane.folderTreeModel.getDisplayPath(c)}if(!a){a=saw.catalog.getCatalogDisplayPath(c)}}if(b.options.length>0&&b.options[0].value==""){b.remove(0)}saw.catalog.forceSelectValue(b,c,a);if(b.options.length>20){b.remove(b.options.length-1)}b.title=a};saw.catalog.CatalogBrowser.prototype.clearRecentFolderList=function(){if(this.locationSelector){this.locationSelector.length=0}};saw.catalog.CatalogBrowser.prototype.removedPathsFromRecentList=function(c){var b=this.locationSelector;for(var a=0;b&&a<b.options.length;++a){if(obips.Array.contains(c,b.options[a].value)){this.locationSelector.remove(a)}}};saw.catalog.CatalogBrowser.prototype.getCurrentFolderPath=function(){return this.objectList.folderPath};saw.catalog.CatalogBrowser.prototype.canOpenParentFolder=function(e){var d=e?e[0].id:this.getCurrentFolderPath();var c=false;var a=this.multiPanelPane.folderTreeModel;if(d){var b=a.getNode(d);if(!b||a.getParentNode(b)!=a.getRootNode()){c=true}}return c};saw.catalog.CatalogBrowser.prototype.openParentFolder=function(){var a=this.getCurrentFolderPath();var b=this.multiPanelPane.folderTreeModel.getNode(a);if(b){this.openFolder(b.parentID)}else{this.openFolder(saw.getFolder(a))}if(this.multiPanelPane.favoritesList){this.multiPanelPane.favoritesList.clearSelection()}};saw.catalog.CatalogBrowser.prototype.displayNewFolderDialog=function(){var c=(this.objectList&&this.objectList.getCurrentFolderItems());var b=new saw.catalog.NewFolderDialogModel(new obips.Callback(this,this.newFolderDialogOKHandler),null,this.getCurrentFolderPath(),c);var a=saw.catalog.getResUrl("newFolderDialogHelp");b.setHelpModel(a);return new saw.catalog.NewFolderDialogViewer(b)};saw.catalog.CatalogBrowser.prototype.newFolderDialogOKHandler=function(a){this.createNewFolder(a.name)};saw.catalog.CatalogBrowser.prototype.createNewFolder=function(a){new saw.catalog.CatalogManagerHelper(this.getItemInfoDetailLevel()).createFolder(this.getCurrentFolderPath(),a,this.onNewFolderCreated?new obips.Callback(this,this.onNewFolderCreated):null)};saw.catalog.CatalogBrowser.prototype.copyToClipboard=function(a){new saw.catalog.CatalogManagerHelper(this.getItemInfoDetailLevel()).copyToClipboard(a)};saw.catalog.CatalogBrowser.prototype.pasteItems=function(a){if(!a){a=this.getCurrentFolderPath()}if(a){new saw.catalog.CatalogManagerHelper(this.getItemInfoDetailLevel()).pasteItems(a)}else{alert("No target folder specified.")}};saw.catalog.CatalogBrowser.prototype.copyItems=function(a,b){new saw.catalog.CatalogManagerHelper(this.getItemInfoDetailLevel()).copyItems(a,b)};saw.catalog.CatalogBrowser.prototype.moveItems=function(a,b){new saw.catalog.CatalogManagerHelper(this.getItemInfoDetailLevel()).moveItems(a,b)};saw.catalog.CatalogBrowser.prototype.deleteItems=function(a,b){new saw.catalog.CatalogManagerHelper(this.getItemInfoDetailLevel()).deleteItems(a,b)};saw.catalog.CatalogBrowser.prototype.createLink=function(a){this.webCatalogManager.createLink(a.path,saw.getFolder(a.path),a.caption,this.getItemInfoDetailLevel(),new obips.Callback(this,this.createLinkCB))};saw.catalog.CatalogBrowser.prototype.createLinkCB=function(a){var b=a.getErrorMessage();if(b){saw.catalog.showError(b)}};saw.catalog.CatalogBrowser.prototype.objectListItemExecActionHandler=function(a){this.handleListItemAction(a.context.listItem,a.context.action,a.context.evt)};saw.catalog.CatalogBrowser.prototype.handleListItemAction=function(c,b,a){this.handleItemAction(c.itemInfo,b,a)};saw.catalog.CatalogBrowser.prototype.handleItemAction=function(g,f,b){var c=new saw.catalogaction.ActionContext(null,b);if(saw.catalogaction.getActionManager().handleAction(f,g.path,g.signature,g,this.getCurrentFolderPath(),c)){return true}switch(f){case saw.catalogaction.ActionId.EXPAND:this.openFolder(g.targetPath&&(!saw.catalog.isMyCompanySharedFolder(g))?g.targetPath:g.path);return true;case saw.catalogaction.ActionId.ARCHIVE:var d=new saw.catalog.ArchiveDialogModel(g.path);var a=saw.catalog.getResUrl("archiveDialogHelp");d.setHelpModel(a);new saw.catalog.ArchiveDialogViewer(d);return true;case saw.catalogaction.ActionId.UNARCHIVE:var e=new saw.catalog.UploadOperationOrchestrator();var d=new saw.catalog.UnArchiveDialogModel(g.targetPath?g.targetPath:g.path,e.getStartUploadCallback());var a=saw.catalog.getResUrl("uploadArchiveDialogHelp");d.setHelpModel(a);new saw.catalog.UnArchiveDialogViewer(d);return true;case saw.catalogaction.ActionId.UPLOAD:var e=new saw.catalog.UploadOperationOrchestrator();var d=new saw.catalog.UploadDialogModel(g.targetPath?g.targetPath:g.path,e.getStartUploadCallback());new saw.catalog.UploadDialogViewer(d);return true;case saw.catalogaction.ActionId.RSS:obips.launcher.launchNewWindow(saw.commandToURL("RssFoldersEntry")+"&Folder="+saw.encodeURIComponent(g.path),"SAWRssFeed");return true;case saw.catalogaction.ActionId.RENAME:new saw.catalog.CatalogManagerHelper(this.getItemInfoDetailLevel()).renameItem(g);return true;case saw.catalogaction.ActionId.LINK:this.createLink(g);return true;case saw.catalogaction.ActionId.DELETE:this.deleteItems([g]);return true;case saw.catalogaction.ActionId.COPY:this.copyToClipboard([g]);return true;case saw.catalogaction.ActionId.PASTE:this.pasteItems(g.path);return true;default:return false}return false};saw.catalog.CatalogBrowser.prototype.getFolderTreeId=function(a){return this.multiPanelPane.folderTreeViewer.getTreeId()};saw.catalog.MultiPanelPane=function(b,f,c,e,d,a){this.parent=b;this.folderTreeModel=f;this.favoritesList=c;this.noSearchPanel=e;this.dragdrop=d;this.defaultDndGroup=a};saw.catalog.MultiPanelPane.prototype.render=function(c,a){this.container=c;this.panelSelector=new saw.layout.SinglePaneSelector(c);var b=this.container.ownerDocument;var d=b.createElement("div");d.id=a?a:"tree"+new Date().valueOf();d.style.overflow="hidden";this.panelSelector.addElementAsChild(d);this.folderTreeContainer=d;d=b.createElement("div");d.style.overflow="auto";this.panelSelector.addElementAsChild(d);this.shortCutListContainer=d;if(!this.noSearchPanel){d=b.createElement("div");d.style.overflow="auto";this.panelSelector.addElementAsChild(d);this.searchPanelContainer=d}this.panelSelector.onResize();this.renderFolderTree()};saw.catalog.MultiPanelPane.prototype.renderFolderTree=function(){var b=this.parent.webCatalogManager;if(!this.folderTreeModel){var a=saw.catalogtree.createRootNode();this.folderTreeModel=new saw.catalogtree.Model(b,a,new saw.catalog.ObjectFilter(true))}if(this.folderTreeModel.rootTreeNode.id==saw.catalogtree.ksVirtualRootNodeId&&!this.folderTreeModel.rootTreeNode.childNodeIDs){this.folderTreeModel.addDefaultVirtualNodesToRoot(saw.getSessionInfos().user.homeDir)}this.folderTreeViewer=new saw.catalogtree.Viewer(this.folderTreeModel,this.folderTreeContainer,null,this.dragdrop,this.defaultDndGroup)};saw.catalog.MultiPanelPane.prototype.onFavoriteFolderSelected=function(d){var b=d.context.content;var a=this.parent;b.showResultContent(a);var c=b.getRecentListEntry(a);a.addFolderToRecentList(c.value,c.caption);a.setState({action:"favorite",favorite:b.id},true,b.caption)};saw.catalog.MultiPanelPane.prototype.switchPanel=function(a){if(a=="folderTree"){this.panelSelector.displayPane(0);this.folderTreeViewer.openFolder(null,this.parent.getCurrentFolderPath(),true,true)}else{if(a=="search"){this.panelSelector.displayPane(2);if(!this.searchPanel){this.searchPanel=new saw.catalog.SearchPanel(new obips.Callback(this.parent,this.parent.search),saw.catalog.resourceFile);this.searchPanel.render(this.panelSelector.getChild(2).getDomNode())}}else{this.panelSelector.displayPane(1);if(!this.favoritesList){this.favoritesList=new saw.catalog.FavoritesList(null)}if(!this.favoritesList.isRendered()){this.favoritesList.render(this.shortCutListContainer);this.favoritesList.listViewer.viewModel.addEventListener(new obips.Observable.EventListener(saw.list.ViewModel.EventType.ITEM_SELECTED,new obips.Callback(this,this.onFavoriteFolderSelected)))}else{this.favoritesList.clearSelection()}this.folderTreeViewer.deactivateNode()}this.folderTreeViewer.deactivateNode()}};saw.catalog.FavoritesList=function(a){this.resourceManager=obips.ResourceManager.getSingleton();this.favorites=a?a:saw.catalog.FavoritesList.getDefaultFavoritesList()};saw.catalog.FavoritesList.prototype.setFavorites=function(a){this.favorites=a;if(this.listModel){var c=new Array;for(var b=0;b<this.favorites.length;b++){c.push(new saw.list.ItemModel(this.favorites[b]))}this.listModel.setItems(c)}};saw.catalog.FavoritesList.prototype.render=function(a){this.container=a;this.listModel=new saw.list.Model();this.setFavorites(this.favorites);this.listViewer=new saw.list.Viewer(this.listModel,this.container,saw.list.ViewModel.SelectionType.SINGLE,null,false,null,new saw.list.ViewStyle(null,null,null,null,"CatalogFavoriteFolderCell"))};saw.catalog.FavoritesList.prototype.isRendered=function(){return this.listViewer!=null};saw.catalog.FavoritesList.prototype.selectById=function(a){var c=null;for(var b=0;b<this.listModel.items.length;b++){if(this.listModel.items[b].content.id==a){c=this.listModel.items[b];break}}if(c){this.listViewer.viewModel.selectSingleItem(c)}};saw.catalog.FavoritesList.prototype.clearSelection=function(){if(this.listViewer){this.listViewer.viewModel.clearItemSelection()}};saw.catalog.FavoritesList.DefaultFolders={};saw.catalog.FavoritesList.DefaultFolders.FAV_HOME=1;saw.catalog.FavoritesList.DefaultFolders.FAV_GLOBAL_SHARED=2;saw.catalog.FavoritesList.DefaultFolders.FAV_COMPANY_SHARED=4;saw.catalog.FavoritesList.DefaultFolders.FAV_SHARED=6;saw.catalog.FavoritesList.DefaultFolders.FAV_DEFAULT=7;saw.catalog.FavoritesList.getDefaultFavoritesList=function(e,c){var a=new Array;var b=saw.getSessionInfos();var d=saw.catalog.FavoritesList.DefaultFolders;c=c||saw.catalog.FavoritesList.DefaultFolders.FAV_DEFAULT;if(b.privileges.personalStorage&&(c&d.FAV_HOME)){a.push(new saw.catalog.FavoritesList.Folder("myFolders",saw.catalog.getLocalizedString("kmsgCatalogFavoriteFolderMyFolder"),saw.catalog.getImgUrl("catalog/folder_m.png"),b.user.homeDir))}if(saw.getSessionInfos().getTenancyMode()!==saw.session.SessionInfos.MULTIPLE_SERVICE_INSTANCE_BICS&&(c&d.FAV_GLOBAL_SHARED)){a.push(new saw.catalog.FavoritesList.Folder("sharedFolders",saw.catalog.getLocalizedString("kmsgCatalogSharedFolder"),saw.catalog.getImgUrl("catalog/folder_m.png"),"/shared"))}if((b.isMultitenantMode()||saw.getSessionInfos().getTenancyMode()===saw.session.SessionInfos.MULTIPLE_SERVICE_INSTANCE_BICS)&&(c&d.FAV_COMPANY_SHARED)){a.push(new saw.catalog.FavoritesList.Folder("companySharedFolders",saw.catalog.getLocalizedString("kmsgCatalogFriendlyMTCompanyShared"),saw.catalog.getImgUrl("catalog/folder_m.png"),"/company_shared"))}if(!e){if(saw.catalog.getPrivilege("canAccessAnswers")){a.push(new saw.catalog.FavoritesList.Search("myRequestSearch",saw.catalog.getLocalizedString("kmsgCatalogFavoriteFolderMyRequest"),saw.catalog.getImgUrl("catalog/favorite_search.png"),"*",b.user.homeDir,saw.catalog.ItemCategory.REQUEST))}if(saw.catalog.getPrivilege("canAccessBIPReportOutput")){a.push(new saw.catalog.FavoritesList.Search("myReportSearch",saw.catalog.getLocalizedString("kmsgBIHMyReports"),saw.catalog.getImgUrl("catalog/favorite_search.png"),"*",b.user.homeDir,saw.catalog.ItemCategory.REPORT))}if(saw.catalog.getPrivilege("canAccessScorecard")){a.push(new saw.catalog.FavoritesList.Search("myBSCSearch",saw.catalog.getLocalizedString("kmsgBIHMyScorecards"),saw.catalog.getImgUrl("catalog/favorite_search.png"),"*",b.user.homeDir,saw.catalog.ItemCategory.BSC))}if(saw.catalog.getPrivilege("canAccessAgents")){a.push(new saw.catalog.FavoritesList.CustomSearch("mySubscription",saw.catalog.getLocalizedString("kmsgBIHMyIBotSubscriptions"),saw.catalog.getImgUrl("catalog/favorite_search.png"),"subscribedIbots",null,new obips.catalog.ItemInfoDetailLevel(obips.catalog.ExtendedAttrLevel.GREEDY)));a.push(new saw.catalog.FavoritesList.Search("myIbots",saw.catalog.getLocalizedString("kmsgBIHMyIBots"),saw.catalog.getImgUrl("catalog/favorite_search.png"),"*",b.user.homeDir,saw.catalog.ItemCategory.IBOT))}}return a};saw.catalog.FavoritesList.Item=function(d,a,c,b){this.id=d;this.caption=a;this.icon=c;this.itemInfoDetailLevel=b};saw.extend(saw.catalog.FavoritesList.Item,saw.list.ItemContent);saw.catalog.FavoritesList.Item.prototype.getViewer=function(){var d=document;var b=d.createElement("span");b.className="CatalogFavoriteFolder";if(this.desc){b.setAttribute("title",this.desc)}if(this.icon){var a=d.createElement("img");a.src=this.icon;a.alt="";b.appendChild(a)}var c=saw.createChildElement(b,"span");var e=d.createTextNode((this.icon?"  ":"")+this.caption);c.appendChild(e);return b};saw.catalog.FavoritesList.Item.prototype.getRecentListEntry=function(a){return{value:"",caption:this.caption}};saw.catalog.FavoritesList.Item.prototype.showResultContent=function(a){alert("under construction.")};saw.catalog.FavoritesList.Folder=function(e,a,b,d,c){saw.catalog.FavoritesList.Folder.baseConstructor.call(this,e,a,b,c);this.folder=d};saw.extend(saw.catalog.FavoritesList.Folder,saw.catalog.FavoritesList.Item);saw.catalog.FavoriteFolder=saw.catalog.FavoritesList.Folder;saw.catalog.FavoritesList.Folder.prototype.getRecentListEntry=function(){return{value:this.folder,caption:saw.catalog.getCatalogDisplayPath(this.folder)}};saw.catalog.FavoritesList.Folder.prototype.showResultContent=function(a){a.openFolderInListView(this.folder,this.itemInfoDetailLevel)};saw.catalog.FavoritesList.Search=function(g,b,e,c,a,d,f){saw.catalog.FavoritesList.Search.baseConstructor.call(this,g,b,e,f);this.searchTarget=new saw.catalog.SearchTarget(c,a,d)};saw.extend(saw.catalog.FavoritesList.Search,saw.catalog.FavoritesList.Item);saw.catalog.FavoritesList.Search.prototype.showResultContent=function(a){a.setItemInfoDetailLevel(this.itemInfoDetailLevel);a.objectList.showSearchResult(this.searchTarget,a.getItemInfoDetailLevel())};saw.catalog.FavoritesList.CustomSearch=function(f,a,b,e,d,c){saw.catalog.FavoritesList.CustomSearch.baseConstructor.call(this,f,a,b,c);this.customSearch=new obips.catalog.CustomSearchDef(e,d)};saw.extend(saw.catalog.FavoritesList.CustomSearch,saw.catalog.FavoritesList.Item);saw.catalog.FavoritesList.CustomSearch.prototype.showResultContent=function(a){a.setItemInfoDetailLevel(this.itemInfoDetailLevel);a.objectList.showCustomSearchResult(this.customSearch,a.getItemInfoDetailLevel())};saw.catalog.FavoritesList.CallbackItem=function(f,b,c,e,a,d){saw.catalog.FavoritesList.CallbackItem.baseConstructor.call(this,f,b,c,d);this.onSelectCallback=e;this.context=a};saw.extend(saw.catalog.FavoritesList.CallbackItem,saw.catalog.FavoritesList.Item);saw.catalog.FavoritesList.CallbackItem.prototype.showResultContent=function(a){a.setItemInfoDetailLevel(this.itemInfoDetailLevel);this.onSelectCallback.exec(this,a)};saw.catalog.SearchPanel=function(a,b){this.searchCallback=a;this.resourceManager=obips.ResourceManager.getSingleton();this.resourceFile=b?b:saw.catalog.resourceFile;this.rendered=false};saw.catalog.SearchPanel.prototype.render=function(a){if(this.rendered){return}this.rendered=true;var g=a.ownerDocument;this.searchPanelDiv=a;var e=saw.createTable();e.style.margin="4px";a.appendChild(e);this.tTable=e;if(saw.catalog.getPrivilege("bUseBISearchWithFacetUI")){var h=e.insertRow(e.rows.length);var d=h.insertCell(0);d.className="XUIPromptEntry FitToParentWidth";var c=g.createElement("input");c.type="text";c.className="FitToParentWidth";d.appendChild(c);this.input=c;var i=this;this.input.onchange=function(k){i.nameInputChangedHandler(k)};this.input.onkeyup=function(k){i.nameInputChangedHandler(k)};d=h.insertCell(1);d.className="XUIPromptEntry";var f=this.resourceManager.getResource(this.resourceFile,"kmsgCatalogButtonTipSearch").getString();this.searchButton=new obips.FormFields.Button("idCatalogSearchButton","idCatalogSearchButton",f,false,new obips.Callback(this,this.search));d.appendChild(this.searchButton.getElement())}else{var h=e.insertRow(e.rows.length);var d=h.insertCell(0);d.className="masterPrompt XUIPromptCaption";saw.appendTextNode(d,this.resourceManager.getResource(this.resourceFile,"kmsgCatalogSearchCriteria").getString());d=h.insertCell(1);d.className="XUIPromptEntry FitToParentWidth";var c=g.createElement("input");c.type="text";c.className="FitToParentWidth";d.appendChild(c);this.input=c;var i=this;this.input.onchange=function(k){i.nameInputChangedHandler(k)};this.input.onkeyup=function(k){i.nameInputChangedHandler(k)};h=e.insertRow(e.rows.length);d=h.insertCell(0);d.className="masterPrompt XUIPromptCaption";saw.appendTextNode(d,this.resourceManager.getResource(this.resourceFile,"kmsgCatalogSearchLocation").getString());d=h.insertCell(1);d.className="XUIPromptEntry";var j=g.createElement("select");var b=document.createElement("option");b.value="all";b.text=this.resourceManager.getResource(this.resourceFile,"kmsgCatalogSearchLocationAll").getString();j.options.add(b);if(saw.getSessionInfos().privileges.personalStorage){b=document.createElement("option");b.value=saw.getSessionInfos().user.homeDir;b.text=this.resourceManager.getResource(this.resourceFile,"kmsgCatalogFavoriteFolderMyFolder").getString();j.options.add(b)}if(saw.getSessionInfos().getTenancyMode()!==saw.session.SessionInfos.MULTIPLE_SERVICE_INSTANCE_BICS){b=document.createElement("option");b.value="/shared";b.text=this.resourceManager.getResource(this.resourceFile,"kmsgCatalogSharedFolder").getString();j.options.add(b)}if(saw.getSessionInfos().isMultitenantMode()||saw.getSessionInfos().getTenancyMode()===saw.session.SessionInfos.MULTIPLE_SERVICE_INSTANCE_BICS){b=document.createElement("option");b.value="/company_shared";b.text=this.resourceManager.getResource(this.resourceFile,"kmsgCatalogFriendlyMTCompanyShared").getString();j.options.add(b)}d.appendChild(j);this.locationSelector=j;h=e.insertRow(e.rows.length);d=h.insertCell(0);d.className="masterPrompt XUIPromptCaption";saw.appendTextNode(d,this.resourceManager.getResource(this.resourceFile,"kmsgCatalogSearchType").getString());d=h.insertCell(1);d.className="XUIPromptEntry";j=g.createElement("select");saw.header.populateTypeSelector(j);d.appendChild(j);this.typeSelector=j;h=e.insertRow(e.rows.length);h.insertCell(0);d=h.insertCell(1);var f=this.resourceManager.getResource(this.resourceFile,"kmsgCatalogButtonTipSearch").getString();this.searchButton=new obips.FormFields.Button("idCatalogSearchButton","idCatalogSearchButton",f,false,new obips.Callback(this,this.search));d.appendChild(this.searchButton.getElement())}};saw.catalog.SearchPanel.prototype.renderFacets=function(a){this.usedSearchFacets=a?a.usedFacets:null;this.renderUsedFacets(this.usedSearchFacets);this.renderAvailableFacets(a?a.availableFacets:null)};saw.catalog.SearchPanel.prototype.renderUsedFacets=function(a){if(this.usedFacetsDiv){saw.clearInnerHTML(this.usedFacetsDiv)}else{this.usedFacetsDiv=document.createElement("div");this.usedFacetsDiv.id="appliedFilterId";this.usedFacetsDiv.className="SearchAppliedFacet";this.searchPanelDiv.appendChild(this.usedFacetsDiv)}this._createUsedFacetsHeader();for(var b=0;a&&b<a.length;b++){var c=this._createUsedFacetsDiv(a[b])}};saw.catalog.SearchPanel.prototype._getTestData=function(){var d=3;var f=2;var e=new Array();for(var a=0;a<d;a++){var g={};g.name="Facet"+a;g.caption="Facet "+a;g.facetValues=new Array();for(var b=0;b<f;b++){var c={};c.name="Item"+b;c.caption="Item "+b;c.selected=true;g.facetValues.push(c)}e.push(g)}return e};saw.catalog.SearchPanel.prototype._createUsedFacetsDiv=function(b){var l=document.createElement("div");l.id=b.name;l.className="SearchFacetPaneContent";var n=document.createElement("table");var h=n.insertRow(n.rows.length);var d=h.insertCell(0);d.width="100%";h.appendChild(d);var k=b.caption;var g=b.facetValues;for(var e=0;e<g.length;e++){if(e!=0){k=k+", "+g[e].caption}else{k=k+" : "+g[e].caption}}var c=h.insertCell(1);h.appendChild(c);var i=document.createElement("span");var f=document.createElement("img");f.src=saw.catalog.getImgUrl("delete_ena");f.alt="Remove Facet";f.facetName=b.name;f.action="removeFacet";var m=this;f.onclick=function(j){m.applySearchFilters(saw.getEvent(j))};f.className="accordionDisclosure";i.appendChild(f);c.appendChild(i);l.appendChild(n);this.usedFacetsDiv.appendChild(l);var a=this.searchPanelDiv.offsetWidth-45;this.autoEllipseText(d,k,a)};saw.catalog.SearchPanel.prototype.autoEllipseText=function(b,f,c){var g=saw.encodeHTML(f);b.innerHTML='<span id="ellipsisSpan" style="white-space:nowrap;">'+g+"</span>";var e=document.getElementById("ellipsisSpan");if(e.offsetWidth>c){var a=1;e.innerHTML="";while(e.offsetWidth<(c)&&a<g.length){e.innerHTML=g.substr(0,a)+"...";a++}var d=e.innerHTML;b.innerHTML="";b.innerHTML='<span title="'+f+'">'+d+"</span>";return}b.innerHTML='<span title="'+f+'">'+g+"</span>"};saw.catalog.SearchPanel.prototype._createUsedFacetsHeader=function(){var f=document.createElement("div");f.className="SearchFacetPaneHeader";var h=document.createElement("table");var d=h.insertRow(h.rows.length);var c=d.insertCell(0);c.width="100%";d.appendChild(c);c.className="SearchFilterText";saw.appendTextNode(c,saw.catalog.getLocalizedString("kmsgFacetSearchFilter"));if(this.usedSearchFacets&&this.usedSearchFacets.length>0){var b=d.insertCell(1);d.appendChild(b);b.nowrap="nowrap";var e=document.createElement("span");var a=saw.catalog.getLocalizedString("kmsgFacetRemoveAll");var i=saw.createChildElement(e,"a","RemoveAllText");i.href="javascript:void(null)";i.appendChild(document.createTextNode(a));i.title=a;i.action="removeAll";var g=this;i.onclick=function(j){g.applySearchFilters(saw.getEvent(j))};b.appendChild(e)}f.appendChild(h);this.usedFacetsDiv.appendChild(f)};saw.catalog.SearchPanel.prototype.applySearchFilters=function(o){var k=saw.getEventTarget(o);var d=k.action;var l=k.facetName;var a=k.facetValue;var c="";if(d=="removeAll"){this.usedSearchFacets=null}else{if(d=="removeFacet"){var m=this._getFacetItemIndex(this.usedSearchFacets,l);this.usedSearchFacets.splice(m,1)}else{if(d=="checkbox"||d=="link"){var g=true;if(d=="checkbox"){g=k.checked}if(this.usedSearchFacets==null){this.usedSearchFacets=new Array()}var m=this._getFacetItemIndex(this.usedSearchFacets,l);if(m!=-1){var b=this.usedSearchFacets[m];var n=b.facetValues;var p=this._getFacetItemIndex(n,a.value);if(g){n.push(a)}else{n.splice(p,1)}if(n.length==0){this.usedSearchFacets.splice(m,1)}}else{var b={};b.name=l;b.facetValues=new Array();b.facetValues.push(a);this.usedSearchFacets.push(b)}}}}for(var h=0;this.usedSearchFacets&&h<this.usedSearchFacets.length;h++){var b=this.usedSearchFacets[h];var n=b.facetValues;var f="";for(var e=0;e<n.length;e++){if(e==0){f=n[e].value}else{f=f+";"+n[e].value}}c=c+"&facetAttribute_value="+saw.encodeURIComponent(b.name+"="+f)}this.search(null,c)};saw.catalog.SearchPanel.prototype._getFacetItemIndex=function(e,d){var a=-1;for(var c=0;c<e.length;c++){var b=e[c];if(b.name==d||b.value==d){a=c;break}}return a};saw.catalog.SearchPanel.prototype.resize=function(){if(this.availableFacetDiv){this.availableFacetDiv.style.height=(this.searchPanelDiv.offsetHeight-this.usedFacetsDiv.offsetHeight-this.tTable.offsetHeight-18)+"px";this.availableFacetDiv.resizable.notifyResize()}};saw.catalog.SearchPanel.prototype.renderAvailableFacets=function(b){if(this.availableFacetDiv){saw.clearInnerHTML(this.availableFacetDiv)}else{this.availableFacetDiv=document.createElement("div");new obips.BrowserEventFramework.Resizable(this.availableFacetDiv)}this.availableFacetDiv.style.height=(this.searchPanelDiv.offsetHeight-this.usedFacetsDiv.offsetHeight-this.tTable.offsetHeight-20)+"px";this.availableFacetDiv.style.overflow="auto";this.availableFacetDiv.id="idFacetAccordion";this.searchPanelDiv.appendChild(this.availableFacetDiv);var a=this;var c=new saw.catalog.SearchFacets(b,this.availableFacetDiv,new obips.Callback(a,a.applySearchFilters));c.render();obips.BrowserEventFramework.EventRouter.getEventRouter(window,"onresize").addEventListener(new obips.Observable.EventListener(null,new obips.Callback(this,this.resize)))};saw.catalog.SearchPanel.prototype.nameInputChangedHandler=function(a){if(this.isPressedCharCode(a,13)){if(this.input.value){this.search();return}return}if(this.input.value){this.searchButton.enable()}else{this.searchButton.disable()}};saw.catalog.SearchPanel.prototype.isPressedCharCode=function(b,c){b=(b)?b:(window.event)?event:null;if(b){var a=(b.charCode)?b.charCode:((b.keyCode)?b.keyCode:((b.which)?b.which:0));return a==c}return false};saw.catalog.SearchPanel.prototype.setSearchTarget=function(a){this.input.value=a.name?a.name:"";if(this.input.value){this.searchButton.enable()}if(this.locationSelector){if(a.location&&a.location!="/"){saw.catalog.forceSelectValue(this.locationSelector,a.location,a.location)}else{saw.catalog.forceSelectValue(this.locationSelector,"all")}}if(this.typeSelector){NQWSetSelectValue(this.typeSelector,a.type?a.type:"all")}};saw.catalog.SearchPanel.prototype.fetchSearchResultAgain=function(b){var e="";for(var d=0;this.usedSearchFacets&&d<this.usedSearchFacets.length;d++){var g=this.usedSearchFacets[d];var a=g.facetValues;var f="";for(var c=0;c<a.length;c++){if(c==0){f=a[c].value}else{f=f+";"+a[c].value}}e=e+"&facetAttribute_value="+saw.encodeURIComponent(g.name+"="+f)}this.search(null,e,b)};saw.catalog.SearchPanel.prototype.search=function(a,d,b){var c=null;if(this.locationSelector){c=new saw.catalog.SearchTarget(this.input.value,this.locationSelector.options[this.locationSelector.selectedIndex].value,this.typeSelector.options[this.typeSelector.selectedIndex].value)}else{c=new saw.catalog.SearchTarget(this.input.value)}c.facetAttributes=d;c.bShowHiddenValues=b;this.searchCallback.functionPointer.call(this.searchCallback.thisContext,c)};saw.catalog.SearchTarget=function(b,a,c){this.name=b;this.location=a;this.type=c};saw.catalog.ArchiveDialogModel=function(a){var b=new obips.Callback(this,this.archiveCatalog);saw.catalog.ArchiveDialogModel.baseConstructor.call(this,saw.catalog.getLocalizedString("kmsgCatalogActionArchive"),b);this.path=a;this.keepPermisions=false;this.keepTimestamps=false;this.releaseVersion="current"};saw.extend(saw.catalog.ArchiveDialogModel,obips.Dialog.Model);saw.catalog.ArchiveDialogModel.prototype.archiveCatalog=function(){var a=saw.commandToURL("ArchiveCatalog")+"&keepPermissions="+(this.keepPermissions?"yes":"no")+"&keepTimestamps="+(this.keepTimestamps?"yes":"no")+"&releaseVersion="+saw.encodeURIComponent(this.releaseVersion)+"&folder="+saw.encodeURIComponent(this.path);saw.runThisURL(a,{ensureFreshUrl:true})};saw.catalog.ArchiveDialogViewer=function(l){saw.catalog.ArchiveDialogViewer.baseConstructor.call(this,l,obips.FloatingWindow.Manager.getSingleton());this.controller=new obips.Dialog.Controller(this);this.controller.updateModel=function(){this.viewer.model.keepPermissions=this.viewer.keepPermissionsCheckbox.isChecked();this.viewer.model.keepTimestamps=this.viewer.keepTimestampsCheckbox.isChecked();if(obips.ResourceManager.getSingleton().getGDExpression("answers/obips.devfeatures.xml","devFeatureLiftAndShiftContentDowngrade").value){this.viewer.model.releaseVersion=this.viewer.releaseVersionOption.getSelectedValue()}};var a=document.createElement("FORM");this.model.form=a;var d=new obips.FormFields.OneColumnLayout();a.appendChild(d.getElement());var n=[];var h=false;var f=true;this.keepPermissionsCheckbox=new obips.FormFields.Checkbox("idKeepPermissionsCheckBox","KeepPermissionsCheckbox","",saw.catalog.getLocalizedString("kmsgArchiveCatalogKeepPermissions"),h,f);this.keepTimestampsCheckbox=new obips.FormFields.Checkbox("idKeepTimestampsCheckBox","KeepTimestampsCheckBox","",saw.catalog.getLocalizedString("kmsgArchiveCatalogKeepTimestamps"),h,f);n.push(this.keepPermissionsCheckbox);n.push(this.keepTimestampsCheckbox);var k=new obips.FormFields.CheckboxGroup(null,n);d.addFormField(k);if(obips.ResourceManager.getSingleton().getGDExpression("answers/obips.devfeatures.xml","devFeatureLiftAndShiftContentDowngrade").value){var m;var j=new saw.ajax.Request("getArchiveDialogOption");var e=saw.ajax.createConnection(j);e.setSync(true);var g=e.post();if(g&&!g.errors){m=g.response.getJSON()}var b=[];if(m&&m.releaseVersionInfo){for(var c=0;c<m.releaseVersionInfo.length;c++){if(m.releaseVersionInfo[c].toLowerCase()=="current"){b.push(new obips.FormFields.Option(saw.catalog.getLocalizedString("kmsgArchiveCatalogReleaseCurrentVersion"),m.releaseVersionInfo[c]))}else{b.push(new obips.FormFields.Option(m.releaseVersionInfo[c],m.releaseVersionInfo[c]))}}}this.releaseVersionOption=new obips.FormFields.SingleSelect(saw.catalog.getLocalizedString("kmsgArchiveCatalogDlgReleaseVersionLabel"),null,"releaseVersion",b);d.addFormField(this.releaseVersionOption)}this.bodyDiv.appendChild(a);this.floatingWindowManager.display(this)};saw.extend(saw.catalog.ArchiveDialogViewer,obips.Dialog.Viewer);saw.catalog.UploadWaitModel=function(a){saw.catalog.UploadWaitModel.baseConstructor.call(this,true);this.cancelCallback=a};saw.extend(saw.catalog.UploadWaitModel,obips.FloatingWindow.Model);saw.catalog.UploadWaitController=function(a){saw.catalog.UploadWaitController.baseConstructor(this,a);this.viewer=a};saw.extend(saw.catalog.UploadWaitController,obips.FloatingWindow.Controller);saw.catalog.UploadWaitController.prototype.operationComplete=function(){this.destroyWindow()};saw.catalog.UploadWaitController.prototype.cancelOperation=function(){this.viewer.model.cancelCallback.exec(this);obips.asyncCall(new obips.Callback(this,this.destroyWindow),10)};saw.catalog.UploadWaitViewer=function(e,d){saw.catalog.UploadWaitViewer.baseConstructor.call(this,e,obips.FloatingWindow.Manager.getSingleton());this.controller=new saw.catalog.UploadWaitController(this);var c=document.createElement("img");c.src=saw.catalog.getImgUrl("catalog/loading-indicator-white.gif");c.alt="";if(d===undefined){d=saw.catalog.getLocalizedString("kmsgCatalogCancelUpload")}var b=document.createElement("a");b.href="javascript:void(null)";b.onclick=saw.catalog.UploadWaitViewer.cancelHandler;b.appendChild(document.createTextNode(d));this.floatingWindowDiv.style.whiteSpace="nowrap";this.floatingWindowDiv.appendChild(c);this.floatingWindowDiv.appendChild(document.createTextNode(" "));this.floatingWindowDiv.appendChild(b);this.floatingWindowManager.displayAtPosition(this,saw.Position.createByRawCoordinates(null,null))};saw.extend(saw.catalog.UploadWaitViewer,obips.FloatingWindow.Viewer);saw.catalog.UploadWaitViewer.cancelHandler=function(a){var b=obips.FloatingWindow.Viewer.getViewerFromEvent(a);b.controller.cancelOperation();return false};saw.catalog.UploadOperationOrchestrator=function(a){this.callback=new obips.Callback(this,this.startUploadOperation_);this.uploadSuccessCallback=a};saw.catalog.UploadOperationOrchestrator.prototype.getStartUploadCallback=function(){return this.callback};saw.catalog.UploadOperationOrchestrator.prototype.startUploadOperation_=function(c,b){var a=new saw.catalog.UploadWaitModel(new obips.Callback(this,this.cancelOperationCallback_));this.parentFolder=c.path;this.waitViewer=new saw.catalog.UploadWaitViewer(a,b);var e=new saw.ajax.Request(c.sawCommand,this.uploadOperationCallback_,this);e.setFatalErrorHandler(this.ajaxErrorHandler_);var d=saw.ajax.createConnection(e,saw.ajax.Connection.TYPE_IFRAME);this.ajaxConnection=d;this.form=c.form;this.form.encoding="multipart/form-data";this.form.acceptCharset="UTF-8";d.postForm(c.form)};saw.catalog.UploadOperationOrchestrator.prototype.ajaxErrorHandler_=function(a,c){this.clearForm_();var b=saw.ajax.collapseErrors(c);var d=new obips.MessageDialog.Model(saw.catalog.getLocalizedString("kmsgCatalogErrorDialogTitle"),b,null,obips.MessageDialog.TITLE_IMAGE_ERROR);new obips.MessageDialog.Viewer(d);if(this.waitViewer){this.waitViewer.controller.operationComplete();this.waitViewer=null}};saw.catalog.UploadOperationOrchestrator.prototype.clearForm_=function(){if(this.form){this.form.parentNode.removeChild(this.form);this.form=null}};saw.catalog.UploadOperationOrchestrator.prototype.cancelOperationCallback_=function(){if(this.ajaxConnection){this.ajaxConnection.abort();this.ajaxConnection=null}this.clearForm_();if(this.waitViewer){this.waitViewer.controller.operationComplete();this.waitViewer=null}};saw.catalog.UploadOperationOrchestrator.prototype.uploadOperationCallback_=function(a){if(a.hasErrors()){var b=saw.ajax.collapseErrors(a.getErrors());var c=new obips.MessageDialog.Model(saw.catalog.getLocalizedString("kmsgCatalogErrorDialogTitle"),b,null,obips.MessageDialog.TITLE_IMAGE_ERROR);new obips.MessageDialog.Viewer(c)}this.clearForm_();if(this.waitViewer){this.waitViewer.controller.operationComplete();this.waitViewer=null}if(this.parentFolder){saw.catalog.getCatalogManager().fireEvent(obips.catalog.EventType.ITEM_INVALIDATED,this.parentFolder)}if(this.uploadSuccessCallback){this.uploadSuccessCallback()}};saw.catalog.UnArchiveDialogModel=function(a,b){saw.catalog.UnArchiveDialogModel.baseConstructor.call(this,saw.catalog.getLocalizedString("kmsgCatalogActionUnArchive"),b);this.sawCommand="unArchiveCatalog";this.path=a;this.replace=saw.catalog.UnArchiveDialogModel.REPLACE_NONE;this.acl=saw.catalog.UnArchiveDialogModel.ACL_INHERIT};saw.extend(saw.catalog.UnArchiveDialogModel,obips.Dialog.Model);saw.catalog.UnArchiveDialogModel.fileExtensionRegExp=/.*\.([^\.]*)/;saw.catalog.UnArchiveDialogModel.FILE_EXTENSION="catalog";saw.catalog.UnArchiveDialogModel.REPLACE_ALL="all";saw.catalog.UnArchiveDialogModel.REPLACE_OLD="old";saw.catalog.UnArchiveDialogModel.REPLACE_NONE="none";saw.catalog.UnArchiveDialogModel.REPLACE_FORCE="force";saw.catalog.UnArchiveDialogModel.ACL_INHERIT="inherit";saw.catalog.UnArchiveDialogModel.ACL_PRESERVE="preserve";saw.catalog.UnArchiveDialogModel.ACL_CREATE="create";saw.catalog.UnArchiveDialogController=function(a){saw.catalog.UnArchiveDialogController.baseConstructor.call(this,a)};saw.extend(saw.catalog.UnArchiveDialogController,obips.Dialog.Controller);saw.catalog.UnArchiveDialogController.prototype.updateModel=function(){var a=this.viewer.model;a.replace=this.viewer.replaceSelect.getSelectedValue();a.acl=this.viewer.aclSelect.getSelectedValue();var b=a.form;b.style.display="none";b.ownerDocument.body.appendChild(b);saw.addHiddenInput(b,"Folder",a.path,b.ownerDocument)};saw.catalog.UnArchiveDialogController.prototype.validateDialog=function(){if(!this.viewer.fileUpload.fileInput.value){saw.catalog.showError(saw.catalog.getLocalizedString("kmsgCatalogUnArchiveNoFileSelected"));return false}return true};saw.catalog.UnArchiveDialogViewer=function(c){saw.catalog.UnArchiveDialogViewer.baseConstructor.call(this,c,obips.FloatingWindow.Manager.getSingleton());this.controller=new saw.catalog.UnArchiveDialogController(this);var d=document.createElement("FORM");this.model.form=d;d.enctype="multipart/form-data";d.setAttribute("encoding","multipart/form-data");var a=new obips.FormFields.OneColumnLayout();d.appendChild(a.getElement());this.fileUpload=new obips.FormFields.FileUpload(saw.catalog.getLocalizedString("kmsgCatalogUnArchiveDlgFileLabel"),"archive");a.addFormField(this.fileUpload);var e=[];e.push(new obips.FormFields.Option(saw.catalog.getLocalizedString("kmsgCatalogUnArchiveDlgReplaceAll"),saw.catalog.UnArchiveDialogModel.REPLACE_ALL));e.push(new obips.FormFields.Option(saw.catalog.getLocalizedString("kmsgCatalogUnArchiveDlgReplaceOld"),saw.catalog.UnArchiveDialogModel.REPLACE_OLD));e.push(new obips.FormFields.Option(saw.catalog.getLocalizedString("kmsgCatalogUnArchiveDlgReplaceNone"),saw.catalog.UnArchiveDialogModel.REPLACE_NONE));e.push(new obips.FormFields.Option(saw.catalog.getLocalizedString("kmsgCatalogUnArchiveDlgReplaceForce"),saw.catalog.UnArchiveDialogModel.REPLACE_FORCE));this.replaceSelect=new obips.FormFields.SingleSelect(saw.catalog.getLocalizedString("kmsgCatalogUnArchiveDlgReplaceLabel"),null,"repl",e,saw.catalog.UnArchiveDialogModel.REPLACE_NONE,true);a.addFormField(this.replaceSelect);var b=[];b.push(new obips.FormFields.Option(saw.catalog.getLocalizedString("kmsgCatalogUnArchiveDlgACLInherit"),saw.catalog.UnArchiveDialogModel.ACL_INHERIT));b.push(new obips.FormFields.Option(saw.catalog.getLocalizedString("kmsgCatalogUnArchiveDlgACLPreserve"),saw.catalog.UnArchiveDialogModel.ACL_PRESERVE));b.push(new obips.FormFields.Option(saw.catalog.getLocalizedString("kmsgCatalogUnArchiveDlgACLCreate"),saw.catalog.UnArchiveDialogModel.ACL_CREATE));this.aclSelect=new obips.FormFields.SingleSelect(saw.catalog.getLocalizedString("kmsgCatalogUnArchiveDlgACLLabel"),null,"acl",b,saw.catalog.UnArchiveDialogModel.ACL_INHERIT,true);a.addFormField(this.aclSelect);this.bodyDiv.appendChild(d);this.floatingWindowManager.display(this)};saw.extend(saw.catalog.UnArchiveDialogViewer,obips.Dialog.Viewer);saw.catalog.forceSelectValue=function(c,d,b){NQWSetSelectValue(c,d);if(c.selectedIndex==-1||NQWGetSelectValue(c)!=d){var a=document.createElement("option");a.value=d;a.text=b;c.options.add(a,0);NQWSetSelectValue(c,d)}};saw.catalog.UploadDialogModel=function(a,b){saw.catalog.UploadDialogModel.baseConstructor.call(this,saw.catalog.getLocalizedString("kmsgCatalogActionUpload"),b);this.sawCommand="uploadFiles";this.path=a};saw.extend(saw.catalog.UploadDialogModel,obips.Dialog.Model);saw.catalog.UploadDialogModel.fileNameRegExp=/.*[\/\\]([^\/\\])/;saw.catalog.UploadDialogController=function(a){saw.catalog.UploadDialogController.baseConstructor.call(this,a)};saw.extend(saw.catalog.UploadDialogController,obips.Dialog.Controller);saw.catalog.UploadDialogController.prototype.updateModel=function(){var a=this.viewer.model;var b=a.form;b.style.display="none";b.ownerDocument.body.appendChild(b);saw.addHiddenInput(b,"path",a.path,b.ownerDocument)};saw.catalog.UploadDialogController.prototype.validateDialog=function(){var d=this.viewer.fileUpload.fileInput.value;if(!d){saw.catalog.showError(saw.catalog.getLocalizedString("kmsgCatalogUploadNoFileSelected"));return false}var f=saw.catalog.getCatalogManager();var a=f.getSubItems(this.viewer.model.path);var c=a.itemInfos;var b=d.replace(saw.catalog.UploadDialogModel.fileNameRegExp,"$1");var h=false;var g=b;for(var e=0;e<c.length;e++){if(c[e].getItemName()==b){h=true;if(e>0){g=g+", "+b}}}if(h){saw.catalog.showConfirmDialog(saw.catalog.getLocalizedString("kmsgCatalogConfirmOverwriteDlgTitle"),saw.catalog.getLocalizedString("kmsgCatalogConfirmOverwriteDlgMessage",g),new obips.Callback(this,this._uploadFile));return false}return true};saw.catalog.UploadDialogController.prototype._uploadFile=function(a){this.updateModel();this.closeDialog();if(this.viewer.model.callback){this.viewer.model.callback.functionPointer.call(this.viewer.model.callback.thisContext,this.viewer.model)}};saw.catalog.UploadDialogViewer=function(b){saw.catalog.UploadDialogViewer.baseConstructor.call(this,b,obips.FloatingWindow.Manager.getSingleton());this.controller=new saw.catalog.UploadDialogController(this);var c=document.createElement("FORM");this.model.form=c;c.enctype="multipart/form-data";c.setAttribute("encoding","multipart/form-data");var a=new obips.FormFields.OneColumnLayout();c.appendChild(a.getElement());this.fileUpload=new obips.FormFields.FileUpload(saw.catalog.getLocalizedString("kmsgCatalogUploadDlgFileLabel"),"file");a.addFormField(this.fileUpload);this.bodyDiv.appendChild(c);this.floatingWindowManager.display(this)};saw.extend(saw.catalog.UploadDialogViewer,obips.Dialog.Viewer)};