if(!saw.catalog.CatalogView){saw.catalog.CatalogView=function(a,c){this.adminMode=c&&saw.getSessionInfos().privileges.isAdmin;var b=this.createFolderTreeModel();saw.catalog.CatalogView.baseConstructor.call(this,null,b,null,null,false,true,"CatalogViewDnDGroup");this.container=a;this.contextMenuManager=obips.ContextMenu.Manager.getSingleton();this.objectList.setMultiSelection(true);this.objectList.setShowItemWithNoAccess(this.adminMode)};saw.extend(saw.catalog.CatalogView,saw.catalog.CatalogBrowser);saw.catalog.CatalogView.prototype._forceAddVirtualNodeImpl=function(c,d,b,a){var g;try{g=saw.catalog.getCatalogManager().getItemInfo(b)}catch(f){}c.push(saw.catalogtree.createVirtualFolderNode(d,b,saw.catalog.getLocalizedString(a),g&&g.itemInfo))};saw.catalog.CatalogView.prototype.createFolderTreeModel=function(){var a=saw.catalogtree.createRootNode();var c=this.adminMode?{canAccept:function(e){return e.getFolderType()}}:new saw.catalog.ObjectFilter(true);tFolderTreeModel=new saw.catalogtree.Model(null,a,c);var d=tFolderTreeModel.rootTreeNode.id;var b=[];if(this.adminMode){tFolderTreeModel.setForceFolderExpandable(true);tFolderTreeModel.setPermissions(obips.catalog.ItemPermissions.NONE,obips.catalog.ItemPermissions.NONE);if(saw.getSessionInfos().isSingleTenantMode()||saw.getSessionInfos().user.isGlobalSystemUser||saw.getSessionInfos().is12cMode()){b.push(saw.catalogtree.createVirtualFolderNode(d,"/",saw.catalog.getLocalizedString("kmsgCatalogFriendlyCatalogRoot")))}else{this._forceAddVirtualNodeImpl(b,d,"/users","kmsgCatalogFriendlyUserFolders");this._forceAddVirtualNodeImpl(b,d,"/company_shared","kmsgCatalogFriendlyMTCompanyShared")}tFolderTreeModel.treeModel.setChildrenShortCut(d,b)}else{tFolderTreeModel.addDefaultVirtualNodesToRoot()}return tFolderTreeModel};saw.catalog.CatalogView.prototype.render=function(){saw.header.getViewer().model.titleBar.setTitle(this.getLocalizedString("kmsgCatalogCaption"));var c=document.getElementById("PageContentOuterDiv");if(c){obips.CSS.addClassToElement(c,"CatalogPageContentOuterDiv")}var a=saw.header.getViewer().getContextHelpModel();var d="";if(a){d=a.getUrl()}a=new saw.help.ModelBase(d,this.getLocalizedString("kmsgCatalogPageHelp"));saw.header.getViewer().setContextHelpModel(a);this.renderToolbar();this.createLayout();this.renderPanelSelectToolbar(this.foldersAccordion.getPane("folders").getHeaderButtonContainer());this.multiPanelPane.render(this.foldersAccordion.getPane("folders").bodyNode);var b=saw.storage.ClientStorageManager.getSingleton();var e=b.getState(saw.catalog.StateID.CV_TOOLBAR_VIEW_TYPE);this.objectList.render(this.itemsAccordion.getPane("items").bodyNode,e?e:saw.catalog.ObjectList.VIEW_TYPE_VERBOSE);this.taskList=new saw.catalog.TaskList(this);this.taskList.render(this.foldersAccordion.getPane("tasks").bodyNode);if(saw.catalog.getPrivilege("canSeePreview")){this.previewer=new saw.catalog.Previewer(this);this.previewer.render(this.itemsAccordion.getPane("preview").bodyNode)}this.objectList.addEventListener(new obips.Observable.EventListener(saw.catalog.ObjectList.EventType.SELECTION_CHANGED,new obips.Callback(this,this.objectSelectionChangeHandler)));this.objectList.addEventListener(new obips.Observable.EventListener(saw.catalog.ObjectList.EventType.ITEM_DOUBLE_CLICKED,new obips.Callback(this,this.objectListItemDbclickedHandler)));this.objectList.addEventListener(new obips.Observable.EventListener(saw.catalog.ObjectList.EventType.ITEM_ACTIVATED,new obips.Callback(this,this.objectListItemActivatedHandler)));this.objectList.addEventListener(new obips.Observable.EventListener(saw.catalog.ObjectList.EventType.DROPPED_ON_ITEM,new obips.Callback(this,this.objectListDroppedonItemHandler)));this.objectList.addEventListener(new obips.Observable.EventListener(saw.catalog.ObjectList.EventType.DROPPED_IN_LIST,new obips.Callback(this,this.objectListDroppedInListHandler)));this.objectList.addEventListener(new obips.Observable.EventListener(saw.catalog.ObjectList.EventType.VIEW_IN_FOLDER,new obips.Callback(this,this.objectListViewInFolderHandler)));this.addFolderTreeEventListener();this.foldersAccordion.addEventListener(new obips.Observable.EventListener(saw.layout.EventType.PANE_RESIZED,new obips.Callback(this.multiPanelPane.panelSelector,this.multiPanelPane.panelSelector.onResize)));if(saw.catalog.getPrivilege("bUseBISearchWithFacetUI")){this.foldersAccordion.addEventListener(new obips.Observable.EventListener(saw.layout.EventType.PANE_COLLAPSED,new obips.Callback(this,this.onFoldersAccordionCollapseAndExpand)));this.foldersAccordion.addEventListener(new obips.Observable.EventListener(saw.layout.EventType.PANE_EXPANDED,new obips.Callback(this,this.onFoldersAccordionCollapseAndExpand)))}this.webCatalogManager.addEventListener(new obips.Observable.EventListener(obips.catalog.EventType.ITEMS_DELETED,new obips.Callback(this,this.itemsDeletedHandler)));this.webCatalogManager.addEventListener(new obips.Observable.EventListener(obips.catalog.EventType.ITEMS_MOVED,new obips.Callback(this,this.itemsMovedHandler)));this.webCatalogManager.addEventListener(new obips.Observable.EventListener(obips.catalog.EventType.ITEM_RENAMED,new obips.Callback(this,this.itemsRenamedHandler)));saw.catalogaction.getActionManager().addEventListener(new obips.Observable.EventListener(saw.catalogaction.ActionManager.EventType.ACTION_LIST_UPDATED,new obips.Callback(this,this.actionListUpdatedHandler)));this.updateToolbarState(null);if(saw.catalog.getPrivilege("canShowHiddenItems")&&saw.getSessionInfos().user.prefs.showHiddenItems()){this.showHiddenItems(true)}this.searchResultCount=document.getElementById("idsearchcount");this.objectList.addEventListener(new obips.Observable.EventListener(saw.catalog.ObjectList.EventType.ITEM_COUNT_CHANGED,new obips.Callback(this,this.searchCountFilterHandler)));this.objectList.addEventListener(new obips.Observable.EventListener(saw.catalog.ObjectList.EventType.ITEM_COUNT_CHANGED,new obips.Callback(this,this.displayLastIndexUpdateTime)));if(saw.catalog.getPrivilege("bUseBISearchWithFacetUI")){this.objectList.addEventListener(new obips.Observable.EventListener(saw.catalog.ObjectList.EventType.SEARCH_RESULTS_UPDATED,new obips.Callback(this,this.renderFacetsUI)))}};saw.catalog.CatalogView.prototype.onFoldersAccordionCollapseAndExpand=function(a){if(a.context&&a.context.name=="tasks"){this.multiPanelPane.searchPanel.resize()}};saw.catalog.CatalogView.prototype.renderFacetsUI=function(a){if(this.objectList.isBISearch()){this.multiPanelPane.searchPanel.renderFacets(this.objectList.searchFacets)}};saw.catalog.CatalogView.prototype.searchCountFilterHandler=function(a){if(this.objectList.isSearchResult()){if(this.objectList.isSearchResultsTruncated()){saw.setInnerText(this.searchResultCount,saw.catalog.getLocalizedString("kmsgSearchResultCountWithTruncation",a.context))}else{saw.setInnerText(this.searchResultCount,saw.catalog.getLocalizedString("kmsgSearchResultCount",a.context))}}else{saw.setInnerText(this.searchResultCount,"")}};saw.catalog.CatalogView.prototype.displayLastIndexUpdateTime=function(){if(this.objectList.isBISearch()){var b=document.getElementById("idIndexUpdateTimeRow");if(b){document.getElementById("idIndexUpdateTimeRow").style.display="block";var c=document.getElementById("idShowIndexUpdateTime");var a=this.objectList.getbiSearchIndexUpdateDateTime();saw.setInnerText(c,saw.catalog.getLocalizedString("kmsgCatalogIndexUpdateTime",a?a:""));this.itemsAccordion.strechToFitParent()}}};saw.catalog.CatalogView.prototype.getDefaultOpenFolder=function(){var b=saw.storage.ClientStorageManager.getSingleton();var a=b.getState(saw.catalog.StateID.LAST_OPEN_FOLDER);if(a){try{this.webCatalogManager.getItemInfo(a);return a}catch(c){}}return this.multiPanelPane.folderTreeViewer.getFirstVisibleFolder()};saw.catalog.CatalogView.prototype.createLayout=function(){this.splitter=new saw.layout.SplitterContainer(this.container,"h");this.foldersAccordion=new saw.layout.Accordion("idCatalogFoldersAccordion");this.foldersAccordion.getPane("folders").bodyNode.style.padding="2px";this.splitter.addEventListener(new obips.Observable.EventListener(saw.layout.EventType.PANE_RESIZED,new obips.Callback(this.foldersAccordion,this.foldersAccordion.strechToFitParent)));this.itemsAccordion=new saw.layout.Accordion("idCatalogItemsAccordion");this.itemsAccordion.children[0].headerNode.style.display="none";this.itemsAccordion.children[0].bodyNode.style.borderTop="none";this.itemsAccordion.addEventListener(new obips.Observable.EventListener(saw.layout.EventType.PANE_RESIZED,new obips.Callback(this.objectList,this.objectList.onContainerResized)));this.itemsAccordion.addEventListener(new obips.Observable.EventListener(saw.layout.EventType.PANE_EXPANDED,new obips.Callback(this,this.onAccordionPaneExpanded)));this.splitter.addEventListener(new obips.Observable.EventListener(saw.layout.EventType.PANE_RESIZED,new obips.Callback(this.itemsAccordion,this.itemsAccordion.strechToFitParent)));obips.FloatingWindow.Manager.getSingleton().registerScrollableContainers(this.itemsAccordion.children[0].bodyNode);this.windowResizeHandler();saw.addEventListener(window,"resize",this.onWindowResize,this,true)};saw.catalog.CatalogView.prototype.onWindowResize=function(){if(saw.userAgent.is_ie&&saw.isRToL()){var a=this;if(this.resizeHanderTimer){clearTimeout(this.resizeHanderTimer)}this.resizeHanderTimer=setTimeout(function(){a.windowResizeHandler()},500)}else{this.windowResizeHandler()}};saw.catalog.CatalogView.prototype.windowResizeHandler=function(){if(saw.userAgent.is_ie&&!saw.isRToL()){if(saw.getClientWidth()==this.lastClientWidth&&saw.getClientHeight()==this.lastClientHeight){return}this.lastClientWidth=saw.getClientWidth();this.lastClientHeight=saw.getClientHeight()}if(this.objectList){this.objectList.setVisible(false)}var b=this.splitter.getDomNode().parentNode;saw.componentheader.layoutOuterDiv();var a=saw.componentheader.getPageContentOuterDiv();saw.setOuterHeight(b,saw.cssLengthToInt(a.style.height));this.splitter.strechToFitParent();this.resizeLocationBar();if(this.objectList){this.objectList.setVisible(true)}};saw.catalog.CatalogView.prototype.resizeLocationBar=function(){if(this.locationSelector){var a=saw.findAncestorElement(this.locationSelector,"TABLE");this.locationSelector.style.width="0px";this.locationSelector.style.width=Math.max(0,a.parentNode.clientWidth-a.offsetWidth)+"px"}};saw.catalog.CatalogView.prototype._getIconSet=function(c,b,d,a){return new obips.UberBar.IconSet(saw.catalog.getImgUrl(c),saw.catalog.getImgUrl(b||c),saw.catalog.getImgUrl(d||c),saw.catalog.getImgUrl(a||c))};saw.catalog.CatalogView.prototype.addAdminToggleListener=function(e){var d=[];d.push(new obips.Switcher.OptionModel(new obips.Switcher.OptionContent("user",saw.catalog.getLocalizedString("kmsgCatalogUserViewMode"))));d.push(new obips.Switcher.OptionModel(new obips.Switcher.OptionContent("admin",saw.catalog.getLocalizedString("kmsgCatalogAdminViewMode"))));var f=this.adminMode?d[1]:null;var b=new obips.Switcher.Model(d,f);var a=e.rows[0].insertCell(e.rows[0].cells.length);a.className="CatalogViewModelSwitcher";var c=new obips.Switcher.Viewer(b,a);b.addEventListener(new obips.Observable.EventListener(obips.Switcher.Model.EventType.SELECTION_CHANGED,new obips.Callback(this,this.onViewModeChanged)))};saw.catalog.CatalogView.prototype.renderToolbar=function(){var a=document.getElementById("idCatalogToolbar");var e=saw.createTable(1,null,a);e.className="CatalogToolbarTable";if(saw.getSessionInfos().privileges.isAdmin){this.addAdminToggleListener(e)}var g=new Array();var f=new Array();var o=null;var h=null;if(saw.catalog.getPrivilege("canCreateFolders")||saw.getSessionInfos().hasCreatableItem){o=this._getIconSet("new_ena","new_dis","new_ovr","new_dwn");h=new obips.UberBar.IconMenuButtonModel("new",o,this.getLocalizedString("kmsgCatalogButtonTipNew"),true,obips.UberBar.MenuTypes.ICON_TEXT_MENU);h.callback=new obips.Callback(this,this.onNewButtonPress);g.push(h)}o=this._getIconSet("common/refresh_ena.png",null,"common/refresh_ovr.png","common/refresh_dwn.png");h=new obips.UberBar.IconButtonModel("refresh",o,this.getLocalizedString("kmsgCatalogButtonTipRefresh"),new obips.Callback(this,this.onRefreshButtonPress),false,true);g.push(h);o=this._getIconSet("catalog/uponefolder_ena.png","catalog/uponefolder_dis.png","catalog/uponefolder_ovr.png","catalog/uponefolder_dwn.png");h=new obips.UberBar.IconButtonModel("goUp",o,this.getLocalizedString("kmsgCatalogButtonTipGoUp"),new obips.Callback(this,this.onGoUpButtonPress),false,true);g.push(h);o=this._getIconSet("catalog/foldersview_ena.png","catalog/foldersview_dis.png","catalog/foldersview_ovr.png","catalog/foldersview_dwn.png");h=new obips.UberBar.IconButtonModel("folders",o,this.getLocalizedString("kmsgCatalogButtonTipFoldersPane"),new obips.Callback(this,this.onFoldersButtonPress),true,true);h.isDown=true;g.push(h);if(saw.catalog.getPrivilege("canAccessCatalogSearchUI")){o=this._getIconSet("find_ena","find_dis","find_ovr","find_dwn");h=new obips.UberBar.IconButtonModel("search",o,this.getLocalizedString("kmsgCatalogButtonTipSearch"),new obips.Callback(this,this.onSearchButtonPress),true,true);g.push(h)}var j=saw.storage.ClientStorageManager.getSingleton();var n=j.getState(saw.catalog.StateID.CV_TOOLBAR_VIEW_TYPE);o=this._getIconSet("catalog/foldercontentviews_ena.png",null,"catalog/foldercontentviews_ovr.png","catalog/foldercontentviews_dwn.png");f=[];var d=null;if(!n||n==saw.catalog.ObjectList.VIEW_TYPE_VERBOSE){d=new obips.UberBar.TextMenuOption(saw.catalog.ObjectList.VIEW_TYPE_VERBOSE,this.getLocalizedString("kmsgCatalogListViewDescriptive"),"",new obips.Callback(this,this.onListViewTypeChanged),true,true,"viewType")}else{d=new obips.UberBar.TextMenuOption(saw.catalog.ObjectList.VIEW_TYPE_VERBOSE,this.getLocalizedString("kmsgCatalogListViewDescriptive"),"",new obips.Callback(this,this.onListViewTypeChanged),true,false,"viewType")}f.push(d);if(n==saw.catalog.ObjectList.VIEW_TYPE_DETAIL){d=new obips.UberBar.TextMenuOption(saw.catalog.ObjectList.VIEW_TYPE_DETAIL,this.getLocalizedString("kmsgCatalogListViewDetail"),"",new obips.Callback(this,this.onListViewTypeChanged),true,true,"viewType")}else{d=new obips.UberBar.TextMenuOption(saw.catalog.ObjectList.VIEW_TYPE_DETAIL,this.getLocalizedString("kmsgCatalogListViewDetail"),"",new obips.Callback(this,this.onListViewTypeChanged),true,false,"viewType")}f.push(d);if(n==saw.catalog.ObjectList.VIEW_TYPE_LIST){d=new obips.UberBar.TextMenuOption(saw.catalog.ObjectList.VIEW_TYPE_LIST,this.getLocalizedString("kmsgCatalogListViewList"),"",new obips.Callback(this,this.onListViewTypeChanged),true,true,"viewType")}else{d=new obips.UberBar.TextMenuOption(saw.catalog.ObjectList.VIEW_TYPE_LIST,this.getLocalizedString("kmsgCatalogListViewList"),"",new obips.Callback(this,this.onListViewTypeChanged),true,false,"viewType")}f.push(d);h=new obips.UberBar.IconMenuButtonModel("viewType",o,this.getLocalizedString("kmsgCatalogButtonTipListViewType"),true,obips.UberBar.MenuTypes.TEXT_MENU,f);g.push(h);g.push(null);o=this._getIconSet("catalog/view_ena.png","catalog/view_dis.png","catalog/view_ovr.png","catalog/view_dwn.png");h=new obips.UberBar.IconButtonModel(saw.catalogaction.ActionId.OPEN,o,this.getLocalizedString("kmsgCatalogButtonTipOpen"),new obips.Callback(this,this.onViewButtonPress),false,true);g.push(h);o=this._getIconSet("edit_ena","edit_dis","edit_ovr","edit_dwn");h=new obips.UberBar.IconButtonModel(saw.catalogaction.ActionId.EDIT,o,this.getLocalizedString("kmsgCatalogButtonTipEdit"),new obips.Callback(this,this.onEditButtonPress),false,true);g.push(h);o=this._getIconSet("catalog/print_ena.png","catalog/print_dis.png","catalog/print_ovr.png","catalog/print_dwn.png");h=new obips.UberBar.IconMenuButtonModel(saw.catalogaction.ActionId.PRINTAS,o,this.getLocalizedString("kmsgCatalogButtonTipPrint"),true,obips.UberBar.MenuTypes.ICON_TEXT_MENU);h.callback=new obips.Callback(this,this.onPrintButtonPress);g.push(h);o=this._getIconSet("common/export_ena.png","common/export_dis.png","common/export_ovr.png","common/export_dwn.png");h=new obips.UberBar.IconMenuButtonModel(saw.catalogaction.ActionId.EXPORT,o,this.getLocalizedString("kmsgCatalogButtonTipExport"),true,obips.UberBar.MenuTypes.ICON_TEXT_MENU);h.callback=new obips.Callback(this,this.onExportButtonPress);g.push(h);o=this._getIconSet("delete_ena","delete_dis","delete_ovr","delete_dwn");h=new obips.UberBar.IconButtonModel(saw.catalogaction.ActionId.DELETE,o,this.getLocalizedString("kmsgCatalogButtonTipDelete"),new obips.Callback(this,this.onDeleteButtonPress),false,true);g.push(h);o=this._getIconSet("catalog/copy_ena.png","catalog/copy_dis.png","catalog/copy_ovr.png","catalog/copy_dwn.png");h=new obips.UberBar.IconButtonModel(saw.catalogaction.ActionId.COPY,o,this.getLocalizedString("kmsgCatalogButtonTipCopy"),new obips.Callback(this,this.onCopyButtonPress),false,true);g.push(h);o=this._getIconSet("catalog/paste_ena.png","catalog/paste_dis.png","catalog/paste_ovr.png","catalog/paste_dwn.png");h=new obips.UberBar.IconButtonModel(saw.catalogaction.ActionId.PASTE,o,this.getLocalizedString("kmsgCatalogButtonTipPaste"),new obips.Callback(this,this.onPasteButtonPress),false,true);g.push(h);g.push(null);this.toolbarModel=new obips.UberBar.Model("pageToolbar",g);var b=e.rows[0].insertCell(e.rows[0].cells.length);this.toolbarViewer=new obips.UberBar.Viewer(this.toolbarModel,b);this.toolbarViewer.uberBarDiv.style.backgroundColor="transparent";this.renderLocationBar(e.rows[0].insertCell(e.rows[0].cells.length));b=e.rows[0].insertCell(e.rows[0].cells.length);b.className="CatalogShowHiddenItems";if(saw.catalog.getPrivilege("canShowHiddenItems")){var c=document.createElement("img");c.className="CatalogToolbarSeparator";c.src=obips.ResourceManager.getSingleton().getURL(obips.masterResourceBundlePath,"masterToolbarSeparator").url;c.alt="";b.appendChild(c);var i=saw.createLabel(saw.catalog.getLocalizedString("kmsgCatalogViewShowHiddenItems"),null,null,b);this.showHiddenCheckbox=document.createElement("input");this.showHiddenCheckbox.type="checkbox";this.showHiddenCheckbox.onclick=function(){saw.catalog.catalogView.onShowHiddenItems()};i.insertBefore(this.showHiddenCheckbox,i.firstChild);this.showHiddenCheckbox.checked=saw.getSessionInfos().user.prefs.showHiddenItems()}var m=saw.header.getViewer().model.searchBar.helpModel;if(m){b=e.rows[0].insertCell(e.rows[0].cells.length);b.className="CatalogHelpIconCell";var c=document.createElement("img");c.className="CatalogToolbarSeparator";c.src=obips.ResourceManager.getSingleton().getURL(obips.masterResourceBundlePath,"masterToolbarSeparator").url;c.alt="";b.appendChild(c);var l=new obips.FormFields.ImageButton("helpIcon",m.getText(),saw.catalog.getImgUrl("helptopics_ena"),saw.catalog.getImgUrl("helptopics_ena"),saw.catalog.getImgUrl("helptopics_ovr"),saw.catalog.getImgUrl("helptopics_dwn"),true,new obips.Callback(null,function(){obips.launcher.launchHelp(m)}));b.appendChild(l.getElement());l.getElement().className="masterToolbarIconButtonEnabled"}var k=obips.ResourceManager.getSingleton();saw.componentheader.createHeader(null,a,null,k)};saw.catalog.CatalogView.prototype.renderLocationBarForNewCloudHome=function(e){e.className="CatalogLocationBarCell";var d=e.ownerDocument;var a=saw.createLabel(saw.catalog.getLocalizedString("kmsgCatalogSearchLocation"),null,null,e);a.style.paddingLeft="5px";var b=d.createElement("span");var c=d.createElement("select");c.onchange=function(){saw.catalog.catalogView.onLocationChange()};c.size=1;b.appendChild(c);b.className="XUIPromptEntry";b.style.paddingRight="0px";a.appendChild(b);this.locationSelector=c;setTimeout(function(){saw.catalog.catalogView.resizeLocationBar()},100)};saw.catalog.CatalogView.prototype.renderLocationBar=function(e){e.className="CatalogLocationBarCell";var d=e.ownerDocument;var a=saw.createLabel(saw.catalog.getLocalizedString("kmsgCatalogSearchLocation"),null,null,e);var b=d.createElement("span");var c=d.createElement("select");c.onchange=function(){saw.catalog.catalogView.onLocationChange()};c.size=1;b.appendChild(c);b.className="XUIPromptEntry";b.style.paddingRight="0px";a.appendChild(b);this.locationSelector=c;setTimeout(function(){saw.catalog.catalogView.resizeLocationBar()},100)};saw.catalog.CatalogView.prototype.onHistoryStateChange=function(b,d){this.inHistoryStateChangeHandler=true;d=d||new saw.catalog.CatalogBrowser.State(obips.history.getQueryStringParameter("Action"),obips.history.getQueryStringParameter("path"),obips.history.getQueryStringParameter("name"),obips.history.getQueryStringParameter("type"),obips.history.getQueryStringParameter("targetId"));var a=d.action&&d.action.toLowerCase();var f=saw.catalog.getPrivilege("canAccessCatalogSearchUI");var c=false;if(f){if(a=="search"){this.search(new saw.catalog.SearchTarget(d.mask,d.location,d.type),true)}else{if(a=="searchpanel"){this.showSearchPanel(new saw.catalog.SearchTarget(d.mask,d.location,d.type))}else{if(a=="favorite"){this.selectFivoriteLink(d.favorite)}else{c=true}}}}else{c=true}if(c){this.showFolderTreePanel();var e=d.location||this.getDefaultOpenFolder();if(e){this.openFolder(e)}}this.inHistoryStateChangeHandler=false};saw.catalog.CatalogView.prototype.setState=function(c,b,a){saw.catalog.CatalogView.superClass.setState.call(this,c,b);if(b&&!this.inHistoryStateChangeHandler){obips.history.add(c,null,saw.catalog.getLocalizedString("kmsgCatalogWindowTitle",a))}};saw.catalog.CatalogView.prototype.onViewModeChanged=function(b){var a=saw.commandToURL("Catalog")+"&mode="+b.context.getValue();obips.launcher.launchURL(a)};saw.catalog.CatalogView.prototype.onShowHiddenItems=function(a){var c=this.showHiddenCheckbox.checked;this.showHiddenItems(c);saw.getSessionInfos().user.prefs.setValue("Explorer/ShowHidden",c);if(this.objectList.isBISearch()){this.multiPanelPane.searchPanel.fetchSearchResultAgain(c)}var b={};b["Explorer/ShowHidden"]=c?"true":"false";saw.session.saveUserPrefs(b)};saw.catalog.CatalogView.prototype.showMoreDetails=function(){this.isDetailsShown=true;this.objectList.showDetails(this.getItemInfoDetailLevel())};saw.catalog.CatalogView.prototype.hideDetails=function(){this.objectList.hideDetails()};saw.catalog.CatalogView.prototype.setItemInfoDetailLevel=function(a){this.isDetailsShown=null;this.objectList.setHideDetails(false);this.showMoreDetailsCheckbox=document.getElementById("idCatalogShowMoreDetails");if(a){this.itemInfoDetailLevel=clone(a);if(this.itemInfoDetailLevel.extendedAttrLevel==obips.catalog.ExtendedAttrLevel.GREEDY){this.showMoreDetailsCheckbox.checked=true}else{this.showMoreDetailsCheckbox.checked=false}}else{this.itemInfoDetailLevel=new obips.catalog.ItemInfoDetailLevel(this.showMoreDetailsCheckbox.checked?obips.catalog.ExtendedAttrLevel.GREEDY:obips.catalog.ExtendedAttrLevel.NORMAL)}};saw.catalog.CatalogView.prototype.getItemInfoDetailLevel=function(){if(typeof(this.isDetailsShown)=="boolean"){var a=new obips.catalog.ItemInfoDetailLevel(this.isDetailsShown?obips.catalog.ExtendedAttrLevel.GREEDY:obips.catalog.ExtendedAttrLevel.Normal);if(this.itemInfoDetailLevel){a.aclDetailLevel=this.itemInfoDetailLevel.aclDetailLevel}return a}return this.itemInfoDetailLevel};saw.catalog.CatalogView.prototype.objectSelectionChangeHandler=function(c){var b=c.context;var a=b&&b.length==1?b[b.length-1]:null;if(a||!this.getTreeActiveNode()){this.multiPanelPane.folderTreeViewer.deactivateNode();this.updateToolbarState(b);if(b&&b.length>=1){this.taskList.renderSelectedItemActions(null,b)}else{this.taskList.renderSelectedItemActions(null,null)}}if(this.previewer){this.previewer.preview(a)}};saw.catalog.CatalogView.prototype.objectListItemActivatedHandler=function(b){var a=this.objectList.getSelectedItems();if(a.length==1&&a[0]==b.context){this.taskList.renderSelectedItemActions(null,a)}this.multiPanelPane.folderTreeViewer.deactivateNode()};saw.catalog.CatalogView.prototype.onAccordionPaneExpanded=function(c){var d=c.context;if(d.name=="preview"){var b=this.objectList.getSelectedItems();var a=b&&b.length==1?b[b.length-1]:null;this.previewer.preview(a)}};saw.catalog.CatalogView.prototype.refreshPreview=function(c){var b=this.objectList.getSelectedItems();var a=b&&b.length==1?b[b.length-1]:null;if(c&&a&&c.path==a.itemInfo.path){this.previewer.preview(a)}};saw.catalog.CatalogView.prototype.updateActionButtonState=function(a,d){var b=false;for(var c=0;d&&c<d.length;c++){b=saw.catalogaction.getActionManager().isAllowedAction(d[c].itemInfo,a);if(!b){break}}if(b){this.toolbarModel.enable(a)}else{this.toolbarModel.disable(a)}};saw.catalog.CatalogView.prototype.updateToolbarState=function(a){if(!a||a.length!=1){this.toolbarModel.disable(saw.catalogaction.ActionId.OPEN);this.toolbarModel.disable(saw.catalogaction.ActionId.EDIT);this.toolbarModel.disable(saw.catalogaction.ActionId.PRINTAS);this.toolbarModel.disable(saw.catalogaction.ActionId.EXPORT)}else{this.updateActionButtonState(saw.catalogaction.ActionId.OPEN,a);this.updateActionButtonState(saw.catalogaction.ActionId.EDIT,a);this.updateActionButtonState(saw.catalogaction.ActionId.PRINTAS,a);this.updateActionButtonState(saw.catalogaction.ActionId.EXPORT,a)}if(!a||a.length==0){this.toolbarModel.disable(saw.catalogaction.ActionId.DELETE);this.toolbarModel.disable(saw.catalogaction.ActionId.COPY)}else{this.updateActionButtonState(saw.catalogaction.ActionId.DELETE,a);this.updateActionButtonState(saw.catalogaction.ActionId.COPY,a)}this.updateToolbarPasteButtonState(a);if(this.canOpenParentFolder(a)){this.toolbarModel.enable("goUp")}else{this.toolbarModel.disable("goUp")}};saw.catalog.CatalogView.prototype.updateToolbarPasteButtonState=function(b){var h=this._getCurrentSelectedItems();var g=false;var c=globalRegister.getObject("clipboard");var e;if(c&&c.object.length>0){if(this.getTreeActiveNode()){var f=this.getTreeActiveNode().treeNode.itemInfo;g=(f.operationPermissions&obips.catalog.OperationPermissions.WRITE)==obips.catalog.OperationPermissions.WRITE}else{if(h&&h.length==1){var f=h[0];e=(f.operationPermissions&obips.catalog.OperationPermissions.WRITE)==obips.catalog.OperationPermissions.WRITE;var a=this.toolbarModel.getButtonByID("search");var d=a&&a.isDown;if(!d&&e){g=true}else{if(d&&this.isAllowedAction(f,saw.catalogaction.ActionId.PASTE)){g=true}}}}if(g&&f.path=="/shared"){g=!saw.catalog.CatalogManagerHelper.hasObjects(c.object)}}if(g){this.toolbarModel.enable(saw.catalogaction.ActionId.PASTE)}else{this.toolbarModel.disable(saw.catalogaction.ActionId.PASTE)}};saw.catalog.CatalogView.prototype.isAllowedAction=function(b,a){return saw.catalogaction.getActionManager().isAllowedAction(b,a)};saw.catalog.CatalogView.prototype.onListViewTypeChanged=function(e){this.listViewType=e.context.menuOption.id;var c=document.getElementById("idCatalogObjectSortSelect");c.parentNode.style.display=this.listViewType==saw.catalog.ObjectList.VIEW_TYPE_DETAIL?"none":"";var d=document.getElementById("idCatalogShowMoreDetails");d.parentNode.style.display=this.listViewType==saw.catalog.ObjectList.VIEW_TYPE_VERBOSE?"":"none";if(this.listViewType!=saw.catalog.ObjectList.VIEW_TYPE_DETAIL&&this.objectList.objectListModel){var a=this.objectList.objectListModel.sortProperty+".";a+=this.objectList.objectListModel.order==saw.list.Model.SortOrder.ASCENDING?"asc":"desc";NQWSetSelectValue(c,a)}if(this.listViewType){var b=saw.storage.ClientStorageManager.getSingleton();b.setState(saw.catalog.StateID.CV_TOOLBAR_VIEW_TYPE,this.listViewType)}this.objectList.setViewType(this.listViewType)};saw.catalog.CatalogView.prototype._getCurrentSelectedItems=function(){var b=this.getTreeActiveNode();if(b){return[b.treeNode.itemInfo]}else{var a=this.objectList.getSelectedItems();if(a&&a.length>0){return obips.Array.map(a,function(c){return c.itemInfo})}}};saw.catalog.CatalogView.prototype.onDeleteButtonPress=function(){var a=this._getCurrentSelectedItems();if(a){this.deleteItems(a)}};saw.catalog.CatalogView.prototype.onViewButtonPress=function(){var a=this._getCurrentSelectedItems();if(a){this.handleItemAction(a[0],saw.catalogaction.ActionId.OPEN)}};saw.catalog.CatalogView.prototype.onEditButtonPress=function(){var a=this._getCurrentSelectedItems();if(a){this.handleItemAction(a[0],saw.catalogaction.ActionId.EDIT)}};saw.catalog.CatalogView.prototype.onPrintButtonPress=function(a){var e=this.taskList.selectedItemActions;var c;for(var b=0;b<e.length;b++){if(e[b]&&e[b].groupId==saw.catalogaction.ActionId.PRINTAS){c=e[b].actions}}if(c){this.taskList.onDisplayActionGroupMenu(c,a);var d=obips.UberBar.BaseButtonViewer.getButtonViewerFromEvent(a).buttonSpan;saw.positionByDOMElement(d,this.contextMenuManager.currentContextMenuViewer.floatingWindowDiv)}};saw.catalog.CatalogView.prototype.onCopyButtonPress=function(){var a=this._getCurrentSelectedItems();if(a){this.copyToClipboard(a);this.updateToolbarPasteButtonState(this._getCurrentSelectedItems());this.taskList.renderSelectedItemActions(null,this.objectList.getSelectedItems())}};saw.catalog.CatalogView.prototype.onPasteButtonPress=function(){var d=this.objectList.getSelectedItems();var a=false;if(this.objectList.objectListViewer&&this.objectList.objectListViewer.viewModel&&this.objectList.objectListViewer.viewModel.activeItem){a=true}var c;if(d&&d.length==1&&d[0].itemInfo.getFolderType()&&a){var b=saw.catalogaction.getActionManager().findActionHandler(saw.catalogaction.ActionHandlerFinder.createByItemInfo(d[0].itemInfo));if(b==null||b.isPasteAccepted(d[0].itemInfo)){c=d[0].itemInfo.path}else{c=this.getCurrentFolderPath()}}else{c=this.getCurrentFolderPath()}this.pasteItems(c)};saw.catalog.CatalogView.prototype.onGoUpButtonPress=function(){this.openParentFolder()};saw.catalog.CatalogView.prototype.onRefreshButtonPress=function(){obips.catalog.cache.clearCache();var b=this.multiPanelPane;b.folderTreeModel=this.createFolderTreeModel();b.renderFolderTree();this.addFolderTreeEventListener();var a=this.getCurrentFolderPath();if(a){this.openFolder(a)}else{this.objectList.reload()}if(this.showHiddenCheckbox&&this.showHiddenCheckbox.checked){this.showHiddenItems(true)}};saw.catalog.CatalogView.prototype.getTreeActiveNode=function(){var a=this.multiPanelPane;var b=a.folderTreeViewer.treeViewer;return b.viewModel.activeNode};saw.catalog.CatalogView.prototype.addFolderTreeEventListener=function(){this.multiPanelPane.folderTreeViewer.addEventListener(new obips.Observable.EventListener(saw.catalogtree.Viewer.EventType.DROPPED_ON_NODE,new obips.Callback(this,this.folderTreeDropOnNodeHandler)));this.multiPanelPane.folderTreeViewer.addEventListener(new obips.Observable.EventListener(saw.catalogtree.Viewer.EventType.FOLDER_OPENED,new obips.Callback(this,this.folderTreeFolderOpenHandler)));this.multiPanelPane.folderTreeViewer.addEventListener(new obips.Observable.EventListener(saw.catalogtree.Viewer.EventType.TREE_NODE_ACTIVATED,new obips.Callback(this,this.folderTreeFolderActivateHandler)));this.multiPanelPane.folderTreeViewer.addEventListener(new obips.Observable.EventListener(saw.catalogtree.Viewer.EventType.TREE_NODE_DEACTIVATED,new obips.Callback(this,this.folderTreeFolderDeactivateHandler)))};saw.catalog.CatalogView.prototype.showNewMoreObjectMenu=function(a){evt=obips.BrowserEventFramework.normalizeEvent(evt);this.contextMenuManager.display(this.moreObjectMenuModel,evt)};saw.catalog.CatalogView.prototype.onNewFolder=function(a){this.displayNewFolderDialog()};saw.catalog.CatalogView.prototype.onNewButtonPress=function(b){saw.stopEvent(b);this.newMenuDiv=saw.createChildElement(document.body,"div","masterMenu HeaderPopupWindow");var e=obips.UberBar.BaseButtonViewer.getButtonViewerFromEvent(b).buttonSpan;var c=saw.header.createScrollableMenuPanel(this.newMenuDiv,e);var a=c.getContentContainer();if(saw.catalog.getPrivilege("canCreateFolders")&&this.getCurrentFolderPath()){var g=saw.catalog.getCatalogManager().getItemInfo(this.getCurrentFolderPath(),true).itemInfo;var h=(g.operationPermissions&obips.catalog.OperationPermissions.WRITE)==obips.catalog.OperationPermissions.WRITE;if(g.isLink()&&saw.catalog.isMyCompanySharedFolder(g)){var d=saw.catalog.getCatalogManager().getItemInfo(g.targetPath).itemInfo;h=(d.operationPermissions&obips.catalog.OperationPermissions.WRITE)==obips.catalog.OperationPermissions.WRITE}if(h){var f=saw.header.Viewer.addMenuOptionLink(a,function(){saw.catalog.catalogView.onNewFolder();return false},saw.catalog.getImgUrl("catalog/foldernew_ena.png"),this.getLocalizedString("kmsgCatalogItemTypeFolder"));saw.header.Viewer.addMenuSeparator(a)}}saw.header.Viewer.renderCreatableItemMenu(a,function(i){saw.catalog.catalogView.onNewObject(saw.getEvent(i));return false},e,false);this.newMenuDiv.style.visibility="hidden";c.resize();new saw.header.Menubar.CustomMenu(this.newMenuDiv).show(e,b)};saw.catalog.CatalogView.prototype.onExportButtonPress=function(a){var e=this.taskList.selectedItemActions;for(var b=0;b<e.length;b++){if(e[b]&&e[b].groupId==saw.catalogaction.ActionId.EXPORT){var d=e[b].actions}}if(d){this.taskList.onDisplayActionGroupMenu(d,a);var c=obips.UberBar.BaseButtonViewer.getButtonViewerFromEvent(a).buttonSpan;saw.positionByDOMElement(c,this.contextMenuManager.currentContextMenuViewer.floatingWindowDiv)}};saw.catalog.CatalogView.prototype.onNewObject=function(a){var c=saw.getEventTarget(a);c=saw.findAncestorElementOrSelf(c,"DIV");if(saw.getSessionInfos().isEnableCloudNewBieeHome()){var b=null;switch(c.creatableItem.signature){case saw.catalog.ItemCategory.REQUEST:b=new obips.Callback(null,window.parent.saw.cloudnewhome.createNewAnalysis);break;case saw.catalog.ItemCategory.DASHBOARDPAGE:case"dashboardfolder1":b=new obips.Callback(null,window.parent.saw.cloudnewhome.createNewDashboard);break;case saw.catalog.ItemCategory.PROMPT:b=new obips.Callback(null,window.parent.saw.cloudnewhome.createNewDashboardPrompt);break;case saw.catalog.ItemCategory.FILTER:b=new obips.Callback(null,window.parent.saw.cloudnewhome.createNewFilter);break;case saw.catalog.ItemCategory.VA_PROJECT:b=new obips.Callback(null,window.parent.saw.cloudnewhome.createNewVAProject);break}c.creatableItem.bForRaas=true;c.creatableItem.oEmbedUrlCallback=b}saw.catalogaction.getActionManager().newObject(c.creatableItem,this.getCurrentFolderPath(),a)};saw.catalog.CatalogView.prototype.onFoldersButtonPress=function(){var b=this.toolbarModel.getButtonByID("folders");var a=this.toolbarModel.getButtonByID("search");if(b.isDown){if(!a||!a.isDown){this.splitter.restorePane(this.splitter.getChild(0))}else{this.toolbarViewer.model.setToggleState(a.id,false)}this.panelSelectToolbarViewer.container.style.visibility="";this.multiPanelPane.switchPanel(this.panelSelectToolbarViewer.model.getButtonByID("folderTree").isDown?"folderTree":"favoriteFolders");this.foldersAccordion.getPane(0).setTitle(this.getLocalizedString("kmsgCatalogFoldersCaption"))}else{this.splitter.collapsePane(this.splitter.getChild(0))}};saw.catalog.CatalogView.prototype.onSearchButtonPress=function(){var c=this.toolbarModel.getButtonByID("search");var b=this.toolbarModel.getButtonByID("folders");if(c.isDown){if(!b.isDown){this.splitter.restorePane(this.splitter.getChild(0))}else{this.toolbarViewer.model.setToggleState(b.id,false)}this.panelSelectToolbarViewer.container.style.visibility="Hidden";this.multiPanelPane.switchPanel("search");var d=this.multiPanelPane.folderTreeViewer.openedFolder;var a="";if(d){if(!a){a=this.multiPanelPane.folderTreeModel.getDisplayPath(d)}if(!a){a=saw.catalog.getCatalogDisplayPath(d)}}if(d&&this.multiPanelPane.searchPanel.locationSelector){saw.catalog.forceSelectValue(this.multiPanelPane.searchPanel.locationSelector,d.id,a)}this.foldersAccordion.getPane(0).setTitle(this.getLocalizedString("kmsgCatalogButtonTipSearch"));if(saw.catalog.getPrivilege("bUseBISearchWithFacetUI")&&!this.foldersAccordion.getPane(1).collapsed){this.foldersAccordion.getPane(1).onDisclosureClicked()}}else{this.splitter.collapsePane(this.splitter.getChild(0))}};saw.catalog.CatalogView.prototype.showSearchPanel=function(b){var a=this.toolbarModel.getButtonByID("search");if(a&&!a.isDown){this.toolbarViewer.model.setToggleState(a.id,true);this.onSearchButtonPress()}if(b){this.multiPanelPane.searchPanel.setSearchTarget(b)}};saw.catalog.CatalogView.prototype.showFavoritesPanel=function(){var a=this.toolbarModel.getButtonByID("folders");if(a&&!a.isDown){this.toolbarModel.setToggleState(a.id,true);this.onFoldersButtonPress()}var b=this.panelSelectToolbarModel.getButtonByID("favoriteFolders");if(b&&!b.isDown){this.panelSelectToolbarViewer.model.setToggleState("favoriteFolders",true);this.onFavoriteFolderButtonPress()}};saw.catalog.CatalogView.prototype.showFolderTreePanel=function(){var a=this.toolbarModel.getButtonByID("folders");if(!a.isDown){this.toolbarModel.setToggleState(a.id,true);this.onFoldersButtonPress()}var b=this.panelSelectToolbarModel.getButtonByID("folderTree");if(!b.isDown){this.onFolderTreeButtonPress()}};saw.catalog.CatalogView.prototype.onLocationChange=function(){this.openFolder(this.locationSelector.options[this.locationSelector.selectedIndex].value)};saw.catalog.CatalogView.prototype.objectListItemDbclickedHandler=function(c){var b=c.context;var d=c.context.itemInfo;var a=saw.catalogaction.getActionManager().getDefaultAction(d);if(a){this.handleListItemAction(b,a.id);if(a.id==saw.catalogaction.ActionId.EXPAND){this.setState({location:d.path},true,d.caption);if(this.multiPanelPane.favoritesList){this.multiPanelPane.favoritesList.clearSelection()}}}};saw.catalog.CatalogView.prototype.objectListViewInFolderHandler=function(a){this.openFolder(a.context)};saw.catalog.CatalogView.prototype.objectListDroppedonItemHandler=function(d){var c=d.context.source;var a=d.context.dropTarget;var b=this.getDraggedItemInfos(c);if(d.context.evt.ctrlKey){this.copyItems(b,a.itemInfo.path)}else{this.moveItems(b,a.itemInfo.path)}};saw.catalog.CatalogView.prototype.objectListDroppedInListHandler=function(d){var a=this.getCurrentFolderPath();var c=d.context.source;if(a&&c.draggedNodes){var b=this.getDraggedItemInfos(c);if(!this.isTargetFolderInSources(a,b)){if(d.context.evt.ctrlKey){this.copyItems(b,a)}else{this.moveItems(b,a)}}}};saw.catalog.CatalogView.prototype.isTargetFolderInSources=function(c,b){for(var a=0;a<b.length;a++){if(b[a].path==c){break}}return(a<b.length)};saw.catalog.CatalogView.prototype.getDraggedItemInfos=function(c){var b=new Array;if(c.getDraggedNodes){var d=c.getDraggedNodes();for(var a=0;a<d.length;a++){b.push(d[a].itemInfo)}}else{for(var a=0;a<c.draggedItems.length;a++){b.push(c.draggedItems[a].content.itemInfo)}}return b};saw.catalog.CatalogView.prototype.search=function(b,c){if(c||this.multiPanelPane.panelSelector.displayedIndex!=2){this.showSearchPanel(b)}if(!b.location||b.location=="all"){b.location="/"}if(b.name){var a=saw.catalog.getLocalizedString("kmsgCatalogSearchResult",b.location,b.name,b.type);this.objectList.showSearchResult(b);this.addFolderToRecentList("",a);this.setState(new saw.catalog.CatalogBrowser.State("search",b.location,b.name,b.type,null),true,a)}};saw.catalog.CatalogView.prototype.folderTreeDropOnNodeHandler=function(d){var a=d.context.dropTarget;var c=d.context.source;var b=this.getDraggedItemInfos(c);if(d.context.evt.ctrlKey){this.copyItems(b,a.itemInfo.path)}else{this.moveItems(b,a.itemInfo.path)}};saw.catalog.CatalogView.prototype.folderTreeFolderActivateHandler=function(b){var a=b.context;var c=new Array();if(a){c.push(a)}this.updateToolbarState(c);this.taskList.renderSelectedItemActions(null,c);this.objectList.deactivate()};saw.catalog.CatalogView.prototype.folderTreeFolderDeactivateHandler=function(b){var a=b.context;if(!this.objectList.getActiveItem()){this.updateToolbarState(null);this.taskList.renderSelectedItemActions(null,null)}};saw.catalog.CatalogView.prototype.itemsDeletedHandler=function(c){var a=obips.Array.map(c.context,function(d){return d.path});this.removedPathsFromRecentList(a);var b=obips.Array.indexOf(a,this.getCurrentFolderPath());if(b!=-1){this.openFolder(obips.catalog.Path.getParentPath(this.getCurrentFolderPath()))}};saw.catalog.CatalogView.prototype.itemsMovedHandler=function(c){var a=obips.Array.map(c.context,function(d){return d.srcPath});this.removedPathsFromRecentList(a);var b=obips.Array.indexOf(a,this.getCurrentFolderPath());if(b!=-1){this.openFolder(c.context[b].destItemInfo.path)}};saw.catalog.CatalogView.prototype.itemsRenamedHandler=function(a){var b=[];b.push({itemInfo:a.context.destItemInfo});this.taskList.renderSelectedItemActions(null,b)};saw.catalog.CatalogView.prototype.actionListUpdatedHandler=function(e){var c=e.context.path;var b=e.context.actions;var d=e.context.replace;if(b&&b.length>0){this.taskList.updateActionList(c,b,d);var a=obips.ContextMenu.Manager.getSingleton().getDisplayedMenuModel();var f=a&&a.context&&a.context.listItem&&a.context.listItem.itemInfo;if(a&&f&&f.path==c){if(a.name=="objectListItemContextMenu"){this.objectList.updateItemContextMenu(a,b,d)}else{if(a.name=="moreActionsMenu"){saw.catalogaction.updateMoreActionsMenu(a,b,d)}}}}};saw.catalog.TaskList=function(a){this.catalogView=a;this.contextMenuManager=a.contextMenuManager};saw.catalog.TaskList.prototype.render=function(d){this.container=d;var c=this.container.ownerDocument;var e=c.createElement("div");e.id="idCatalogTasksActionListHeader";e.className="masterAccordionBottomContentAreaPanel CatalogTasksHeader";var a=c.createElement("img");a.border="0";a.style.verticalAlign="middle";a.src=saw.catalog.getImgUrl("answers/condDoc.png");a.alt="";e.appendChild(a);e.appendChild(c.createTextNode(" "));var b=c.createElement("span");b.style.verticalAlign="middle";e.appendChild(b);d.appendChild(e);e=c.createElement("div");e.id="idCatalogTasksActionList";e.className="CatalogTaskList";d.appendChild(e);this.renderSelectedItemActions(e)};saw.catalog.TaskList.prototype.renderSelectedItemActions=function(a,g){this.selectedItem=g&&g.length>0?g[g.length-1]:null;var d=document.getElementById("idCatalogTasksActionListHeader");var b=saw.getLastChildElement(d);saw.clearInnerHTML(b);if(!this.selectedItem){d.style.display="none"}else{d.style.display="block";if(g.length==1){var m=this.selectedItem.itemInfo.caption}else{var f=obips.Array.map(g,function(i){return i.caption});m=saw.catalog.getLocalizedString("kmsgCatalogMultiSelItemsLabel",g.length)}b.appendChild(document.createTextNode(m))}if(g&&g.length>1){var e=[saw.catalogaction.getActionManager().findItemAction(saw.catalogaction.ActionId.DELETE),saw.catalogaction.getActionManager().findItemAction(saw.catalogaction.ActionId.COPY)]}else{var e=this.selectedItem?saw.catalogaction.getActionManager().getAllowedActions(this.selectedItem.itemInfo,true):null}if(this.selectedItem&&this.selectedItem.itemInfo.signature==="dashboardpageitem1"){var l=0;for(var k=0;k<e.length;k++){if(e[k]&&(e[k].groupId===saw.catalogaction.ActionId.PRINTAS||e[k].groupId===saw.catalogaction.ActionId.EXPORT)){l++;e[k].actions=[];var c=new Array();if(e[k].groupId===saw.catalogaction.ActionId.PRINTAS){saw.catalogaction.DashboardPagesActionHandler.AddMorePrintActionsForBipLayouts(this.selectedItem.itemInfo,c,"pdf")}else{saw.catalogaction.DashboardPagesActionHandler.AddMorePrintActionsForBipLayouts(this.selectedItem.itemInfo,c,"excel")}for(var h=0;h<c.length;h++){tAction=saw.catalogaction.getActionManager().findItemAction(c[h],true);e[k].actions.push(tAction)}if(l>=2){break}}}}this.renderItemActions(a,e)};saw.catalog.TaskList.prototype.renderItemActions=function(e,c){if(!e){e=document.getElementById("idCatalogTasksActionList")}if(this.actionListViewer){this.actionListViewer.destroy();this.actionListModel=null;this.actionListViewer=null;saw.clearInnerHTML(e)}if(!c){return}var d=new Array();for(var a=0;a<c.length;a++){if(c[a]==null){continue}var b=new saw.list.ItemModel(new saw.catalog.ActionListItem(c[a],this));d.push(b)}this.selectedItemActions=c;this.actionListModel=new saw.list.Model(d);this.actionListViewer=new saw.list.Viewer(this.actionListModel,e,saw.list.ViewModel.SelectionType.NONE,null,false,null,new saw.list.ViewStyle(null,null,null,2));if(c.pending){saw.catalog.CatalogView.addLoadingIndicator(e)}};saw.catalog.TaskList.prototype.updateActionList=function(b,a,d){if(this.selectedItem&&b==this.selectedItem.itemInfo.path){if(d){this.selectedItemActions=a}else{for(var c=0;c<a.length;c++){if(saw.arrayIndexOf(this.selectedItemActions,a[c])<0){this.selectedItemActions.push(a[c])}}this.selectedItemActions.pending=false}this.renderItemActions(null,this.selectedItemActions)}};saw.catalog.TaskList.prototype.onItemAction=function(h,a){var e=this.catalogView;var d=e.multiPanelPane.folderTreeViewer;var g=d.treeViewer.viewModel;var f=g.getActiveNode();var c=e.objectList.getSelectedItems();if(f){e.handleListItemAction(f.treeNode,h,a)}else{if(c.length>1){if(h==saw.catalogaction.ActionId.DELETE){e.onDeleteButtonPress()}else{if(h==saw.catalogaction.ActionId.COPY){e.onCopyButtonPress()}}}else{e.handleListItemAction(c[0],h,a)}}var b=f?[f.treeNode]:c;e.updateToolbarState(b);this.renderSelectedItemActions(null,b)};saw.catalog.TaskList.prototype.onItemActionMenuOption=function(b){var a=b.context.menuOption.action;this.onItemAction(a)};saw.catalog.TaskList.prototype.onDisplayActionGroupMenu=function(d,b){var e=new Array();var g=null;for(var f=0;f<d.length;f++){var c=d[f];g=this._addItemToGroupMenu(e,c)}var a=new obips.ContextMenu.Model(this,g);this.contextMenuManager.display(a,b)};saw.catalog.TaskList.prototype._addItemToGroupMenu=function(f,c){if(c==null||(c.id===saw.catalogaction.ActionId.PRINT_SEPARATELINE)||c.id===saw.catalogaction.ActionId.EXPORT_SEPARATELINE){f.push(null);return}var e=c.icon;if(c.disabled){e=c.disabledIcon}if(c.groupId){var g=c.actions;if(g&&g.length>0){var a=new Array();for(var d=0;d<g.length;d++){this._addItemToGroupMenu(a,g[d])}var b=new obips.ContextMenu.MenuOption(c.name,"",e,new obips.Callback(this,this.onItemActionMenuOption),a,c.disabled);b.action=c.id;f.push(b)}}else{var b=new obips.ContextMenu.MenuOption(c.name,"",e,new obips.Callback(this,this.onItemActionMenuOption),null,c.disabled);b.action=c.id;f.push(b)}return f};saw.catalog.ActionListItem=function(a,b){this.action=a;this.taskList=b};saw.extend(saw.catalog.ActionListItem,saw.list.ItemContent);saw.catalog.ActionListItem.prototype.getViewer=function(){var b=this;var d=document;var c=d.createElement("A");c.className="CatalogTasksActionListItem";if(this.action.desc){c.setAttribute("title",this.action.desc)}if(this.action.icon){var a=saw.createChildElement(c,"img","CatalogTasksActionListItemIcon");a.src=this.action.icon;a.alt=""}if(this.action.disabled){c.disabled=true;a.src=this.action.disabledIcon;a.alt="";c.className="CatalogTasksActionListItemDisabled"}else{c.href="javascript:void(null)";if(this.action.groupId){c.onclick=function(e){b.taskList.onDisplayActionGroupMenu(b.action.actions,saw.getEvent(e))}}else{c.onclick=function(e){b.taskList.onItemAction(b.action.id,saw.getEvent(e))}}}c.appendChild(d.createTextNode(this.action.name));if(this.action.groupId){a=saw.createChildElement(c,"img","CatalogTasksActionListItemDropdown");a.border="0";a.src=obips.ResourceManager.getSingleton().getURL(obips.masterResourceBundlePath,"masterDropDownButtonDown").url;a.alt=saw.catalog.getLocalizedString("kmsgHeaderMenuDropdownImg")}return c};saw.catalog.Previewer=function(a){this.catalogView=a};saw.catalog.Previewer.prototype.render=function(a){this.container=a;this.container.style.overflow="hidden";this.pane=this.catalogView.itemsAccordion.getPane("preview");this.updatePaneHeader()};saw.catalog.Previewer.prototype.updatePaneHeader=function(a){this.headerCaption=a?a.caption:"";this.pane.setTitle(this.headerCaption?this.catalogView.getLocalizedString("kmsgCatalogPreviewPaneCaptionWithItemName",this.headerCaption):this.catalogView.getLocalizedString("kmsgCatalogPreviewPaneTitle"))};saw.catalog.Previewer.prototype.preview=function(g){this.updatePaneHeader(g);if(this.pane.collapsed){return}if(g){var a=null;if(!g.isFolder()){var f=g.itemInfo;a=saw.catalogaction.getActionManager().getPreviewURL(f.path,f.signature,f)}}var e=this.iFrame;var b=this.noViewDiv;if(a){if(b){b.style.display="none"}if(!this.loadingImg){this.loadingImg=saw.catalog.CatalogView.addLoadingIndicator(this.container)}this.loadingImg.style.display="block";var c=saw.shouldAddSessionSecurityCodeInputOnURL(a,this.container.ownerDocument);if(!e){e=saw.createIFrame("idIframeCatalogPreview","idIframeCatalogPreview",null,(c?"":a));e.className="CatalogPreviewIFrame";e.style.width="100%";e.style.height="100%";this.container.appendChild(e);saw.addEventListener(e,"load",this.showPreviewFrame,this,true);this.iFrame=e}else{e.style.display="block";e.style.visibility="hidden";if(!c){e.src=a}}if(c){var d=saw.createFormFromString(a);d.target=(e.id?e.id:"idIframeCatalogPreview");saw.submitForm(d,null,{ensureFreshUrl:true})}}else{if(e){e.style.display="none";e.parentNode.removeChild(e);this.iFrame=null}if(this.loadingImg){this.loadingImg.style.display="none"}if(!b){b=document.createElement("div");b.className="CatalogViewNotAvailable";saw.appendTextNode(b,this.catalogView.getLocalizedString("kmsgCatalogViewNotAvailable"));this.container.appendChild(b);this.noViewDiv=b}else{b.style.display="block"}}};saw.catalog.Previewer.prototype.showPreviewFrame=function(){this.loadingImg.style.display="none";if(this.iFrame){this.iFrame.style.visibility="visible";this.iFrame.setAttribute("embedsApp",this.iFrame.src.indexOf("bipublisherEntry")>=0?"true":"false");this.iFrame.oldVisibility=null;if(this.iFrame.src.indexOf("ibot_preview")>=0){this.iFrame.style.overflow="scroll"}}};saw.catalog.CatalogView.onListTypeChanged=function(a){var c=saw.getEventTarget(a);saw.catalog.catalogView.objectList.setTypeFilter(c.options[c.selectedIndex].value);if(c.options[c.selectedIndex].value){var b=saw.storage.ClientStorageManager.getSingleton();b.setState(saw.catalog.StateID.CV_TOOLBAR_CATEGORY,c.options[c.selectedIndex].value)}};saw.catalog.CatalogView.onListSortingChanged=function(b){var f=saw.getEventTarget(b);var e=f.options[f.selectedIndex].value;var d=e.indexOf(".");var g=e.substr(0,d);var a=e.charAt(d+1)=="d"?saw.list.Model.SortOrder.DESCENDING:saw.list.Model.SortOrder.ASCENDING;if(e){var c=saw.storage.ClientStorageManager.getSingleton();c.setState(saw.catalog.StateID.CV_TOOLBAR_ORDER_RULE,e)}saw.catalog.catalogView.objectList.setSortingRule(g,a)};saw.catalog.CatalogView.onShowMoreDetailsChanged=function(a){var c=saw.getEventTarget(a);var b=saw.storage.ClientStorageManager.getSingleton();if(c.checked){saw.catalog.getCatalogPageViewer().showMoreDetails();b.setState(saw.catalog.StateID.CV_TOOLBAR_SHOW_MORE_DETAILS,"true")}else{saw.catalog.getCatalogPageViewer().hideDetails();b.setState(saw.catalog.StateID.CV_TOOLBAR_SHOW_MORE_DETAILS,"false")}};saw.catalog.CatalogView.start=function(b){var a=new saw.catalog.CatalogView(document.getElementById("idCatalogSplitter"),b);saw.catalog.catalogView=a;a.render();saw.addInvisibleLayerBeforeUnload();return a};saw.catalog.CatalogView.addLoadingIndicator=function(b){var a=document.createElement("img");a.src=saw.catalog.getImgUrl("catalog/loading-indicator-white.gif");a.alt="";a.style.margin="3px";b.appendChild(a);return a};saw.catalog.getCatalogPageViewer=function(){return saw.catalog.catalogView}};