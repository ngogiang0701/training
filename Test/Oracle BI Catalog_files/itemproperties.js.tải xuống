if(!saw.catalog.ItemPropertyDlg){saw.catalog.ItemPropertyDlg=function(){};saw.catalog.ItemPropertyDlg.resourceFile="catalog/itemproperties.xml";saw.catalog.ItemPropertyDlg.Model=function(c,b,a){saw.catalog.ItemPropertyDlg.Model.baseConstructor.call(this,saw.catalog.getLocalizedString("kmsgCatalogActionProperties"),c,obips.ResourceManager.getSingleton().getURL(saw.catalog.ItemPropertyDlg.resourceFile,"itemPropertiesDialogHelp").url);this.itemInfo=b;this.itemInfoDetailLevel=a};saw.extend(saw.catalog.ItemPropertyDlg.Model,obips.Dialog.Model);saw.catalog.ItemPropertyDlg.Viewer=function(u){saw.catalog.ItemPropertyDlg.Viewer.baseConstructor.call(this,u,obips.FloatingWindow.Manager.getSingleton());this.webCatalogManager=saw.catalog.getCatalogManager();var s=this;var q=document;var k=this.model.itemInfo;var c=saw.createChildElement(this.bodyDiv,"div");this.layoutTable=saw.createTable(null,null,c);this.layoutTable.className="CatalogPropDlgOuterTable";var f=this.insertSection("kmsgExplorerGeneral");this.insertProperty(f,"kmsgCatalogDialogItemName",k.caption);var j=this.insertProperty(f,"kmsgCatalogDialogItemDescription");j.className="XUIPromptEntry";this.descArea=saw.createChildElement(j,"textarea","CatalogPropDlgDescription");this.descArea.value=k.description?k.description:"";var w=(this.descArea.value=="")?saw.catalog.ItemPropertyDlg.getLocalizedString("kmsgCatalogDialogItemValueNotSet"):k.description;saw.setAriaProperty(this.descArea,"aria-label",w);j=this.insertProperty(f,"kmsgCatalogSearchType",saw.catalog.getItemTypeName(k));if(!k.isSupported()){j.className="CatalogPropDlgTypeCell";var r=saw.createChildElement(j,"img");r.src=obips.ResourceManager.getSingleton().getURL(saw.catalog.ItemPropertyDlg.resourceFile,"objectNotSupportedWarning").url;r.alt="";r.title=saw.catalog.ItemPropertyDlg.getLocalizedString("kmsgCatalogPropertiesRawSignature")+(k.signature||k.getCompositeSignature())+"\n"+saw.catalog.ItemPropertyDlg.getLocalizedString("kmsgExploreObjectNotSupported")}else{if(k.signature||k.getCompositeSignature()){j.className="CatalogPropDlgTypeCell";var r=saw.createChildElement(j,"img");r.src=obips.ResourceManager.getSingleton().getURL(saw.catalog.ItemPropertyDlg.resourceFile,"common/info_ena.png").url;r.alt="";r.title=saw.catalog.ItemPropertyDlg.getLocalizedString("kmsgCatalogPropertiesRawSignature")+(k.signature||k.getCompositeSignature())}}j=this.insertProperty(f,"kmsgCatalogSearchLocation",saw.catalog.buildPrettyPathFromParts(obips.catalog.Path.split(saw.getFolder(k.path))));j.className="CatalogPropDlgLocation";if(k.type==obips.catalog.ItemType.LINK){this.insertProperty(f,"kmsgExplorerShortcutTarget",k.targetPath);var g=(k.badLink||k.targetType==obips.catalog.ItemType.MISSING)&&saw.catalog.ItemPropertyDlg.getLocalizedString("kmsgExplorerShortcutItemNoLongerInCatalog")||k.targetType==obips.catalog.ItemType.NOACCESS&&saw.catalog.ItemPropertyDlg.getLocalizedString("kmsgExplorerShortcutItemInLocationNoAccessTo")||k.targetType==obips.catalog.ItemType.CIRCULAR&&saw.catalog.ItemPropertyDlg.getLocalizedString("kmsgExplorerShortcutCircular")||saw.catalog.getItemTypeName(k,true);this.insertProperty(f,"kmsgCatalogPropertiesTargetType",g)}f=this.insertSection("kmsgCatalogPropertiesAccess");this.insertProperty(f,"kmsgExplorerCreated",k.createdDisplay);this.insertProperty(f,"kmsgExplorerModified",k.lastModifiedDisplay);this.insertProperty(f,"kmsgExplorerAccessed",k.accessedDisplay);f=this.insertSection("kmsgExplorerAttributes");this.insertProperty(f,"kmsgContentState",saw.catalog.getContentStateName(k));var m=f.insertRow(f.rows.length).insertCell(0);m.colSpan=2;m.className="CatalogPropDlgAttributes";this.hiddenCheckbox=this.showAttributeValue(m,"kmsgExplorerHidden",k.hasHiddenAttribute());this.systemCheckbox=this.showAttributeValue(m,"kmsgExplorerSystem",k.hasSystemAttribute());this.readOnlyCheckbox=this.showAttributeValue(m,"kmsgExplorerReadOnly",k.hasReadOnlyAttribute());this.doNotIndexCheckbox=this.showAttributeValue(m,"kmsgExplorerDoNotIndex",k.hasDoNotIndexAttribute());var y;var o=function(i){for(y in i){if(i.hasOwnProperty(y)){return false}}return true};f=this.insertSection("kmsgCatalogPropertiesCustomProperties");j=f.insertRow(f.rows.length).insertCell(0);var h=saw.createChildElement(j,"div","CatalogPropDlgCustomProperties");var t=0;h.style.overflow="auto";j.colSpan=2;if(!o(k.properties)){var p=saw.createTable(null,null,h);for(var x in k.properties){if(typeof(k.properties[x])=="string"&&x!="Desc"){saw.catalog.ItemPropertyDlg.insertPropertyRow(p,x,k.properties[x]);t++}}}if(t==0){h.appendChild(document.createTextNode(saw.catalog.ItemPropertyDlg.getLocalizedString("kmsgCatalogPropertiesNoCustomProperties")));h.style.whiteSpace="nowrap"}var n=new obips.Callback(this,this.loadInternalPropertiesJSAndDisplay);var a=this.insertCustomButton(n,saw.catalog.ItemPropertyDlg.getLocalizedString("kmsgCatalogPropertiesInternalProperties"),saw.catalog.ItemPropertyDlg.getLocalizedString("kmsgCatalogPropertiesInternalProperties"),null,false);var s=this;if(k.operationPermissions&obips.catalog.OperationPermissions.SET_OWNERSHIP){var e=k.getFolderType();var l=e==obips.catalog.FolderType.OBJECT;f=this.insertSection("kmsgExplorerOwnership");j=saw.catalog.ItemPropertyDlg.insertPropertyRow(f,"");var d=saw.createChildElement(j,"a");d.href="javascript:void(0)";saw.appendTextNode(d,saw.catalog.ItemPropertyDlg.getLocalizedString("kmsgExplorerSetOwnershipOfItem"));d.onclick=function(){s.setOwnership(l)};if(e&&!l){saw.createChildElement(j,"br");d=saw.createChildElement(j,"a");d.href="javascript:void(0)";saw.appendTextNode(d,saw.catalog.ItemPropertyDlg.getLocalizedString("kmsgExplorerSetOwnershipRecursively"));d.onclick=function(){s.setOwnership(true)}}}if(this.showDebugInfo){this.showDebugInfo()}this.controller=new obips.Dialog.Controller(this);this.controller.validateDialog=function(){var i=s.getDescLimit();if(s.descArea.value.length>i){saw.catalog.showError(saw.catalog.getLocalizedString("kmsgCatalogExceedingDescMaxLength",i));return false}return true};this.controller.updateModel=function(){this.viewer.model.attributes=0;if(this.viewer.hiddenCheckbox.checked){this.viewer.model.attributes|=obips.catalog.ItemAttributes.HIDDEN}if(this.viewer.systemCheckbox.checked){this.viewer.model.attributes|=obips.catalog.ItemAttributes.SYSTEM}if(this.viewer.readOnlyCheckbox.checked){this.viewer.model.attributes|=obips.catalog.ItemAttributes.READ_ONLY}if(this.viewer.doNotIndexCheckbox.checked){this.viewer.model.attributes|=obips.catalog.ItemAttributes.DO_NOT_INDEX}this.viewer.model.desc=this.viewer.descArea.value};this.floatingWindowManager.display(this);var b=this.descArea;var v=(k.operationPermissions&obips.catalog.OperationPermissions.SET_ATTRIBUTES)==obips.catalog.OperationPermissions.SET_ATTRIBUTES;if(!v){this.descArea.disabled=true;this.hiddenCheckbox.disabled=true;this.systemCheckbox.disabled=true;this.readOnlyCheckbox.disabled=true;this.doNotIndexCheckbox.disabled=true;b=this.helpButton}b.focus();this.tabCircler=new obips.TabCircler(b,this.cancelButton);this.tabCircler.run(this.tabHandler,this)};saw.extend(saw.catalog.ItemPropertyDlg.Viewer,obips.Dialog.Viewer);saw.catalog.ItemPropertyDlg.Viewer.prototype.tabHandler=function(a,b){b.tabCircler.handler(a)};saw.catalog.ItemPropertyDlg.Viewer.prototype.getDescLimit=function(){return obips.catalog.Catalog.getPropertyLimit(obips.catalog.ItemProperty.DescriptionLimit)};saw.catalog.ItemPropertyDlg.getLocalizedString=function(a){return obips.ResourceManager.getSingleton().getResource(saw.catalog.ItemPropertyDlg.resourceFile,a).getString()};saw.catalog.ItemPropertyDlg.Viewer.prototype.insertSection=function(b){var a=this.layoutTable.insertRow(this.layoutTable.rows.length).insertCell(0);a.colSpan=2;a.className="CatalogPropDlgSectionHeader"+(this.layoutTable.rows.length==1?" CatalogPropDlgFirstSection":"");a.appendChild(a.ownerDocument.createTextNode(saw.catalog.ItemPropertyDlg.getLocalizedString(b)));return this.layoutTable};saw.catalog.ItemPropertyDlg.insertPropertyRow=function(d,b,e){var c=d.insertRow(d.rows.length);var a=c.insertCell(0);a.className="masterPrompt XUIPromptCaption";a.appendChild(a.ownerDocument.createTextNode(b));a=c.insertCell(1);if(e){a.appendChild(a.ownerDocument.createTextNode(e))}a.id="compositeSignatureId";a.style.maxWidth="300px";a.style.wordBreak="break-all";return a};saw.catalog.ItemPropertyDlg.Viewer.prototype.insertProperty=function(b,a,c){return saw.catalog.ItemPropertyDlg.insertPropertyRow(b,saw.catalog.ItemPropertyDlg.getLocalizedString(a),c)};saw.catalog.ItemPropertyDlg.Viewer.prototype.showAttributeValue=function(h,c,e){var g=saw.catalog.ItemPropertyDlg.getLocalizedString(c);var b=g.replace(/\s+/g,"");var d=saw.createChildElement(h,"span");var f=saw.createInput(g,null,"checkbox");d.appendChild(f);f.id=b;f.checked=e;var a=saw.createChildElement(d,"label");a.setAttribute("for",b);a.appendChild(d.ownerDocument.createTextNode(g));return f};saw.catalog.ItemPropertyDlg.Viewer.prototype.loadInternalPropertiesJSAndDisplay=function(){saw.ondemandload.retrieveAndAddResources({messageTemplate:"kuiInternalProperties"},null,new obips.Callback(this,this.showItemInternalPropDialog),null)};saw.catalog.ItemPropertyDlg.Viewer.prototype.showItemInternalPropDialog=function(){saw.catalog.ItemInternalPropertyDlg.showItemInternalProperitiesDialog(this.model.itemInfo)};saw.catalog.ItemPropertyDlg.OKHandler=function(a){if(a.attributes!==a.itemInfo.attributes){saw.catalog.getCatalogManager().setAttributes(a.itemInfo.path,a.attributes,a.itemInfoDetailLevel,new obips.Callback(null,function(b){saw.catalog.ItemPropertyDlg.setAttributesCB(b,a)}))}else{if(a&&a.desc!==a.itemInfo.description){saw.catalog.getCatalogManager().setProperties(a.itemInfo.path,{Desc:a.desc},a.itemInfoDetailLevel,new obips.Callback(null,saw.catalog.ItemPropertyDlg.setAttributesCB))}}};saw.catalog.ItemPropertyDlg.setAttributesCB=function(a,b){if(a.getErrorMessage()){saw.catalog.showError(a.getErrorMessage())}else{if(b&&b.desc!==b.itemInfo.description){saw.catalog.getCatalogManager().setProperties(b.itemInfo.path,{Desc:b.desc},b.itemInfoDetailLevel,new obips.Callback(null,saw.catalog.ItemPropertyDlg.setAttributesCB))}}};saw.catalog.ItemPropertyDlg.showItemProperitiesDialog=function(f,c,d){if(!c&&saw.catalog.getCatalogPageViewer&&saw.catalog.getCatalogPageViewer()){c=saw.catalog.getCatalogPageViewer().getItemInfoDetailLevel()}var e=new obips.Callback(null,saw.catalog.ItemPropertyDlg.OKHandler);var a=new saw.catalog.ItemPropertyDlg.Model(e,f,c);var b=new saw.catalog.ItemPropertyDlg.Viewer(a);b.setLaunchElement(d)};saw.catalog.ItemPropertyDlg.Viewer.prototype.showDebugInfo=function(){var h=this.model.itemInfo;if(window.obips_debug){var f=saw.createChildElement(this.bodyDiv,"div");f.style.border="1px solid blue";f.style.marginTop="10px";var b=saw.createChildElement(f,"a");b.href="javascript:void(0)";b.style.border="1px solid black";b.style.margin="2px";b.style.display="inline-block";saw.setInnerText(b,"+");b.onclick=function(){if(saw.getInnerText(b)=="+"){saw.setInnerText(b,"--");g.style.display="block"}else{saw.setInnerText(b,"+");g.style.display="none"}return false};saw.appendTextNode(saw.createChildElement(f,"b"),"Debug Info (click + to expand)");var g=saw.createChildElement(f,"div");g.style.display="none";var d=saw.createTable(null,null,g);if(h.signature){saw.catalog.ItemPropertyDlg.insertPropertyRow(d,"Signature",h.signature)}var c=this;if(h.acl){g.appendChild(document.createTextNode("ACL: "+saw.json.toString(h.acl,true)))}if(!h.getFolderType()){var e=saw.createChildElement(g,"button");saw.appendTextNode(e,"Read Object");e.onclick=function(){c.readObject()};tWritedObject=saw.createChildElement(g,"button");saw.appendTextNode(tWritedObject,"Write Object");tWritedObject.onclick=function(){c.writeObject()}}saw.createChildElement(g,"br");var a=saw.createChildElement(g,"textarea");a.style.width="400px";a.style.height="100px";a.value=saw.json.toString(h,true)}};saw.catalog.ItemPropertyDlg.Viewer.prototype.readObject=function(){this.webCatalogManager.readObject(this.model.itemInfo.path,false,this.model.itemInfoDetailLevel,new obips.Callback(this,this.readObjectCB))};saw.catalog.ItemPropertyDlg.Viewer.prototype.readObjectCB=function(a){if(a.getErrorMessage()){saw.catalog.showError(a.getErrorMessage());return}if(!this.itemData){saw.createChildElement(this.bodyDiv,"br");this.itemData=saw.createChildElement(this.bodyDiv,"textarea");this.itemData.style.height="100px";this.itemData.style.width="400px"}this.itemData.value=a.data};saw.catalog.ItemPropertyDlg.Viewer.prototype.writeObject=function(){if(this.itemData&&this.itemData.value){new saw.catalog.CatalogManagerHelper(this.model.itemInfoDetailLevel).writeObject(null,this.model.itemInfo.signature,this.itemData.value,this.model.itemInfo.path)}};saw.catalog.ItemPropertyDlg.Viewer.prototype.setOwnership=function(a){this.webCatalogManager.setOwnership(this.model.itemInfo.path,null,null,a,this.model.itemInfoDetailLevel,new obips.Callback(this,this.setOwnershipCB))};saw.catalog.ItemPropertyDlg.Viewer.prototype.setOwnershipCB=function(b){if(b.getErrorMessage()){saw.catalog.showError(b.getErrorMessage())}else{var a=saw.catalog.getLocalizedString("kmsgSetOwnerShipSuccessful");saw.catalog.showMessageDialog(a)}}};