obips.ContextMenu=function(){};obips.ContextMenu.resourceFile="uicomponents/common/common.xml";obips.ContextMenu.Manager=function(){var a=obips.ContextMenu.Manager.getSingleton(obips.ContextMenu.Manager.SINGLETON_NAME);if(a){return a}obips.ContextMenu.Manager.baseConstructor.call(this);this.floatingWindowManager=obips.FloatingWindow.Manager.getSingleton();this.currentContextMenuViewer=null;globalRegister.addObject(obips.ContextMenu.Manager.SINGLETON_NAME,this)};extend(obips.ContextMenu.Manager,obips.Observable);obips.ContextMenu.Manager.SINGLETON_NAME="contextMenuManager";obips.ContextMenu.Manager.getSingleton=function(){return obips.getSingleton(obips.ContextMenu.Manager.SINGLETON_NAME)};obips.ContextMenu.Manager.prototype.getDisplayedMenuModel=function(){return(this.currentContextMenuViewer)?this.currentContextMenuViewer.model:null};obips.ContextMenu.Manager.prototype.display=function(d,b,c){var a=b?saw.Position.createByEvent(b):null;var e=c||false;return this.displayAtPosition(d,a,e)};obips.ContextMenu.Manager.prototype.displayAtPos=function(c,a,b){var d=b||false;return this.displayAtPosition(c,a,d)};obips.ContextMenu.Manager.prototype.displayAtPosition=function(g,b,h){var j=b.evt;if(j){if(saw.getSessionInfos().isEnableSection508()&&j.type==="keydown"&&j.keyCode===13){b=saw.Position.createByKeydownEvent(j)}else{b=saw.Position.createByEvent(j)}}var d=false;try{d=window.jQuery&&obips.mobile&&obips.mobile.ContextMenu}catch(f){}if(saw.userAgent.is_touchdevice&&(d)){this.currentContextMenuViewer=new obips.ContextMenu.MobileViewer(g,this,b)}else{this.currentContextMenuViewer=new obips.ContextMenu.Viewer(g,this)}if(h){this.currentContextMenuViewer.setHideOnScroll(true)}var a=this.currentContextMenuViewer.floatingWindowDiv;a.style.visibility="hidden";a.style.display="block";this.floatingWindowManager.displayAtPosition(this.currentContextMenuViewer,b);if(this.currentContextMenuViewer.isMobile==true){this.currentContextMenuViewer.mobilePopUpViewer.baseMenuDisplay()}else{this.currentContextMenuViewer.scrollPane.resize(saw.getClientHeight())}a.style.visibility="visible";if(j){j.cancelBubble=true;if(j.stopPropagation){j.stopPropagation()}if(j.preventDefault){j.preventDefault()}j.returnValue=false}if(saw.getSessionInfos().isEnableSection508()){var i=this.currentContextMenuViewer.optionViewers[0];var c=this.currentContextMenuViewer.controller;if(i){setTimeout(function(){c.focusMenuOption(i.contextMenuOptionDiv)},1)}}else{this.currentContextMenuViewer.vpatDiv.focus()}return this.currentContextMenuViewer};obips.ContextMenu.Manager.prototype.hide=function(a){if(this.currentContextMenuViewer){this.currentContextMenuViewer.hideChildMenu();this.floatingWindowManager.destroy(this.currentContextMenuViewer);try{this.currentContextMenuViewer.model.removeEventListener(this.currentContextMenuViewer.controller.menuOptionsUpdatedEventListener)}catch(b){}this.notify(new obips.Observable.Event(obips.ContextMenu.EventType.CONTEXT_MENU_CLOSED,{contextMenuViewer:this.currentContextMenuViewer,evt:a}));this.currentContextMenuViewer=null}};new obips.ContextMenu.Manager();obips.ContextMenu.EventType=function(){};obips.ContextMenu.EventType.CONTEXT_MENU_OPTION_PICKED="contextMenuOptionPicked";obips.ContextMenu.EventType.CONTEXT_MENU_CLOSED="contextMenuClosed";obips.ContextMenu.EventType.CONTEXT_MENU_DESTROYED="contextMenuDestroyed";obips.ContextMenu.EventContext=function(){};obips.ContextMenu.EventContext.ContextMenuOptionPickedContext=function(a,b){this.context=a;this.menuOption=b};obips.ContextMenu.Model=function(b,a,d,c){obips.ContextMenu.Model.baseConstructor.call(this,false,true);this.context=b;this.sBaseID=(c?c:"");this.menuOptions=a;this.bLargeMenuIcons=d;this.customStyleClass=null};extend(obips.ContextMenu.Model,obips.FloatingWindow.Model);obips.ContextMenu.Model.EventType=function(){};obips.ContextMenu.Model.EventType.MENU_OPTIONS_UPDATED="menuOptionsUpdated";obips.ContextMenu.Model.prototype.setMenuOptions=function(a){this.menuOptions=a;this.notify(new obips.Observable.Event(obips.ContextMenu.Model.EventType.MENU_OPTIONS_UPDATED,null))};obips.ContextMenu.Model.prototype.setCustomStyleClass=function(a){this.customStyleClass=a};obips.ContextMenu.MenuOption=function(f,j,a,i,l,d,b,g,c,e,h,k){this.name=f;this.sBaseID=(h?h:"");this.description=j;this.icon=a;this.callback=i;this.childMenuOptions=l;this.disabled=d;this.onCloseCallback=b;this.iNotifyOption=g;this.bMultiselect=c;this.bLargeSubmenuOptions=false;if(e){this.bLargeSubmenuOptions=true}this.mobileIcon=k;this.bAllowNonLeafMenuClickable=false};obips.ContextMenu.MenuOption.NOTIFY_ALL_MENU_OPTS=1;obips.ContextMenu.MenuOption.NOTIFY_FIRST_MENU_OPT=2;obips.ContextMenu.MenuOption.prototype.setNonLeafMenuClickable=function(a){this.bAllowNonLeafMenuClickable=a};obips.ContextMenu.MenuOption.prototype.isClickable=function(){return this.callback!==undefined&&this.callback!==null&&(!this.childMenuOptions||this.bAllowNonLeafMenuClickable)};obips.ContextMenu.MenuOption.prototype.setMenuOptionViewerCallback=function(a){if(a&&a.functionPointer){this.menuOptionViewerCallback=a}};obips.ContextMenu.Viewer=function(d,e){obips.ContextMenu.Viewer.baseConstructor.call(this,d,e.floatingWindowManager);this.manager=e;this.controller=new obips.ContextMenu.Controller(this);this.contentRoot=this.floatingWindowDiv;this.contentRoot.id=(this.model.sBaseID?this.model.sBaseID:"")+"contextMenu";this.contentRoot.className+=" masterMenu contextMenu"+(this.model.customStyleClass?(" "+this.model.customStyleClass):"");if(this.model.bLargeMenuIcons){obips.CSS.addClassToElement(this.contentRoot,"contextMenuLarge")}this.scrollPane=new obips.ScrollablePanel(this.contentRoot);this.container=this.scrollPane.getContentContainer();var b=new obips.BrowserEventFramework.EventRouter(this.container,"oncontextmenu");b.addEventListener(new obips.Observable.EventListener(null,new obips.Callback(this.controller,this.controller.rightClickOnContextMenuHandler)));this.contentRoot.contextMenuViewer=this;this.container.contextMenuViewer=this;this.vpatDiv=document.createElement("div");this.vpatDiv.tabIndex=0;this.vpatDiv.title=obips.ResourceManager.getSingleton().getResource(obips.ContextMenu.resourceFile,"kmsgUIContextMenuVpatDivText").getString();this.vpatDiv.className="contextMenuVpatDiv";this.container.appendChild(this.vpatDiv);saw.setAriaRole(this.container,"menu");saw.setAriaProperty(this.container,"aria-activedescendant","");this.optionViewers=new Array();var c;for(c=0;c<this.model.menuOptions.length;c++){var a=this.model.menuOptions[c];if(a){this.optionViewers.push(new obips.ContextMenu.MenuOptionViewer(this,a,this.model.bLargeMenuIcons))}else{new obips.ContextMenu.MenuOptionSeparatorViewer(this)}}};extend(obips.ContextMenu.Viewer,obips.FloatingWindow.Viewer);obips.ContextMenu.Viewer.prototype.hideChildMenu=function(){var b;for(b=0;b<this.optionViewers.length;b++){var a=this.optionViewers[b];if(a.childMenuViewer){a.childMenuViewer.hide();a.childMenuViewer=null;break}}this.setChild(null)};obips.ContextMenu.ChildMenuViewer=function(c,d){obips.ContextMenu.ChildMenuViewer.baseConstructor.call(this,c,d.floatingWindowManager);this.manager=d;this.controller=new obips.ContextMenu.Controller(this);this.model.context.childMenuViewer=this;this.contentRoot=this.floatingWindowDiv;this.contentRoot.id=(this.model.sBaseID?this.model.sBaseID:"")+"childContextMenu";this.contentRoot.className+=" masterMenu contextMenu"+(this.model.customStyleClass?(" "+this.model.customStyleClass):"");if(this.model.bLargeMenuIcons){obips.CSS.addClassToElement(this.contentRoot,"contextMenuLarge")}this.scrollPane=new obips.ScrollablePanel(this.contentRoot);this.container=this.scrollPane.getContentContainer();this.contentRoot.contextMenuViewer=this;this.container.contextMenuViewer=this;saw.setAriaRole(this.container,"menu");saw.setAriaProperty(this.container,"aria-activedescendant","");this.optionViewers=new Array();var b;for(b=0;b<this.model.menuOptions.length;b++){var a=this.model.menuOptions[b];if(a){this.optionViewers.push(new obips.ContextMenu.MenuOptionViewer(this,a,this.model.bLargeMenuIcons))}else{new obips.ContextMenu.MenuOptionSeparatorViewer(this)}}};extend(obips.ContextMenu.ChildMenuViewer,obips.FloatingWindow.Viewer);obips.ContextMenu.ChildMenuViewer.prototype.hide=function(){this.hideChildMenu();if(this.contentRoot.parentNode){this.contentRoot.parentNode.removeChild(this.contentRoot)}};obips.ContextMenu.ChildMenuViewer.prototype.hideChildMenu=function(){var b;for(b=0;b<this.optionViewers.length;b++){var a=this.optionViewers[b];if(a.childMenuViewer){a.childMenuViewer.hide()}}this.setChild(null)};obips.ContextMenu.MenuOptionSeparatorViewer=function(b){var a=document.createElement("div");a.className="masterMenuItemSeparator menuOptionSeparator";b.container.appendChild(a)};obips.ContextMenu.MenuOptionViewer=function(k,h,a){this.contextMenuViewer=k;this.contextMenuOption=h;this.bLargeMenuIcon=a;this.contextMenuOptionDiv=document.createElement("div");this.contextMenuOptionDiv.className="masterMenuItem contextMenuOption";if(a){obips.CSS.addClassToElement(this.contextMenuOptionDiv,"contextMenuOptionLarge")}this.contextMenuOptionDiv.tabIndex=0;if(h.showSeparatorBelow){this.contextMenuOptionDiv.style.borderBottom="1px solid #cccccc"}saw.setAriaRole(this.contextMenuOptionDiv,"menuitem");saw.setAriaProperty(this.contextMenuOptionDiv,"aria-label",this.contextMenuOption.name);if(!(window.obips&&obips.selenium&&obips.selenium.testEnabled)){var f=(this.contextMenuOption.name).replace(/\s+/g,"");this.contextMenuOptionDiv.id=(this.contextMenuOption.sBaseID?this.contextMenuOption.sBaseID:"")+"menuOptionItem_"+f}else{this.contextMenuOptionDiv.id=(this.contextMenuOption.sBaseID?this.contextMenuOption.sBaseID:"")+"menuOptionItem"}obips.selenium.registerObject(this.contextMenuOption.name,this.contextMenuOptionDiv);if(this.contextMenuOption!=null&&this.contextMenuOption.description&&!this.bLargeMenuIcon){this.contextMenuOptionDiv.title=this.contextMenuOption.description}this.contextMenuOptionDiv.onmouseover=this.contextMenuViewer.controller.mouseOverContextMenuOptionHandler;this.contextMenuOptionDiv.onmouseout=this.contextMenuViewer.controller.mouseOutContextMenuOptionHandler;this.contextMenuOptionDiv.onmousedown=this.contextMenuViewer.controller.mouseDownContextMenuOptionHandler;this.contextMenuOptionDiv.onclick=this.contextMenuViewer.controller.clickContextMenuOptionHandler;var j=new obips.BrowserEventFramework.EventRouter(this.contextMenuOptionDiv,"oncontextmenu");j.addEventListener(new obips.Observable.EventListener(null,new obips.Callback(this.contextMenuViewer.controller,this.contextMenuViewer.controller.rightClickOnContextMenuHandler)));var b=new obips.BrowserEventFramework.EventRouter(this.contextMenuOptionDiv,"onkeypress");b.addEventListener(new obips.Observable.EventListener(null,new obips.Callback(this.contextMenuViewer.controller,this.contextMenuViewer.controller.menuOptionKeyPressHandler)));var g=new obips.BrowserEventFramework.EventRouter(this.contextMenuOptionDiv,"onfocus");g.addEventListener(new obips.Observable.EventListener(null,new obips.Callback(this,this.hover)));var e=new obips.BrowserEventFramework.EventRouter(this.contextMenuOptionDiv,"onkeydown");e.addEventListener(new obips.Observable.EventListener(null,new obips.Callback(k.controller,this.contextMenuViewer.controller.menuOptionKeyDownHandler)));this.contextMenuOptionDiv.menuOptionViewer=this;if(this.contextMenuOption!=null&&this.contextMenuOption.disabled){obips.CSS.addClassToElement(this.contextMenuOptionDiv,"masterMenuItemDisabled");obips.CSS.addClassToElement(this.contextMenuOptionDiv,"contextMenuOptionDisabled");this.contextMenuOptionDiv.onclick=this.contextMenuViewer.controller.mouseDownContextMenuOptionHandler;saw.setAriaProperty(this.contextMenuOptionDiv,"aria-disabled","true")}if(this.contextMenuOption!=null&&!this.contextMenuOption.isClickable()){this.contextMenuOptionDiv.onclick=this.contextMenuViewer.controller.mouseDownContextMenuOptionHandler}this.contextMenuOptionTable=document.createElement("table");if(saw.getSessionInfos().isScreenReaderMode()){this.contextMenuOptionTable.setAttribute("role","presentation")}this.contextMenuOptionTable.id=(this.contextMenuOption.sBaseID?this.contextMenuOption.sBaseID:"")+"menuOptionTable";this.contextMenuOptionTable.cellSpacing="0";this.contextMenuOptionTable.cellPadding="0";this.contextMenuOptionTable.tableLayout="fixed";obips.CSS.addClassToElement(this.contextMenuOptionTable,"ContextMenuOptionTable");saw.setAriaRole(this.contextMenuOptionTable,"presentation");var d=saw.createChildElement(this.contextMenuOptionTable,"tbody");this.contextMenuOptionRow=saw.createChildElement(d,"tr");this.contextMenuOptionImageTd=saw.createChildElement(this.contextMenuOptionRow,"td");if(!(window.obips&&obips.selenium&&obips.selenium.testEnabled)){var f=(this.contextMenuOption.name).replace(/\s+/g,"");this.contextMenuOptionImageTd.id=(this.contextMenuOption.sBaseID?this.contextMenuOption.sBaseID:"")+"menuoptionCell_"+f;if(this.contextMenuOption.sBaseID==""){this.contextMenuOptionImageTd.style.verticalAlign="top";if(this.contextMenuOption.icon){this.contextMenuOptionImageTd.style.width="16px"}}}else{if(this.contextMenuOption.icon){this.contextMenuOptionImageTd.id=(this.contextMenuOption.sBaseID?this.contextMenuOption.sBaseID:"")+"menuoptionCell"}else{this.contextMenuOptionImageTd.id=(this.contextMenuOption.sBaseID?this.contextMenuOption.sBaseID:"")+"menuoptionCell_noIcon"}}if(this.contextMenuOption.icon){this.contextMenuOptionIcon=document.createElement("img");this.contextMenuOptionIcon.className="contextMenuIcon";this.contextMenuOptionIcon.src=this.contextMenuOption.icon;this.contextMenuOptionIcon.alt="";var c=this.bLargeMenuIcon?"contextMenuIconLarge":"contextMenuIconSmall";obips.CSS.addClassToElement(this.contextMenuOptionIcon,c);if(this.bLargeMenuIcon){obips.CSS.addClassToElement(this.contextMenuOptionImageTd,"contextMenuOptionImageTdTopAlign")}this.contextMenuOptionImageTd.appendChild(this.contextMenuOptionIcon)}else{var i=this.bLargeMenuIcon?"contextMenuOptionLargeNoIcon":"contextMenuOptionNoIcon";obips.CSS.addClassToElement(this.contextMenuOptionImageTd,i)}this.contextMenuOptionTextTd=saw.createChildElement(this.contextMenuOptionRow,"td");this.contextMenuOptionTextTd.className="contextMenuOptionTextCell";this.contextMenuOptionTextSpan=document.createElement("span");this.contextMenuOptionTextSpan.className="contextMenuOptionText";var m=this.contextMenuOption.name;this.contextMenuOptionText=document.createTextNode(m);this.contextMenuOptionTextSpan.appendChild(this.contextMenuOptionText);this.contextMenuOptionTextTd.appendChild(this.contextMenuOptionTextSpan);if(this.bLargeMenuIcon){this.contextMenuOptionDescriptionSpan=document.createElement("span");this.contextMenuOptionDescriptionSpan.className="contextMenuOptionDescription";this.contextMenuOptionDescription=document.createTextNode(this.contextMenuOption.description);this.contextMenuOptionDescriptionSpan.appendChild(this.contextMenuOptionDescription);this.contextMenuOptionTextTd.appendChild(this.contextMenuOptionDescriptionSpan);if(this.contextMenuOption.description){this.contextMenuOptionTextTd.id=(this.contextMenuOption.sBaseID?this.contextMenuOption.sBaseID:"")+"menuoptionCell"}}this.openSubMenuTd=saw.createChildElement(this.contextMenuOptionRow,"td");this.openSubMenuTd.verticalAlign="middle";obips.CSS.addClassToElement(this.openSubMenuTd,"SubmenuArrowTd");this.openSubMenuImg=null;if(this.contextMenuOption.childMenuOptions){if(this.contextMenuOption.bAllowLeftMenuCallback){obips.CSS.addClassToElement(this.openSubMenuTd,"SubmenuActiveArrowTd");obips.CSS.addClassToElement(this.openSubMenuTd,"masterMenuItemSubMenuArrow")}this.openSubMenuImg=document.createElement("span");this.openSubMenuImg.className="contextMenuSubMenuArrow";saw.appendNBSP(this.openSubMenuImg);this.openSubMenuTd.appendChild(this.openSubMenuImg);saw.setAriaProperty(this.contextMenuOptionDiv,"aria-haspopup","true");if(this.contextMenuOption.isClickable()){obips.CSS.addClassToElement(this.openSubMenuTd,"SubmenuActiveArrowTd");obips.CSS.addClassToElement(this.openSubMenuTd,"masterMenuItemSubMenuArrow");this.openSubMenuTd.onclick=this.contextMenuViewer.controller.mouseDownContextMenuOptionHandler}}this.contextMenuOptionDiv.appendChild(this.contextMenuOptionTable);this.contextMenuViewer.container.appendChild(this.contextMenuOptionDiv);var l=this.contextMenuOption.menuOptionViewerCallback;if(l){l.functionPointer.call(l.thisContext,this)}};obips.ContextMenu.MenuOptionViewer.getMenuOptionViewerDivFromEvent=function(a){a=obips.BrowserEventFramework.normalizeEvent(a);var b=a.target;while(b.tagName!="DIV"){b=b.parentNode}return b};obips.ContextMenu.MenuOptionViewer.prototype.hover=function(e){if(this.contextMenuOption.disabled){return}var g=this.contextMenuViewer.optionViewers;var d;for(d=0;d<g.length;d++){var k=g[d];k.noHover()}var h=" masterMenuItemHover contextMenuOptionHover";if(this.contextMenuOption.isClickable()&&(e==this.openSubMenuTd||e==this.openSubMenuImg)){h+=" masterMenuItemActiveArrow contextMenuOptionActiveArrow"}this.contextMenuOptionDiv.className=this.contextMenuOptionDiv.className+h;var j=(saw.userAgent.is_ie&&saw.userAgent.is_ie8down)?(this.contextMenuOptionTextSpan.scrollWidth+8):this.contextMenuOptionTextSpan.scrollWidth;var c=j>this.contextMenuOptionTextSpan.clientWidth?true:false;var l=this.contextMenuOptionDiv.title==null||this.contextMenuOptionDiv.title==""?true:false;if(l&&c){this.contextMenuOptionDiv.title=this.contextMenuOption.name}if(this.contextMenuOption.showSeparatorBelow){this.contextMenuOptionDiv.style.paddingBottom="2px"}if(this.contextMenuOption.childMenuOptions&&this.contextMenuOption.childMenuOptions.length>0){var b=(this.contextMenuViewer.model.originalContext)?this.contextMenuViewer.model.originalContext:this.contextMenuViewer.model.context;var f=new obips.ContextMenu.Model(this,this.contextMenuOption.childMenuOptions,this.contextMenuOption.bLargeSubmenuOptions);f.setCustomStyleClass(this.contextMenuViewer.model.customStyleClass);f.originalContext=b;var a=new obips.ContextMenu.ChildMenuViewer(f,this.contextMenuViewer.manager);this.contextMenuViewer.setChild(a);this.contextMenuViewer.manager.floatingWindowManager.prepareDisplay(a);this.childMenuViewer.setLaunchElement(this.contextMenuViewer.launchElement);a.scrollPane.resize(saw.getClientHeight());this.contextMenuViewer.manager.floatingWindowManager.displayAtPosition(a,saw.Position.createByDOMElement(this.contextMenuOptionDiv,"right"))}};obips.ContextMenu.MenuOptionViewer.prototype.noHover=function(){obips.CSS.removeClassFromElement(this.contextMenuOptionDiv,"masterMenuItemHover");obips.CSS.removeClassFromElement(this.contextMenuOptionDiv,"contextMenuOptionHover");obips.CSS.removeClassFromElement(this.contextMenuOptionDiv,"masterMenuItemActiveArrow");obips.CSS.removeClassFromElement(this.contextMenuOptionDiv,"contextMenuOptionActiveArrow");this.contextMenuViewer.hideChildMenu()};obips.ContextMenu.Controller=function(b){obips.ContextMenu.Controller.baseConstructor.call(this,b);this.menuOptionsUpdatedEventListener=new obips.Observable.EventListener(obips.ContextMenu.Model.EventType.MENU_OPTIONS_UPDATED,new obips.Callback(this,this.menuOptionsUpdatedHandler));this.viewer.model.addEventListener(this.menuOptionsUpdatedEventListener);var a=new obips.BrowserEventFramework.EventRouter(this.viewer.floatingWindowDiv,"onkeyup");a.addEventListener(new obips.Observable.EventListener(null,new obips.Callback(this,this._keyUpHandler)))};extend(obips.ContextMenu.Controller,obips.FloatingWindow.Controller);obips.ContextMenu.Controller.prototype.cleanupBeforeDestroy=function(){var d=this.viewer.container.childNodes;if(!d||d.length==0){return}for(var b=0;b<d.length;b++){var c=d[b].menuOptionViewer;if(c&&c.contextMenuOption&&c.contextMenuOption.onCloseCallback){var a=c.contextMenuOption;if(a.iNotifyOption==obips.ContextMenu.MenuOption.NOTIFY_FIRST_MENU_OPT){a.onCloseCallback.exec(this.viewer.container,a);break}else{a.onCloseCallback.exec(this.viewer.container,a)}}}this.viewer.model.notify(new obips.Observable.Event(obips.ContextMenu.EventType.CONTEXT_MENU_DESTROYED,{contextMenuViewer:this.currentContextMenuViewer}))};obips.ContextMenu.Controller.prototype.focusMenuOption=function(a){a.focus();saw.setAriaProperty(this.viewer.container,"aria-activedescendant",a.id)};obips.ContextMenu.Controller.prototype._keyUpHandler=function(h,c){var k=c&&h.keyCode==9;var d;if(h.keyCode==27){var e=obips.BrowserEventFramework.getViewerFromEvent(h,"contextMenuViewer");if(e){e.focusLaunchElement();e.manager.hide(h);obips.BrowserEventFramework.cancelBubble(h);return}}else{if(h.keyCode>=37&&h.keyCode<=40||k){var j=obips.ContextMenu.MenuOptionViewer.getMenuOptionViewerDivFromEvent(h).menuOptionViewer;if(!j){return}if(h.keyCode==37){var a=j.contextMenuViewer.parentFloatingWindow;if(a){for(d=0;d<a.optionViewers.length;d++){var b=a.optionViewers[d];if(b.childMenuViewer){this.focusMenuOption(b.contextMenuOptionDiv);break}}}}else{if(h.keyCode==39){if(j.contextMenuOption.childMenuOptions){this.focusMenuOption(j.contextMenuViewer.childFloatingWindow.optionViewers[0].contextMenuOptionDiv)}}else{if(h.keyCode==38||h.shiftKey&&k){if(j){var f=j.contextMenuViewer.optionViewers;var g=null;for(d=0;d<f.length;d++){if(f[d]==j){g=d;break}}if(g>0){this.focusMenuOption(f[g-1].contextMenuOptionDiv)}else{this.focusMenuOption(f[f.length-1].contextMenuOptionDiv)}}else{var e=obips.BrowserEventFramework.getViewerFromEvent(h,"contextMenuViewer");this.focusMenuOption(e.optionViewers[Math.max(0,e.optionViewers.length-1)].contextMenuOptionDiv)}}else{if(h.keyCode==40||h.keyCode==9){if(j){var g=null;var f=j.contextMenuViewer.optionViewers;for(d=0;d<f.length;d++){if(f[d]==j){g=d;break}}if(g<f.length-1){this.focusMenuOption(f[g+1].contextMenuOptionDiv)}else{this.focusMenuOption(f[0].contextMenuOptionDiv)}}else{var e=obips.BrowserEventFramework.getViewerFromEvent(h,"contextMenuViewer");this.focusMenuOption(e.optionViewers[0].contextMenuOptionDiv)}}}}}obips.BrowserEventFramework.cancelBubble(h);saw.preventEventDefault(h)}}};obips.ContextMenu.Controller.prototype.menuOptionKeyDownHandler=function(a){if(a.keyCode==9){this._keyUpHandler(a,true)}};obips.ContextMenu.Controller.prototype.menuOptionsUpdatedHandler=function(){saw.clearInnerHTML(this.viewer.container);var a=this.viewer.model.menuOptions;this.viewer.optionViewers=new Array();var b;for(b=0;b<a.length;b++){if(a[b]){this.viewer.optionViewers.push(new obips.ContextMenu.MenuOptionViewer(this.viewer,a[b],this.viewer.model.bLargeMenuIcons))}else{new obips.ContextMenu.MenuOptionSeparatorViewer(this)}}};obips.ContextMenu.Controller.prototype.mouseOverContextMenuOptionHandler=function(b){b=obips.BrowserEventFramework.normalizeEvent(b);var a=obips.ContextMenu.MenuOptionViewer.getMenuOptionViewerDivFromEvent(b);var c=a.menuOptionViewer;c.hover(b.target)};obips.ContextMenu.Controller.prototype.mouseOutContextMenuOptionHandler=function(c){c=obips.BrowserEventFramework.normalizeEvent(c);var a=obips.ContextMenu.MenuOptionViewer.getMenuOptionViewerDivFromEvent(c);var d=a.menuOptionViewer;if(d.contextMenuOption.cbMouseOut){d.contextMenuOption.cbMouseOut.exec(cmEvent)}var b=c.relatedTarget;if(b){var e=obips.BrowserEventFramework.getViewerFromElement(b,"contextMenuViewer");if(d.childMenuViewer==null||e!=d.childMenuViewer){d.noHover()}if(d.contextMenuViewer.model.context&&d.contextMenuViewer.model.context.childMenuViewer){if(e==d.contextMenuViewer.model.context.contextMenuViewer){e.hideChildMenu();d.contextMenuViewer.model.context.noHover()}}}};obips.ContextMenu.Controller.prototype.mouseDownContextMenuOptionHandler=function(a){a=obips.BrowserEventFramework.normalizeEvent(a);if(a.button==1){a.cancelBubble=true}if(a.button==0&&a.stopPropagation){a.stopPropagation()}};obips.ContextMenu.Controller.prototype.clickContextMenuOptionHandler=function(b){var a=obips.ContextMenu.MenuOptionViewer.getMenuOptionViewerDivFromEvent(b);var f=a.menuOptionViewer;var c=(f.contextMenuViewer.model.originalContext)?f.contextMenuViewer.model.originalContext:f.contextMenuViewer.model.context;var d=new obips.ContextMenu.EventContext.ContextMenuOptionPickedContext(c,f.contextMenuOption);d.tBrowserEvt=(null!=b)?b:window.event;var e=new obips.Observable.Event(obips.ContextMenu.EventType.CONTEXT_MENU_OPTION_PICKED,d);if(!d.menuOption||!d.menuOption.bMultiselect||(d.menuOption.bMultiselect&&d.menuOption.bMultiselect==false)){f.contextMenuViewer.manager.hide()}if(f.contextMenuOption.callback){f.contextMenuOption.callback.exec(e)}return false};obips.ContextMenu.Controller.prototype.rightClickOnContextMenuHandler=function(a){a=obips.BrowserEventFramework.normalizeEvent(a);a.returnValue=false;obips.BrowserEventFramework.preventEventBrowserDefaultBehavior(a);obips.BrowserEventFramework.cancelBubble(a);return false};obips.ContextMenu.Controller.prototype.menuOptionKeyPressHandler=function(c){if(c.keyCode==32||c.charCode==32||c.keyCode==13){var a=obips.ContextMenu.MenuOptionViewer.getMenuOptionViewerDivFromEvent(c);var d=a.menuOptionViewer;var b=d.childMenuViewer;if(d.contextMenuOption.isClickable()){this.clickContextMenuOptionHandler(c);obips.BrowserEventFramework.cancelBubble(c)}else{if(b&&b.optionViewers){this.focusMenuOption(b.optionViewers[0].contextMenuOptionDiv);obips.BrowserEventFramework.cancelBubble(c)}}}};obips.ContextMenu.MobileViewer=function(l,n,b){obips.ContextMenu.MobileViewer.baseConstructor.call(this,l,n.floatingWindowManager);this.manager=n;this.controller=new obips.ContextMenu.MobileController(this);this.isMobile=true;this.container=document.createElement("DIV");this.container.id=(this.model.sBaseID?this.model.sBaseID:"")+"contextMenuContainer";this.container.className+="ui-mobile-menu-container";this.container.contextMenuViewer=this;var f=false;var k=0;var j;for(j=0;j<this.model.menuOptions.length;j++){var d=this.model.menuOptions[j];if(d){if(d.childMenuOptions){var f=true}k++}}var h="blue";if(l.theme){h=l.theme}if(!f){if(k>2){h+="-nh1"}else{h+="-nh2"}}var m=null;if(f){m=obips.ResourceManager.getSingleton().getResource(obips.ContextMenu.resourceFile,"kmsgUIContextMenuMobileDefaultTitle").getString();var g=null;if(b.evt!=undefined){g=b.evt.target}else{if(b.refDOMElement!=undefined){g=b.refDOMElement}}if(g!=undefined){var e=g.textContent||g.title||g.value;if((e!=undefined)&&(e!="")){m=e}}}var o=new obips.Callback(this.controller,this.controller.optionSelectionHandler);var a=new obips.Callback(this.manager,this.manager.hide);if(saw.userAgent.is_touchdevice){}var p={parent:this.floatingWindowDiv,id:this.container.id+"_mobileWrapper",bIncludeHeaderContent:f,title:m,titleAlignment:"center",bIncludeBackButton:true,bodyContent:this.container,bUseTransition:false,bUseInsetShadow:true,theme:h,position:b,oCloseCallback:a,baseMenuModel:l,optionSelectionCallback:o};var c=new obips.mobile.ContextMenu.ViewerModel(p);this.mobilePopUpViewer=new obips.mobile.ContextMenu.Viewer(c);this.mobilePopUpViewer.display();this.vpatDiv=this.mobilePopUpViewer.getAccessibilityDiv()};extend(obips.ContextMenu.MobileViewer,obips.FloatingWindow.Viewer);obips.ContextMenu.MobileViewer.prototype.hideChildMenu=function(){};obips.ContextMenu.MobileController=function(a){obips.ContextMenu.MobileController.baseConstructor.call(this,a);this.menuOptionsUpdatedEventListener=new obips.Observable.EventListener(obips.ContextMenu.Model.EventType.MENU_OPTIONS_UPDATED,new obips.Callback(this,this.menuOptionsUpdatedHandler));this.viewer.model.addEventListener(this.menuOptionsUpdatedEventListener)};extend(obips.ContextMenu.MobileController,obips.FloatingWindow.Controller);obips.ContextMenu.MobileController.prototype.cleanupBeforeDestroy=function(){var d=null;if(this.viewer.mobilePopUpViewer){var c=this.viewer.mobilePopUpViewer.getCurrentContextMenuModel();if(c){d=c.menuOptions}}if(!d||d.length==0){return}var b;for(b=0;b<d.length;b++){var a=d[b];if(a&&a.onCloseCallback){if(a.iNotifyOption==obips.ContextMenu.MenuOption.NOTIFY_FIRST_MENU_OPT){a.onCloseCallback.exec(this.viewer.container,a);break}else{a.onCloseCallback.exec(this.viewer.container,a)}}}this.viewer.model.notify(new obips.Observable.Event(obips.ContextMenu.EventType.CONTEXT_MENU_DESTROYED,{contextMenuViewer:this.currentContextMenuViewer}));if(this.viewer.mobilePopUpViewer){this.viewer.mobilePopUpViewer=null}};obips.ContextMenu.MobileController.prototype.optionSelectionHandler=function(c,a){if(c!=undefined){if(!c.disabled&&!c.childMenuOptions){var b=this.viewer.model.context;var d=new obips.ContextMenu.EventContext.ContextMenuOptionPickedContext(b,c);d.tBrowserEvt=(null!=a)?a:window.event;var e=new obips.Observable.Event(obips.ContextMenu.EventType.CONTEXT_MENU_OPTION_PICKED,d);if(!d.menuOption||!d.menuOption.bMultiselect||(d.menuOption.bMultiselect&&d.menuOption.bMultiselect==false)){this.viewer.manager.hide()}if(c.callback){c.callback.exec(e)}}}a=obips.BrowserEventFramework.normalizeEvent(a);if(a.button==1){a.cancelBubble=true}if(a.button==0&&a.stopPropagation){a.stopPropagation()}return false};obips.ContextMenu.MobileController.prototype.menuOptionsUpdatedHandler=function(){try{var a=this.viewer.model;if(this.viewer.mobilePopUpViewer){this.viewer.mobilePopUpViewer.updateMenuList(a)}}catch(b){}};if(obips&&obips.mobile&&obips.mobile.PopUpWindow){obips.mobile.ContextMenu=function(){};obips.mobile.ContextMenu.ViewerModel=function(a){if(a==undefined){a=new Object()}if(a.defaultMaxOptions==undefined){a.defaultMaxOptions=6.5}if(a.defaultOptionHeight==undefined){a.defaultOptionHeight=42}obips.mobile.ContextMenu.ViewerModel.baseConstructor.call(this,a)};saw.extend(obips.mobile.ContextMenu.ViewerModel,obips.mobile.PopUpWindow.ViewerModel);obips.mobile.ContextMenu.Viewer=function(a){obips.mobile.ContextMenu.Viewer.baseConstructor.call(this,a)};saw.extend(obips.mobile.ContextMenu.Viewer,obips.mobile.PopUpWindow.Viewer);obips.mobile.ContextMenu.Viewer.prototype.buildPopUpBody=function(){obips.mobile.ContextMenu.Viewer.superClass.buildPopUpBody.call(this);var c=this.vm.options;var b=$(this.header).find(".ui-mobile-header-title");if(b.get(0)){b.get(0).className="ui-mobile-menu-header-title"}var a=c.baseMenuModel;this.bodyFirstChild=saw.getFirstChildElement(this.innerBody);if(this.bodyFirstChild==undefined){this.bodyFirstChild=this.innerBody.appendChild(document.createElement("DIV"))}this.vpatDiv=document.createElement("div");this.vpatDiv.tabIndex=0;this.vpatDiv.title=obips.ResourceManager.getSingleton().getResource(obips.ContextMenu.resourceFile,"kmsgUIContextMenuVpatDivText").getString();this.vpatDiv.className="contextMenuVpatDiv";this.bodyFirstChild.appendChild(this.vpatDiv);this.parentMenuChain=new Array();this.parentTitleChain=new Array();this.currentModel=a;this.currentTitle=c.title;this.updateMenuList(this.currentModel)};obips.mobile.ContextMenu.Viewer.prototype.display=function(){if(this.vm.options.bIncludeHeaderContent){this.updateHeader(false)}var a="click";saw.addEventListener(this.container,"touchend",this.containerClickHandler,this,true);saw.addEventListener(this.container,a,this.containerClickHandler,this,true)};obips.mobile.ContextMenu.Viewer.prototype.backButtonHandler=function(a){try{this.openParentMenu();if(a){saw.stopEventPropagation(a);saw.preventEventDefault(a)}}catch(b){saw.logicErrorAlert("Error: "+b)}};obips.mobile.ContextMenu.Viewer.prototype.orientationChangeHandler=function(a){};obips.mobile.ContextMenu.Viewer.prototype.getAccessibilityDiv=function(){return this.vpatDiv};obips.mobile.ContextMenu.Viewer.prototype.getCurrentContextMenuModel=function(){return this.currentModel};obips.mobile.ContextMenu.Viewer.prototype.updateHeader=function(b,c){if(this.backButton){if(b){this.backButton.style.display="block";if(saw.isRToL()){this.titleDiv.style.paddingRight="70px";this.titleDiv.style.paddingLeft="40px"}else{this.titleDiv.style.paddingRight="40px";this.titleDiv.style.paddingLeft="70px"}if((this.backButton.title==undefined)||(this.backButton.title=="")){var a=obips.ResourceManager.getSingleton().getResource(obips.ContextMenu.resourceFile,"kmsgUIContextMenuMobileBackButtonText").getString();this.backButton.title=a;this.backButton.setAttribute("role","button");this.backButton.setAttribute("aria-label",a)}}else{this.titleDiv.style.paddingRight="5px";this.titleDiv.style.paddingLeft="5px";this.backButton.style.display="none"}}if(c!=undefined){this.setTitleText(c)}};obips.mobile.ContextMenu.Viewer.prototype.updateMenuList=function(c){if(this.lvViewer==undefined){var b=new obips.Callback(this,this.handleOptionSelection);this.lvViewer=new obips.mobile.ListView.Viewer(c,this.bodyFirstChild,b)}else{var a=this.vm.options.defaultOptionHeight-2;this.lvViewer.refreshView(c,a+"px")}if(this.menuScroll){this.menuScroll.refresh();if(this.menuScroll.scroller){this.menuScroll.scroller.style.webkitTransform="translate(0px,0px)"}}};obips.mobile.ContextMenu.Viewer.prototype.openChildMenu=function(b,c){this.parentMenuChain.push(this.currentModel);this.parentTitleChain.push(this.currentTitle);this.currentModel=b;this.currentTitle=c.name||" ";this.updateHeader(true,this.currentTitle);this.updateMenuList(b);$(this.bodyFirstChild).css("-webkit-transform","translate(0px,0px)");var a="left";if(saw.isRToL()){a="right"}obips.mobile.Transition.slide(this.bodyFirstChild,{time:400,direction:a});this.checkIfRepositioReq()};obips.mobile.ContextMenu.Viewer.prototype.openParentMenu=function(){if(this.parentMenuChain.length<=0){return}this.currentModel=this.parentMenuChain.pop();this.currentTitle=this.parentTitleChain.pop();var b=(this.parentMenuChain.length>=1);this.updateHeader(b,this.currentTitle);this.updateMenuList(this.currentModel);$(this.bodyFirstChild).css("-webkit-transform","translate(0px,0px)");var a="right";if(saw.isRToL()){a="left"}obips.mobile.Transition.slide(this.bodyFirstChild,{time:400,direction:a});this.checkIfRepositioReq()};obips.mobile.ContextMenu.Viewer.prototype.checkIfRepositioReq=function(){if(this.vertPos=="bottom"){this.baseMenuReposition()}else{if(this.vertPos=="middle"){var b=parseInt($(this.arrow).css("top"));var c=b+this.vm.options.ARROW_WIDTH*2;var a=$(this.container).outerHeight(true);if(a<c){this.baseMenuReposition()}}}};obips.mobile.ContextMenu.Viewer.prototype.handleOptionSelection=function(c,a){var f=this.vm.options;var d=f.baseMenuModel;if((c!=undefined)||(menuViewer!=undefined)){if(c.disabled){}else{if(c.childMenuOptions&&c.childMenuOptions.length>0){var b=(d.originalContext)?d.originalContext:d.context;var e=new obips.ContextMenu.Model(this,c.childMenuOptions);e.originalContext=b;this.openChildMenu(e,c)}else{if(f.optionSelectionCallback){f.optionSelectionCallback.exec(c,a)}}}}a=obips.BrowserEventFramework.normalizeEvent(a);if(a.button==1){a.cancelBubble=true}if(a.button==0&&a.stopPropagation){a.stopPropagation()}return false};obips.mobile.ContextMenu.Viewer.prototype.containerClickHandler=function(a){obips.mobile.ListItem.Viewer.removeTextTooltip(a);if(a){saw.stopEventPropagation(a);saw.preventEventDefault(a)}};obips.mobile.ContextMenu.Viewer.prototype.baseMenuDisplay=function(){this.baseMenuResize();this.baseMenuReposition();this.container.style.visibility="visible";var c=this.vm.options;if(c.bUseTransition){this.parentElem.style.visibility="visible";this.parentElem.style.display="none";obips.mobile.Transition.pop(this.parentElem,{time:"fast",direction:"in"})}else{this.container.style.visibility="visible"}try{var a=this;this.addIScrollFunc=function(){if(a.menuScroll){a.menuScroll.destroy(true);a.menuScroll=null}var d=a.getScrollableContentID();var f=new Function("var f=arguments.callee; return f.func.apply(f.thisContext, arguments);");f.thisContext=a;f.func=a.handleTranslate3dBug;var e={onScrollEnd:f};a.menuScroll=new iScroll(d,e);if(a.menuScroll.scroller){a.menuScroll.scroller.style.webkitTransform="translate(0px,0px)"}};setTimeout(a.addIScrollFunc,100)}catch(b){}};obips.mobile.ContextMenu.Viewer.prototype.baseMenuResize=function(){var e=this.vm.options;var b=330;if(e.bIncludeHeaderContent){this.container.style.minWidth=b+"px"}else{this.container.style.minWidth=(b-100)+"px"}this.container.style.maxWidth=b+"px";this.parentElem.style.width=$(this.container).outerWidth(true)+"px";this.parentElem.style.maxWidth=b+"px";var c=e.defaultOptionHeight*e.defaultMaxOptions+3;this.innerBody.style.maxHeight=c+"px";var a=$(this.header).outerHeight(true);var d=(c+e.borderWidth+1);this.body.style.maxHeight=d+"px";this.container.style.maxHeight=(a+d)+"px";this.parentElem.style.maxHeight=(a+d)+"px";this.buildRoundedCorners()};obips.mobile.ContextMenu.Viewer.prototype.baseMenuReposition=function(){var M=this.vm.options;var p=$(this.container).outerWidth(true);var P=$(this.container).outerHeight(true);var x=Math.ceil(p/2);var I=Math.ceil(P/2);var R=obips.HTMLDOM.getFrameWidth(window);var S=obips.HTMLDOM.getFrameHeight(window);var X=window.scrollX;var D=window.scrollY;var W=X+R;var B=D+S;var T=navigator.userAgent;T=T.toLowerCase();var q=(T.indexOf("iphone")!=-1);if(!M.position||q){this.parentElem.style.left=((R/2-p/2)+X)+"px";this.parentElem.style.top=((S/2-P/2)+D)+"px";return}var i=M.position.refDOMElement;if((i==undefined)&&(M.position.evt!=undefined)){i=M.position.evt.target}if(i!=undefined){var r=$(i).parents(".ui-mobile-popup-container");if(r.get(0)!=undefined){return}}M.ARROW_WIDTH=20;var a=Math.max(I,S*0.1);var V=Math.max(x,R*0.2);if(M.bIncludeHeaderContent){a=Math.max(a,150)}var m=null;var j=null;if((M.position.refDOMElement!=undefined)||isNaN(parseInt(M.position.xPos))||isNaN(parseInt(M.position.yPos))){var N=M.position.refDOMElement;if(N==undefined){return}var v=$(N).offset();var Q=$(N).outerWidth();var L=$(N).outerHeight();var c=Math.max(v.left,X);var H=Math.max(v.top,D);var b=Math.min((v.left+Q),W);var G=Math.min((v.top+L),B);Q=b-c;L=G-H;var l=(H+L/2);if((l-D)<a){M.position.yPos=G;M.position.xPos=(c+Q/2);j="top"}else{if((B-l)<a){M.position.yPos=H;M.position.xPos=(c+Q/2);j="bottom"}else{M.position.yPos=(H+L/2);if(this.horzPos=="right"){M.position.xPos=c;m="right";a-=(L/2)}else{if((W-b)>=(p+M.ARROW_WIDTH)){M.position.xPos=b;m="left";a-=(L/2)}else{if((c-X)>=(p+M.ARROW_WIDTH)){M.position.xPos=c;m="right";a-=(L/2)}else{if((B-G)>=(P+M.ARROW_WIDTH)){M.position.xPos=(c+Q/2);M.position.yPos=G;j="top"}else{if((H-D)>=(P+M.ARROW_WIDTH)){M.position.xPos=(c+Q/2);M.position.yPos=H;j="bottom"}else{this.parentElem.style.left=((R/2-p/2)+X)+"px";this.parentElem.style.top=((S/2-P/2)+D)+"px";return}}}}}}}}var z=M.position.xPos;var y=M.position.yPos;if(M.position.evtDocument){if(M.position.evtDocument!=M.position.ownerDocument){var U=saw.getDocumentOwnerWindow(M.position.evtDocument).frameElement;if(U){var s=saw.Region.getRegion(U);z+=s.left-saw.getDocumentScrollLeft(M.position.evtDocument);y+=s.top-saw.getDocumentScrollTop(M.position.evtDocument)}}}var F="left";var f="middle";if((y-D)<a){f="top"}else{if((B-y)<a){f="bottom"}}if(j!=undefined){f=j}var u=p;if(f=="top"||f=="bottom"){u=u/2}else{u+=20}var e=Math.min(R/2,u);if((W-z)<e){F="right"}else{if((f=="top")||(f=="bottom")){if((z-X)<x){F="left"}else{F="center"}}}if(m!=undefined){F=m}var w=-(M.ARROW_WIDTH*2);if(this.arrow){this.arrow.parentNode.removeChild(this.arrow)}var A=this.container.appendChild(document.createElement("DIV"));if((f=="top")||(f=="bottom")){A.className="ui-mobile-diamond-arrow ui-mobile-diamond-arrow-"+f;if(f=="top"){$(A).css(f,-M.ARROW_WIDTH+"px")}else{$(A).css(f,-(M.ARROW_WIDTH+29+1)+"px")}if(F=="left"){$(A).css(F,(29-M.borderWidth)+"px")}else{if(F=="right"){$(A).css(F,(M.borderWidth-9)+"px")}else{$(A).css("left",x+"px")}}if(f=="top"){var g=this.container.appendChild(document.createElement("DIV"));g.className="ui-mobile-arrow-top-border-blocker ui-mobile-arrow-top-border-blocker-"+M.theme;$(g).css("top","0px");var t=38;if(F=="left"){$(g).css(F,((29-M.borderWidth)-t/2)+"px")}else{if(F=="right"){$(g).css(F,"6px")}else{$(g).css("left",(x-t/2)+"px")}}}}else{if(F=="left"){$(A).css(F,-M.ARROW_WIDTH+"px")}else{$(A).css("right",-(M.ARROW_WIDTH+29+1)+"px")}$(A).css("top",I+"px");A.className="ui-mobile-diamond-arrow ui-mobile-diamond-arrow-"+F}$(A).css("z-index",0);if(f=="top"){$(A).addClass("ui-mobile-diamond-arrow-top-"+M.theme)}else{$(A).addClass("ui-mobile-diamond-arrow-bottom-"+M.theme)}$(A).addClass("ui-mobile-diamond-arrow-border-"+M.theme);this.arrow=A;var k=0;var J=0;if(f=="top"){J=M.ARROW_WIDTH}else{if(f=="bottom"){J=-(M.ARROW_WIDTH+P)}else{J=-I}}if(f=="top"||f=="bottom"){if(F=="right"){k=-(p-M.ARROW_WIDTH)}else{if(F=="center"){k=-x}else{k=-M.ARROW_WIDTH}}}else{if(F=="right"){k=-(p+M.ARROW_WIDTH)}else{k=M.ARROW_WIDTH}}this.parentElem.style.left=(z+k)+"px";this.parentElem.style.top=(y+J)+"px";this.vertPos=f;if(f=="middle"){var h=(y+J);var O=parseInt(this.parentElem.style.maxHeight);var n=B-h-(M.borderWidth+1);if(n<O){this.parentElem.style.maxHeight=n+"px";this.innerBody.style.maxHeight=(n-40-6)+"px"}}var C=(z+k);var K=p;var d=(f=="middle")?M.ARROW_WIDTH:0;var E=null;if(C<0){E=(K+C-1)}else{if((K+C+d)>W){E=(W-C-d-1)}}if((E!=null)&&!isNaN(E)){this.parentElem.style.width=E+"px";this.parentElem.style.maxWidth=E+"px";this.container.style.minWidth=E+"px";this.container.style.maxWidth=E+"px";if(C<0){this.parentElem.style.left="1px"}this.buildRoundedCorners();this.horzPos=F}};obips.mobile.ContextMenu.Viewer.prototype.handleTranslate3dBug=function(){if(this.menuScroll){if(this.menuScroll.scroller){obips.mobile.ContextMenu.Viewer.setTranslateTransform(this.menuScroll.scroller)}if(this.menuScroll.vScrollBarIndicator){obips.mobile.ContextMenu.Viewer.setTranslateTransform(this.menuScroll.vScrollBarIndicator)}if(this.menuScroll.hScrollBarIndicator){obips.mobile.ContextMenu.Viewer.setTranslateTransform(this.menuScroll.hScrollBarIndicator)}}};obips.mobile.ContextMenu.Viewer.getMaxMenuLength=function(d){var f=-1;var e=0;var c;for(c=0;c<d.length;c++){var b=d[c];if(b){if(b.childMenuOptions){var a=obips.mobile.ContextMenu.Viewer.getMaxMenuLength(b.childMenuOptions);f=Math.max(f,a)}e++}}return Math.max(f,e)};obips.mobile.ContextMenu.Viewer.setTranslateTransform=function(f){if(f&&(f.style.webkitTransform!=undefined)){var c=f.style.webkitTransform;var e=c.indexOf("translate3d");if(e==0){var a=c.substring(12);var d=a.split(",");var b="translate("+d[0]+","+d[1]+")";f.style.webkitTransform=b}}};obips.mobile.ListView=function(){};obips.mobile.ListView.Viewer=function(c,a,b){this.cmModel=c;this.container=a;this.oCallback=b;this.refreshView(this.cmModel)};obips.mobile.ListView.Viewer.prototype.refreshView=function(m,a){this.cmModel=m;if(this.container==undefined){this.container=document.createElement("DIV")}if(this.lv){saw.clearInnerHTML(this.lv)}else{this.lv=document.createElement("DIV");this.lv.style.position="relative";this.container.appendChild(this.lv)}var p=this.cmModel.menuOptions;var d=false;var e;for(e=0;e<p.length;e++){var j=p[e];if(j&&(j.mobileIcon!=undefined)){d=true;break}}var f;for(f=0;f<p.length;f++){var j=p[f];if(j){var o=new obips.Callback(this,this.optionSelectedHandler);var n=(f==0);var c=(f==p.length-1);var l=new obips.mobile.ListItem.Model(j,o,n,c,d);var h=new obips.mobile.ListItem.Viewer(l,this.lv);if(a){var b=h.getItemDiv();b.style.height=a}}else{var g=document.createElement("DIV");g.className="ui-mobile-menuOption-seperator";this.lv.appendChild(g)}}};obips.mobile.ListView.Viewer.prototype.optionSelectedHandler=function(d,a){if(this.oCallback){this.oCallback.exec(d,a)}else{if(d!=undefined){if(d.disabled){}else{if(d.childMenuOptions&&d.childMenuOptions.length>0){var c=(this.cmModel.originalContext)?this.cmModel.originalContext:this.cmModel.context;var f=new obips.ContextMenu.Model(this,d.childMenuOptions);f.originalContext=c;var b=d.name;if(b==undefined){b=" "}this.refreshView(f)}else{var c=(this.cmModel.originalContext)?this.cmModel.originalContext:this.cmModel.context;var e=new obips.ContextMenu.EventContext.ContextMenuOptionPickedContext(c,d);e.tBrowserEvt=(null!=a)?a:window.event;var g=new obips.Observable.Event(obips.ContextMenu.EventType.CONTEXT_MENU_OPTION_PICKED,e);if(d.callback){d.callback.exec(g)}}}}a=obips.BrowserEventFramework.normalizeEvent(a);if(a.button==1){a.cancelBubble=true}if(a.button==0&&a.stopPropagation){a.stopPropagation()}return false}};obips.mobile.ListView.Viewer.prototype.getListDiv=function(){return this.lv};obips.mobile.ListItem=function(){};obips.mobile.ListItem.Model=function(b,e,d,c,a){this.contextMenuOption=b;this.oClickHandler=e;this.bFirstOption=d;this.bLastOption=c;this.bLeaveSpaceForIcon=(a==true)};obips.mobile.ListItem.Viewer=function(e,c){this.liModel=e;var f=this.liModel.contextMenuOption;this.contextMenuOptionDiv=document.createElement("div");this.contextMenuOptionDiv.className="ui-mobile-menuOption";if(saw.isRToL()){this.contextMenuOptionDiv.style.textAlign="right"}else{this.contextMenuOptionDiv.style.textAlign="left"}this.contextMenuOptionDiv.tabIndex=0;if(this.liModel.bFirstOption){obips.CSS.addClassToElement(this.contextMenuOptionDiv,"ui-mobile-menuOption-first")}if(this.liModel.bLastOption){obips.CSS.addClassToElement(this.contextMenuOptionDiv,"ui-mobile-menuOption-last")}if(f.showSeparatorBelow){this.contextMenuOptionDiv.style.borderBottom="1px solid #cccccc"}if(this.liModel.contextMenuOption!=null&&f.description){this.contextMenuOptionDiv.title=f.description}var d=5;var h=5;var b=(f.mobileIcon!=undefined);if(b){this.contextMenuOptionIcon=document.createElement("img");this.contextMenuOptionIcon.className="ui-mobile-menuOption-itemIcon";this.contextMenuOptionIcon.src=f.mobileIcon;this.contextMenuOptionIcon.alt="";var g=5;if(saw.isRToL()){this.contextMenuOptionIcon.style.right=g+"px"}else{this.contextMenuOptionIcon.style.left=g+"px"}this.contextMenuOptionDiv.appendChild(this.contextMenuOptionIcon)}if(b||this.liModel.bLeaveSpaceForIcon){var a=37;if(saw.isRToL()){h=a}else{d=a}}this.openSubMenuImg=null;if(f.childMenuOptions){this.openSubMenuImg=document.createElement("DIV");this.openSubMenuImg.className="ui-mobile-menuOption-submenuIcon";if(saw.isRToL()){this.openSubMenuImg.style.left="0px";d=40}else{this.openSubMenuImg.style.right="0px";h=40}saw.appendNBSP(this.openSubMenuImg);this.contextMenuOptionDiv.appendChild(this.openSubMenuImg)}this.contextMenuOptionTextLabel=this.contextMenuOptionDiv.appendChild(document.createElement("DIV"));this.contextMenuOptionTextLabel.appendChild(document.createTextNode(f.name));this.contextMenuOptionTextLabel.className="ui-mobile-menuOption-text";this.contextMenuOptionTextLabel.style.paddingLeft=d+"px";this.contextMenuOptionTextLabel.style.paddingRight=h+"px";if(this.contextMenuOptionDiv!=null&&f.disabled){obips.CSS.addClassToElement(this.contextMenuOptionDiv,"ui-mobile-menuOption-disabled")}c.appendChild(this.contextMenuOptionDiv);this.setEventListeners()};obips.mobile.ListItem.Viewer.prototype.setEventListeners=function(){var c=saw.userAgent.is_touchdevice?"touchstart":"mousedown";saw.addEventListener(this.contextMenuOptionDiv,c,this.activeHandler,this,true);var c=saw.userAgent.is_touchdevice?"touchend":"mouseup";saw.addEventListener(this.contextMenuOptionDiv,c,this.inactiveHandler,this,true);var c=saw.userAgent.is_touchdevice?"click":"click";saw.addEventListener(this.contextMenuOptionDiv,c,this.clickHandler,this,true);if(saw.userAgent.is_touchdevice){var a=new Function("var f=arguments.callee; return f.func.apply(f.thisContext, arguments);");a.thisContext=this;a.func=this.longTouchHandler;var b=new obips.view.TouchTapAndLongPressHandler(null,null,a);b.addTouchTapAndLongPressSupport(this.contextMenuOptionTextLabel)}};obips.mobile.ListItem.Viewer.prototype.activeHandler=function(a){this.bOpenedTextTooltip=null;if(this.openSubMenuImg){this.openSubMenuImg.className="ui-mobile-menuOption-submenuIcon-active"}};obips.mobile.ListItem.Viewer.prototype.inactiveHandler=function(a){if(this.openSubMenuImg){this.openSubMenuImg.className="ui-mobile-menuOption-submenuIcon"}};obips.mobile.ListItem.Viewer.prototype.clickHandler=function(b){if(this.bOpenedTextTooltip==true){return}var a=this.liModel.oClickHandler;if(a){a.exec(this.liModel.contextMenuOption,b)}};obips.mobile.ListItem.Viewer.prototype.longTouchHandler=function(a){if(a){obips.mobile.ListItem.Viewer.removeTextTooltip(a);this.addTextTooltip()}};obips.mobile.ListItem.Viewer.prototype.addTextTooltip=function(){var d=5;var c=this.contextMenuOptionDiv.offsetWidth-2*d;var k=28;var j=this.contextMenuOptionDiv.offsetTop;var i=3;var b=document.createElement("DIV");b.className="ui-mobile-menuOption-tt-container ui-mobile-corner-all";b.style.width=c+"px";b.style.height=k+"px";b.style.left=(d-1)+"px";var g=(j<5)?(j+this.contextMenuOptionDiv.offsetHeight-i):(j-k+i);b.style.top=g+"px";var a=b.appendChild(document.createElement("DIV"));a.className="ui-mobile-menuOption-tt-background ui-mobile-corner-all";var e=b.appendChild(document.createElement("DIV"));e.className="ui-mobile-menuOption-tt-text ui-mobile-corner-all";var h=this.liModel.contextMenuOption.name;e.appendChild(document.createTextNode(h));b.style.visibility="hidden";this.contextMenuOptionDiv.parentNode.appendChild(b);obips.mobile.ListItem.Viewer.fitFontSize(e,b,18);e.style.left=((b.offsetWidth-e.offsetWidth)/2)+"px";e.style.top=((b.offsetHeight-e.offsetHeight)/2)+"px";b.style.visibility="visible";this.bOpenedTextTooltip=true;var f=saw.userAgent.is_touchdevice?"touchend":"mouseup";saw.addEventListener(window,f,obips.mobile.ListItem.Viewer.removeTextTooltip)};obips.mobile.ListItem.Viewer.removeTextTooltip=function(a){if(document.getElementsByClassName){var c=document.getElementsByClassName("ui-mobile-menuOption-tt-container");if(c&&c.length>0){var b;for(b=0;b<c.length;b++){var d=c[b];d.parentNode.removeChild(d)}}}var e=saw.userAgent.is_touchdevice?"touchend":"mouseup";saw.removeEventListener(window,e,obips.mobile.ListItem.Viewer.removeTextTooltip)};obips.mobile.ListItem.Viewer.fitFontSize=function(h,a,b){var e=(b==undefined)?18:b;var d=Math.min(a.offsetHeight,e);var c=a.offsetWidth;var g;var f;do{h.style.fontSize=(e+"px");h.style.lineHeight=(e+"px");g=h.offsetHeight;f=h.offsetWidth;e-=1}while((g>d||f>c)&&e>3)};obips.mobile.ListItem.Viewer.prototype.getItemDiv=function(){return this.contextMenuOptionDiv}};