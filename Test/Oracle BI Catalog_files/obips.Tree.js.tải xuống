obips.Tree=function(){};obips.Tree.bUseOldCode=true;obips.Tree.complaint_about_the_use_of_document_getElementById=function(){var c=false;if(c){var a="Warning (obips.Tree.js), please do not use document.getElementById";var b=false;if(b){alert(a)}else{window.status=a}}};obips.Tree.Utilities=function(){};obips.Tree.Utilities.resourceFile="uicomponents/obips.Tree/obips.Tree.xml";obips.Tree.Utilities.bResourceFileLoaded=false;obips.Tree.Utilities.getResourceManager=function(){return obips.ResourceManager.getSingleton()};obips.Tree.Utilities.getResourceString=function(a){if(!obips.Tree.Utilities.bResourceFileLoaded){obips.Tree.Utilities.bResourceFileLoaded=true;obips.Tree.Utilities.getResourceManager().load(obips.Tree.Utilities.resourceFile)}return obips.Tree.Utilities.getResourceManager().getResource(obips.Tree.Utilities.resourceFile,a).getString()};obips.Tree.Utilities._getResourceURL=function(a){if(!obips.Tree.Utilities.bResourceFileLoaded){obips.Tree.Utilities.bResourceFileLoaded=true;obips.Tree.Utilities.getResourceManager().load(obips.Tree.Utilities.resourceFile)}return obips.Tree.Utilities.getResourceManager().getURL(obips.Tree.Utilities.resourceFile,a).url};obips.Tree.Utilities.getImagePath=obips.Tree.Utilities._getResourceURL;obips.Tree.Utilities.getHelpURL=obips.Tree.Utilities._getResourceURL;obips.Tree.Model=function(c,g,h,f,i,d,e,b,a){obips.Tree.Model.baseConstructor.call(this);this.rootNode=c;this.originalRootNode=c;this.nodes=new Array();this.nodes[c.id]=c;this.requestChildrenCallback=g;this.supportsNodeStatus=h||false;this.dontIncludeDisclosures=d||false;this.dontIncludeNodeTypeIcon=e||false;this.enablePaging=(f!=null)?f:false;if(this.enablePaging){this.pageSize=i?i:obips.Tree.Model.DEFAULT_PAGE_SIZE}else{this.pageSize=null}};extend(obips.Tree.Model,obips.Observable);obips.Tree.Model.RequestChildrenTask=function(d,c,a,b){this.oModel=d;this.parentNodeID=a;this.eAllViewerScope=(c==obips.Tree.Model.RequestChildrenTask.SPECIFIC_VIEWER_AND_JAWS_REACT?obips.Tree.Model.RequestChildrenTask.SPECIFIC_VIEWER_AND_JAWS_REACT:obips.Tree.Model.RequestChildrenTask.ALL_VIEWERS_REACT_NO_JAWS);if(this.eAllViewerScope==obips.Tree.Model.RequestChildrenTask.ALL_VIEWERS_REACT_NO_JAWS){this.loadingTreeNodeViewer=null;this.originalTreeViewer=null}else{this.loadingTreeNodeViewer=b;this.originalTreeViewer=this.loadingTreeNodeViewer.treeViewer;if(this.loadingTreeNodeViewer.treeNode.type=="Member"&&a!=null&&this.oModel.enablePaging==false){this.oModel.enablePaging=true;this.oModel.pageSize=obips.Tree.Model.DEFAULT_PAGE_SIZE;obips.Tree.Model.RequestChildrenTask.CreatepageDownDiv=function(g){var f=g.loadingTreeNodeViewer.treeViewer.container.id+"$"+g.loadingTreeNodeViewer.treeNode.id;g.loadingTreeNodeViewer.pagingDiv=document.createElement("div");g.loadingTreeNodeViewer.pagingDiv.id=f+"_pagechildren";g.loadingTreeNodeViewer.pagingDiv.style.display="none";g.loadingTreeNodeViewer.pagingDiv.appendChild(g.loadingTreeNodeViewer.childrenDiv);g.loadingTreeNodeViewer.pageDownDiv=document.createElement("div");g.loadingTreeNodeViewer.pageDownDiv.style.marginLeft="35px";g.loadingTreeNodeViewer.pageDownDiv.style.marginBottom="10px";var h=document.createElement("span");h.className="masterTreeLine treeLine";g.loadingTreeNodeViewer.pageDownDiv.appendChild(h);var e=document.createElement("img");e.alt="";e.src=obips.Tree.Utilities.getImagePath("imgTree_NodeTrail");h.appendChild(e);e.style.verticalAlign="middle";g.loadingTreeNodeViewer.pageDownLink=document.createElement("span");h.appendChild(g.loadingTreeNodeViewer.pageDownLink);g.loadingTreeNodeViewer.pageDownLink.className="treeNodeData";g.loadingTreeNodeViewer.pageDownLink.treeNodeViewer=g.loadingTreeNodeViewer;g.loadingTreeNodeViewer.pageDownLink.appendChild(document.createTextNode(obips.Tree.Utilities.getResourceString("kmsgUICTreeMoreLink")));g.loadingTreeNodeViewer.pageDownLink.onclick=g.loadingTreeNodeViewer.treeViewer.controller.clickPageDownHandler;g.loadingTreeNodeViewer.pageDownLink.style.marginLeft="5px";g.loadingTreeNodeViewer.pageDownDiv.style.display="none";g.loadingTreeNodeViewer.pagingDiv.appendChild(g.loadingTreeNodeViewer.pageDownDiv);g.loadingTreeNodeViewer.div.appendChild(g.loadingTreeNodeViewer.pagingDiv)};obips.Tree.Model.RequestChildrenTask.CreatepageDownDiv(this)}}this.pageSize=this.oModel.pageSize;this.enablePaging=this.oModel.enablePaging;if(b){this.startIndex=b.currentChildIndex}};obips.Tree.Model.RequestChildrenTask.SPECIFIC_VIEWER_AND_JAWS_REACT=0;obips.Tree.Model.RequestChildrenTask.ALL_VIEWERS_REACT_NO_JAWS=1;obips.Tree.Model.DEFAULT_PAGE_SIZE=20;obips.Tree.Model.DEFAULT_CHILD_LIMIT=500;obips.Tree.Model.RequestChildrenTask.prototype.issueRequest=function(){return this.oModel.requestChildrenCallback.exec(this)};obips.Tree.Model.RequestChildrenTask.prototype.disablePagingForCurrentTask=function(){this.enablePaging=false};obips.Tree.Model.RequestChildrenTask.prototype.enablePagingForCurrentTask=function(){this.enablePaging=true};obips.Tree.Model.RequestChildrenTask.prototype.issueVirtualRequest=function(a,b){return this.oModel.requestChildrenCallback.exec(this,a,b)};obips.Tree.Model.RequestChildrenTask.prototype.shouldViewerReactToModelEvent=function(a){return((this.eAllViewerScope==obips.Tree.Model.RequestChildrenTask.ALL_VIEWERS_REACT_NO_JAWS||this.originalTreeViewer==a)?true:false)};obips.Tree.Model.RequestChildrenTask.prototype.shouldJAWSReactToModelEvent=function(a){return((this.eAllViewerScope==obips.Tree.Model.RequestChildrenTask.SPECIFIC_VIEWER_AND_JAWS_REACT&&this.originalTreeViewer==a)?true:false)};obips.Tree.Model.prototype.getChildren=function(d,f,h){var e=this.nodes[d].childNodeIDs;var g=h?h:false;if(e==null||g){var c=new obips.Tree.Model.RequestChildrenTask(this,obips.Tree.Model.RequestChildrenTask.SPECIFIC_VIEWER_AND_JAWS_REACT,d,f);var b=c.issueRequest();e=(b)?true:false}else{if(this.nodes[d].childrenRetrieved==false){var a=obips.Array.clone(e);var c=new obips.Tree.Model.RequestChildrenTask(this,obips.Tree.Model.RequestChildrenTask.SPECIFIC_VIEWER_AND_JAWS_REACT,d,f);var b=c.issueRequest();e=a}}return e};obips.Tree.Model.prototype.setChildren=function(a,b){this.setChildrenShortCut(a,b)};obips.Tree.Model.prototype.setChildrenShortCut=function(b,e,c){var d=(c!=null)?c:this.enablePaging;var a=new obips.Tree.Model.RequestChildrenTask(this,obips.Tree.Model.RequestChildrenTask.ALL_VIEWERS_REACT_NO_JAWS,b,null);if(d){a.enablePagingForCurrentTask()}else{a.disablePagingForCurrentTask()}this._setChildrenInternal(a,e)};obips.Tree.Model.prototype._setChildrenInternal=function(b,e,h){var c=b.parentNodeID;var f=this.nodes[c];f.childrenRetrieved=true;if(b.loadingTreeNodeViewer==null){b.activeLoadingTreeNodeViewer=(f.treeNodeViewer?f.treeNodeViewer:null)}if(e.length>0){if(b.enablePaging){}this._addTreeNodesInternal(e,b,h);var d=new obips.Observable.Event(obips.Tree.Model.EventType.CHILD_NODES_SET,f);d.oRequestChildrenTask=b;d.numChildNodesRetrieved=e.length;this.notify(d);var a=new obips.Observable.Event(obips.Tree.Model.EventType.JAWS_TREE_NODE_EXPANDED,f);a.oRequestChildrenTask=b;this.notify(a);if(true==f.isAutoExpanded){var g=new obips.Observable.Event(obips.Tree.Model.EventType.TREE_NODE_EXPANDED,f);g.oRequestChildrenTask=b;this.notify(g)}}else{f.childNodeIDs=e;var i=new obips.Observable.Event(obips.Tree.Model.EventType.PARENT_HAS_NO_CHILDREN,f);i.oRequestChildrenTask=b;if(b.loadingTreeNodeViewer){b.loadingTreeNodeViewer.hidePagingIcons()}this.notify(i)}};obips.Tree.Model.prototype.addTreeNode=function(b){var a=new obips.Tree.Model.RequestChildrenTask(this,obips.Tree.Model.RequestChildrenTask.ALL_VIEWERS_REACT_NO_JAWS,null,null);this._addTreeNodeInternal(b,a)};obips.Tree.Model.prototype._addTreeNodeInternal=function(d,a){if(this.enablePaging==true){if(this.nodes[d.parentID]){if(this.nodes[d.id]){this.removeTreeNode(d)}}}if(this.nodes[d.parentID]&&!this.nodes[d.id]){this.nodes[d.id]=d;this.nodes[d.parentID].addChildNode(d);if(this.nodes[d.parentID].cutInProgress){d.cutInProgress=true}var b=new obips.Observable.Event(obips.Tree.Model.EventType.TREE_NODE_ADDED,d);b.oRequestChildrenTask=a;this.notify(b)}if(d.isHidden){var c=new obips.Observable.Event(obips.Tree.Model.EventType.TREE_NODE_HIDDEN,d);c.oRequestChildrenTask=a;this.notify(c)}};obips.Tree.Model.prototype._addTreeNodesInternal=function(e,a,c){var b=e.length;if(a.enablePaging&&b>a.pageSize){b=b-(b-a.pageSize)}for(var d=0;d<b;d++){if(c&&(e[d].parentID=="")){e[d].parentID=c}this._addTreeNodeInternal(e[d],a)}return};obips.Tree.Model.prototype.addTreeNodes=function(b){var a=new obips.Tree.Model.RequestChildrenTask(this,obips.Tree.Model.RequestChildrenTask.ALL_VIEWERS_REACT_NO_JAWS,null,null);this._addTreeNodesInternal(b,a)};obips.Tree.Model.prototype.removeTreeNode=function(f){var d=false;var a=this.nodes[f.parentID];if(a){a.removeChildNode(f.id);d=true}else{}delete this.nodes[f.id];var b=this.getKnownDescendantIDs(f);for(var c=0;c<b.length;c++){var e=b[c];delete this.nodes[e]}this.notify(new obips.Observable.Event(obips.Tree.Model.EventType.TREE_NODE_REMOVED,f))};obips.Tree.Model.MOVE_NODE_OPERATION=new Object();obips.Tree.Model.MOVE_NODE_OPERATION.BEFORE="BEFORE";obips.Tree.Model.MOVE_NODE_OPERATION.AFTER="AFTER";obips.Tree.Model.MOVE_NODE_OPERATION.CHILD="CHILD";obips.Tree.Model.prototype.moveTreeNode=function(i,g,e,k,a,d){var l=this.nodes[i];var c=this.nodes[g];var f=this.nodes[e];var m=this.nodes[k];if(l&&c&&f&&m&&(g==l.parentID)){c.removeChildNode(i);var h=null;if(a==obips.Tree.Model.MOVE_NODE_OPERATION.BEFORE){var j=obips.Array.indexOf(m.childNodeIDs,e);h=j}else{if(a==obips.Tree.Model.MOVE_NODE_OPERATION.AFTER){var j=obips.Array.indexOf(m.childNodeIDs,e);h=j+1}}m.addChildNode(l,h);var b=new obips.Tree.ModelEventContext.TreeNodeMovedContext(i,g,e,k,a,d);this.notify(new obips.Observable.Event(obips.Tree.Model.EventType.TREE_NODE_MOVED,b))}};obips.Tree.Model.prototype.removeChildNodes=function(a){if(a.childNodeIDs){var c=a.childNodeIDs.slice();for(var b=0;b<c.length;++b){var d=this.nodes[c[b]];if(d){this.removeTreeNode(d)}}}};obips.Tree.Model.prototype.removeSubtreeFromNodesArray=function(b){if(b.childNodeIDs){for(var a=0;a<b.childNodeIDs.length;a++){var c=this.nodes[b.childNodeIDs[a]];if(c){this.removeSubtreeFromNodesArray(c)}}}delete this.nodes[b.id]};obips.Tree.Model.prototype.updateTreeNode=function(c,b){var a=this.nodes[c.parentID];if(a){a.removeChildNode(c.id)}this.removeSubtreeFromNodesArray(c);if(a){a.addChildNode(b)}this.nodes[b.id]=b;if(a&&a.cutInProgress){b.cutInProgress=true}this.notify(new obips.Observable.Event(obips.Tree.Model.EventType.TREE_NODE_UPDATED,new obips.Tree.ModelEventContext.TreeNodeUpdatedContext(b,c)))};obips.Tree.Model.prototype.rerootSubTree=function(b,a){this.moveTreeNode(b.id,b.parentID,a,a,obips.Tree.Model.MOVE_NODE_OPERATION.CHILD,false)};obips.Tree.Model.prototype.updateTreeNodeStatus=function(c,b){if(!this.supportsNodeStatus){return}var a=this.nodes[c];if(a&&a.status!=b){a.status=b;this.notify(new obips.Observable.Event(obips.Tree.Model.EventType.TREE_NODE_STATUS_UPDATED,a))}};obips.Tree.Model.prototype.updateTreeNodeType=function(c,b){var a=this.nodes[c];if(a&&a.type!=b){a.type=b;this.notify(new obips.Observable.Event(obips.Tree.Model.EventType.TREE_NODE_TYPE_UPDATED,a))}};obips.Tree.Model.prototype.updateTreeNodeTooltip=function(b){var a=this.nodes[b];if(a){this.notify(new obips.Observable.Event(obips.Tree.Model.EventType.TREE_NODE_TOOLTIP_UPDATED,a))}};obips.Tree.Model.prototype.showTreeNode=function(a){this.notify(new obips.Observable.Event(obips.Tree.Model.EventType.TREE_NODE_SHOWN,a));a.isHidden=false};obips.Tree.Model.prototype.hideTreeNode=function(a){this.notify(new obips.Observable.Event(obips.Tree.Model.EventType.TREE_NODE_HIDDEN,a));a.isHidden=true};obips.Tree.Model.prototype.disableTreeNode=function(a){this.notify(new obips.Observable.Event(obips.Tree.Model.EventType.TREE_NODE_DISABLED,a));a.isDisabled=true};obips.Tree.Model.prototype.enableTreeNode=function(a){this.notify(new obips.Observable.Event(obips.Tree.Model.EventType.TREE_NODE_ENABLED,a));a.isDisabled=false};obips.Tree.Model.prototype.setTreeNodeCutInProgress=function(b,a){b.cutInProgress=a;if(a){this.notify(new obips.Observable.Event(obips.Tree.Model.EventType.TREE_NODE_CUT_IN_PROGRESS_ON,b))}else{this.notify(new obips.Observable.Event(obips.Tree.Model.EventType.TREE_NODE_CUT_IN_PROGRESS_OFF,b))}};obips.Tree.Model.prototype.isDescendant=function(b,d){var c=b.parentID;var a=false;while(c){if(c==d.id){return true}else{c=this.nodes[c].parentID}}return a};obips.Tree.Model.prototype.getKnownDescendantIDs=function(e){var a=new Array();if(e&&e.childNodeIDs){for(var c=0;c<e.childNodeIDs.length;c++){var d=e.childNodeIDs[c];a.push(d);var b=this.nodes[d];if(b){a=a.concat(this.getKnownDescendantIDs(b))}}}return a};obips.Tree.Model.prototype.getKnownDescendantIDs=function(e){var a=new Array();if(e&&e.childNodeIDs){for(var c=0;c<e.childNodeIDs.length;c++){var d=e.childNodeIDs[c];a.push(d);var b=this.nodes[d];if(b){a=a.concat(this.getKnownDescendantIDs(b))}}}return a};obips.Tree.Model.prototype.setCutInProgressForSubTree=function(e,c){this.setTreeNodeCutInProgress(e,c);if(e.childNodeIDs){for(var b=0;b<e.childNodeIDs.length;b++){var d=e.childNodeIDs[b];var a=this.nodes[d];if(a){this.setCutInProgressForSubTree(a,c)}}}};obips.Tree.Model.EventType=function(){};obips.Tree.Model.EventType.TREE_NODE_ADDED="treeNodeAdded";obips.Tree.Model.EventType.TREE_NODE_REMOVED="treeNodeRemoved";obips.Tree.Model.EventType.TREE_NODE_MOVED="treeNodeMoved";obips.Tree.Model.EventType.TREE_NODE_INSERTED="treeNodeInserted";obips.Tree.Model.EventType.TREE_NODE_UPDATED="treeNodeUpdated";obips.Tree.Model.EventType.TREE_NODE_STATUS_UPDATED="treeNodeStatusUpdated";obips.Tree.Model.EventType.TREE_NODE_TYPE_UPDATED="treeNodeTypeUpdated";obips.Tree.Model.EventType.TREE_NODE_TOOLTIP_UPDATED="treeNodeTooltipUpdated";obips.Tree.Model.EventType.PARENT_HAS_NO_CHILDREN="parentHasNoChildren";obips.Tree.Model.EventType.TREE_NODE_SHOWN="treeNodeShown";obips.Tree.Model.EventType.TREE_NODE_HIDDEN="treeNodeHidden";obips.Tree.Model.EventType.TREE_NODE_EXPANDED="treeNodeExpanded";obips.Tree.Model.EventType.JAWS_TREE_NODE_EXPANDED="treeNodeExpandedForJAWS";obips.Tree.Model.EventType.TREE_NODE_DISABLED="treeNodeDisabled";obips.Tree.Model.EventType.TREE_NODE_ENABLED="treeNodeEnabled";obips.Tree.Model.EventType.TREE_NODE_CUT_IN_PROGRESS_ON="treeNodeCutInProgressOn";obips.Tree.Model.EventType.TREE_NODE_CUT_IN_PROGRESS_OFF="treeNodeCutInProgressOff";obips.Tree.Model.EventType.CHILD_NODES_SET="childNodesSet";obips.Tree.Model.EventType.CHILD_NODES_NEXT_PAGE="childNodesNextPage";obips.Tree.Model.EventType.CHILD_NODES_PREVIOUS_PAGE="childNodesPreviousPage";obips.Tree.ModelEventContext=function(){};obips.Tree.ModelEventContext.TreeNodeInsertedContext=function(a,b){this.newTreeNode=a;this.position=b};obips.Tree.ModelEventContext.TreeNodeUpdatedContext=function(a,b){this.newTreeNode=a;this.oldTreeNode=b};obips.Tree.ModelEventContext.TreeNodeMovedContext=function(c,a,e,d,f,b){this.nodeToBeMovedGuid=c;this.originalParentGuid=a;this.referenceNodeGuid=e;this.newParentGuid=d;this.operation=f;this.bSelectMovedNode=b};obips.Tree.Node=function(f,e,g,a,c,i,h,d,b){this.id=f;this.name=e;this.description=g;this.type=a;this.parentID=c;this.isSystem=i||false;this.childNodeIDs=null;this.childrenRetrieved=false;this.isHidden=(true==d);this.isAutoExpanded=(true==b);this.isDisabled=false;this.cutInProgress=false;this.status=h};obips.Tree.Node.prototype.addChildNode=function(a,b){var c=a.id;if(this.childNodeIDs==null){this.childNodeIDs=new Array()}if((b!=null)&&b>=0&&b<this.childNodeIDs.length){this.childNodeIDs.splice(b,0,c)}else{obips.Array.append(this.childNodeIDs,c,true)}a.parentID=this.id};obips.Tree.Node.prototype.removeChildNode=function(a){if(this.childNodeIDs!=null){obips.Array.remove(this.childNodeIDs,a)}};obips.Tree.Node.prototype.getCaption=function(){return this.name};obips.Tree.Viewer=function(h,f,j,c,b,g,d,m,k,a,e,l){this.container=f;obips.HTMLDOM.removeChildNodes(this.container);this.bAllowTabIntoNodes=false;this.curFocusNode=null;this.loadingImg=document.createElement("img");this.loadingImg.alt="";this.loadingImg.src=obips.Tree.Utilities.getImagePath("imgTree_LoadingIndicatorWhite");this.loadingImg.width=16;this.loadingImg.height=16;this.model=h;this.div=document.createElement("div");this.div.style.visibility="hidden";this.div.viewer=this;this.div.className="treeContainer";this.div.onselectstart=function(){return false};this.div.style.height="100%";this.div.style.overflow="auto";this.container.appendChild(this.div);this.setScrollbarDiv(this.div);this.resourceManager=obips.Tree.Utilities.getResourceManager();this.resourceManager.load(obips.Tree.Utilities.resourceFile,new obips.Callback(this,this.resourcesLoadedHandler));this.nodeViewerTypeInfos=c;this.nodeStatusTypeInfos=a||obips.Tree.getDefaultNodeStatusTypeInfos();this.autoExpandRoot=b;this.hideRootNode=g;this.isReroot=d||false;this.defaultNodeViewerTypeInfo=new obips.Tree.NodeViewerTypeInfo(null,obips.Tree.Utilities.getImagePath("imgTree_LeafNode"),obips.Tree.Utilities.getResourceString("kmsgUICTreeUnknownNodeType"),false);this.disableClicking=e||false;this.disableDoubleClicking=l||false;this.viewModel=new obips.Tree.ViewModel(k);this.controller=m||new obips.Tree.Controller(this);this.controller.setViewer(this);this.isDraggingLocked=false;if(this.isReroot&&this.model.rootNode!=this.model.originalRootNode){this.hierarchicalSelectorImg=document.createElement("img");this.hierarchicalSelectorImg.alt="";this.hierarchicalSelectorImg.src=obips.Tree.Utilities.getImagePath("imgTree_HiearchSelector_enabled");this.hierarchicalSelectorImg.style.display="block";this.hierarchicalSelectorImg.onmouseover=this.mouseOverHierarchicalSelectorHandler;this.hierarchicalSelectorImg.onmouseout=this.mouseOutHierarchicalSelectorHandler;this.hierarchicalSelectorImg.onmousedown=this.mouseDownHierarchicalSelectorHandler;this.hierarchicalSelectorImg.onclick=this.clickHierarchicalSelectorHandler;this.hierarchicalSelectorImg.treeViewer=this;this.div.appendChild(this.hierarchicalSelectorImg)}this.rootChildrenDiv=document.createElement("div");this.rootChildrenDiv.id=this.container.id+"_children";this.div.appendChild(this.rootChildrenDiv);var i=(this.model.rootNode==this.model.originalRootNode&&this.hideRootNode);this.rootTreeNodeViewer=new obips.Tree.NodeViewer(this,this.model.rootNode,i,null,this.rootChildrenDiv);if(this.autoExpandRoot||i){this.controller.getChildrenForTreeNodeViewer(this.rootTreeNodeViewer,false)}};obips.Tree.Viewer.prototype.resourcesLoadedHandler=function(){this.div.style.visibility="visible"};obips.Tree.Viewer.prototype.setDefaultTreeNodeViewerTypeInfo=function(a){this.defaultNodeViewerTypeInfo=a};obips.Tree.Viewer.prototype.setScrollbarDiv=function(a){this.scrollbarDiv=a;if(this.controller){this.controller.oVPATController.setScrollContainer(this.scrollbarDiv)}};obips.Tree.Viewer.prototype.getScrollbarDiv=function(){return this.scrollbarDiv};obips.Tree.Viewer.prototype.mouseOverHierarchicalSelectorHandler=function(a){a=obips.BrowserEventFramework.normalizeEvent(a);a.target.treeViewer.hierarchicalSelectorImg.src=obips.Tree.Utilities.getImagePath("imgTree_HiearchSelector_hover")};obips.Tree.Viewer.prototype.mouseOutHierarchicalSelectorHandler=function(a){a=obips.BrowserEventFramework.normalizeEvent(a);a.target.treeViewer.hierarchicalSelectorImg.src=obips.Tree.Utilities.getImagePath("imgTree_HiearchSelector_enabled")};obips.Tree.Viewer.prototype.mouseDownHierarchicalSelectorHandler=function(a){a=obips.BrowserEventFramework.normalizeEvent(a);a.target.treeViewer.hierarchicalSelectorImg.src=obips.Tree.Utilities.getImagePath("imgTree_HiearchSelector_down")};obips.Tree.Viewer.prototype.clickHierarchicalSelectorHandler=function(a){a=obips.BrowserEventFramework.normalizeEvent(a);a.target.treeViewer.hierarchicalSelectorImg.src=obips.Tree.Utilities.getImagePath("imgTree_HiearchSelector_hover");a.target.treeViewer.controller.rerootTreeToTreeNode(a.target.treeViewer.model.originalRootNode)};obips.Tree.Viewer.prototype.setSelectionType=function(a){this.viewModel.selectionType=a||obips.Tree.ViewModel.SelectionType.SINGLE;if(this.viewModel.selectionType==obips.Tree.ViewModel.SelectionType.NONE){this.clearSelection()}else{if(this.viewModel.selectionType==obips.Tree.ViewModel.SelectionType.SINGLE&&this.viewModel.selectedNodes.length>1){this.selectSingleNode(this.viewModel.selectedNodes[0])}}};obips.Tree.Viewer.prototype._unfocusNode=function(a){if(this.bAllowTabIntoNodes){}else{obips.CSS.removeClassFromElement(a,"treeNodeFocusClass");this.curFocusNode=null}};obips.Tree.Viewer.prototype._focusNode=function(a){if(this.bAllowTabIntoNodes){}else{if(this.curFocusNode){this._unfocusNode(this.curFocusNode)}this.curFocusNode=a;obips.CSS.addClassToElement(this.curFocusNode,"treeNodeFocusClass")}};obips.Tree.Viewer.prototype.setDraggingLocked=function(a){this.isDraggingLocked=a};obips.Tree.ViewerEventType=function(){};obips.Tree.ViewerEventType.NEW_TREE_VIEWER="newTreeViewer";obips.Tree.NodeViewer=function(c,h,i,j,b){this.treeViewer=c;this.treeNode=h;this.bIsExpanded=false;this.currentChildIndex=0;this.treeNodeTypeInfo=(this.treeViewer.nodeViewerTypeInfos[this.treeNode.type])?this.treeViewer.nodeViewerTypeInfos[this.treeNode.type]:this.treeViewer.defaultNodeViewerTypeInfo;var d=this.treeViewer.container.id+"$"+h.id;this.div=document.createElement("div");this.div.id=d;this.div.className="treeNode";if(this.treeNode.isSystem){obips.CSS.addClassToElement(this.div,"systemTreeNode");if(this.treeViewer.viewModel.showingSystemNodes){this.div.style.display="block"}}this.div.treeNodeViewer=this;if(!i){this.treeLine=document.createElement("span");if(this.treeNodeTypeInfo.customCss){this.treeLine.className="masterTreeLine treeLine "+this.treeNodeTypeInfo.customCss}else{this.treeLine.className="masterTreeLine treeLine"}if(c.bAllowTabIntoNodes){this.treeLine.tabIndex=0}this.div.appendChild(this.treeLine);if(!this.treeViewer.model.dontIncludeDisclosures){this.disclosure=document.createElement("img");this.disclosure.id=d+"_disclosure";this.disclosure.src=obips.Tree.Utilities.getImagePath("imgTree_DisclosureCollapsed");this.disclosure.alt="";this.disclosure.className="treeNodeDisclosure";if(this.treeNodeTypeInfo.canHaveChildren){this.disclosure.onclick=obips.Tree.Controller.getChildren}else{this.disclosure.style.visibility="hidden"}this.treeLine.appendChild(this.disclosure)}this.treeNodeDetailsSpan=document.createElement("span");this.treeNodeDetailsSpan.id=d+"_details";this.treeNodeDetailsSpan.treeNode=this.treeNode;this.treeNodeDetailsSpan.className="treeNodeDetails";if(!this.treeViewer.disableClicking){this.treeNodeDetailsSpan.onclick=this.treeViewer.controller.clickTreeNodeHandler}if(!this.treeViewer.disableDoubleClicking){this.treeNodeDetailsSpan.ondblclick=this.treeViewer.controller.dblClickTreeNodeHandler}this.treeNodeDetailsSpan.oncontextmenu=this.treeViewer.controller.contextMenuHandler;this.treeNodeDetailsSpan.title=this.treeNode.description||this.treeNode.name;this.treeLine.appendChild(this.treeNodeDetailsSpan);if(this.treeViewer.model.supportsNodeStatus){this.treeNodeStatusIcon=document.createElement("img");this.treeNodeStatusIcon.alt="";this.treeNodeStatusIcon.className="treeNodeStatusIcon";this.updateStatus();this.treeNodeDetailsSpan.appendChild(this.treeNodeStatusIcon)}if(!this.treeViewer.model.dontIncludeNodeTypeIcon){this.treeNodeIcon=document.createElement("img");this.treeNodeIcon.src=(this.treeNode.cutInProgress&&this.treeNodeTypeInfo.urlIconGrayedOut)?this.treeNodeTypeInfo.urlIconGrayedOut:this.treeNodeTypeInfo.urlIcon;this.treeNodeIcon.alt="";this.treeNodeIcon.className="treeNodeIcon";this.treeNodeDetailsSpan.appendChild(this.treeNodeIcon)}this.treeNodeTextSpan=document.createElement("span");this.treeNodeTextSpan.className="treeNodeText";this.treeNodeDetailsSpan.appendChild(this.treeNodeTextSpan);var e=null;e=document.createTextNode(this.treeNode.name);if(this.treeNodeTypeInfo.isLink){var n=document.createElement("a");n.href="javascript:void(null)";if(c.model.role&&c.model.role!=""){n.title=e.textContent;saw.setAriaProperty(n,"aria-label",e.textContent);saw.setAriaRole(n,c.model.role)}n.appendChild(e);this.treeNodeTextSpan.appendChild(n)}else{this.treeNodeTextSpan.appendChild(e)}if(this.supportsDragDrop()){this.dragObject=this.treeNodeTypeInfo.dragDropObjClass?new this.treeNodeTypeInfo.dragDropObjClass(this):new obips.Tree.NodeDragDropObject(this)}if(this.treeNodeTypeInfo.hasNodeEndRenderer()){this.treeNodeTypeInfo.getNodeEndRendererCallback().exec(this.treeNodeDetailsSpan)}if(this.treeNode.isHidden||(this.treeNode.isSystem&&!this.treeViewer.viewModel.showingSystemNodes)){this.hide()}}this.childrenDiv=document.createElement("div");this.childrenDiv.id=d+"_children";this.nNumChildren=0;if(i){if(saw.isRToL()){this.childrenDiv.style.marginRight="0px"}else{this.childrenDiv.style.marginLeft="0px"}}this.childrenDiv.className="treeChildContainer";if(this.treeViewer.model.enablePaging){this.pagingDiv=document.createElement("div");this.pagingDiv.id=d+"_pagechildren";this.pagingDiv.style.display="none";this.pagingDiv.appendChild(this.childrenDiv);this.pageDownDiv=document.createElement("div");if(i){this.pageDownDiv.style.marginLeft="16px"}else{this.pageDownDiv.style.marginLeft="35px"}this.pageDownDiv.style.marginBottom="10px";var m=document.createElement("span");m.className="masterTreeLine treeLine";this.pageDownDiv.appendChild(m);var f=document.createElement("img");f.alt="";f.src=obips.Tree.Utilities.getImagePath("imgTree_NodeTrail");m.appendChild(f);f.style.verticalAlign="middle";this.pageDownLink=document.createElement("span");m.appendChild(this.pageDownLink);this.pageDownLink.className="treeNodeData";this.pageDownLink.treeNodeViewer=this;this.pageDownLink.appendChild(document.createTextNode(obips.Tree.Utilities.getResourceString("kmsgUICTreeMoreLink")));this.pageDownLink.onclick=this.treeViewer.controller.clickPageDownHandler;this.pageDownLink.style.marginLeft="5px";this.pageDownDiv.style.display="none";this.pagingDiv.appendChild(this.pageDownDiv);this.div.appendChild(this.pagingDiv)}else{this.div.appendChild(this.childrenDiv)}var a=b||null;if(!a){if(obips.Tree.bUseOldCode){obips.Tree.complaint_about_the_use_of_document_getElementById();var g=(this.treeNode.parentID)?this.treeViewer.container.id+"$"+this.treeNode.parentID+"_children":this.treeViewer.container.id+"_children";var k=document.getElementById(g);var l=document.getElementById(this.treeViewer.container.id.concat("_children"));a=(k?k:l)}else{}}if(j){j.div.parentNode.insertBefore(this.div,j.div)}else{a.appendChild(this.div)}if(!i&&this.treeNode.isSystem){this.treeLine.style.opacity=0.7;this.treeLine.style.filter="alpha(opacity=70)";this.treeLine.style.display="inline-block";if(this.treeViewer.viewModel.showingSystemNodes){this.div.style.display="block"}}};obips.Tree.NodeViewer.prototype.getShortScreenReaderText=function(c){var g=obips.Tree.Utilities.getResourceString("kmsgJAWSTreeNode_ScreenReaderParentNodeFormatString");var d=(this.treeNodeTypeInfo&&this.treeNodeTypeInfo.description?this.treeNodeTypeInfo.description:"");var f="";var e="";if(c){var a=this.getParentNodeViewer(true);f=obips.Tree.Utilities.getResourceString(a?"kmsgJAWSTreeNode_IsChildNodeOfStaticText":"kmsgJAWSTreeNode_NoParentNodeStaticText");e=(a?a.getShortScreenReaderText(true):"")}var b=g.replace("@{TreeNodeType}",d).replace("@{Label}",this.treeNode.name).replace("@{IsChildNodeOfStaticText}",f).replace("@{ParentNodeFormatedText}",e);return b};obips.Tree.NodeViewer.prototype.setShowChildrenOnDblClk=function(a){this.bShowChildrenOnDblClk=a};obips.Tree.NodeViewer.prototype.setCurrentChildIndex=function(a){this.currentChildIndex=a};obips.Tree.NodeViewer.prototype.hidePagingIcons=function(){if(this.pageDownDiv){this.pageDownDiv.style.display="none"}};obips.Tree.NodeViewer.prototype.showPagingIcons=function(){if(this.pageDownDiv){this.pageDownDiv.style.display=""}};obips.Tree.NodeViewer.prototype.setNextPageAvailableOnly=function(){if(this.pageUpIcon&&this.pageDownLink){this.pageUpIcon.src=obips.Tree.Utilities.getImagePath("imgTree_ScrollUpDisabled");this.pageDownLink.src=obips.Tree.Utilities.getImagePath("imgTree_ScrollDownEnabled");this.pageDownLink.onclick=this.treeViewer.controller.clickPageDownHandler;this.pageUpIcon.onclick=null}};obips.Tree.NodeViewer.prototype.setPreviousPageAvailableOnly=function(){if(this.pageUpIcon&&this.pageDownLink){this.pageUpIcon.src=obips.Tree.Utilities.getImagePath("imgTree_ScrollUpEnabled");this.pageDownLink.src=obips.Tree.Utilities.getImagePath("imgTree_ScrollDownDisabled");this.pageDownLink.onclick=null;this.pageUpIcon.onclick=this.treeViewer.controller.clickPageUpHandler}};obips.Tree.NodeViewer.prototype.setAllPagingEnabled=function(){if(this.pageUpIcon&&this.pageDownLink){this.pageUpIcon.src=obips.Tree.Utilities.getImagePath("imgTree_ScrollUpEnabled");this.pageDownLink.src=obips.Tree.Utilities.getImagePath("imgTree_ScrollDownEnabled");this.pageDownLink.onclick=this.treeViewer.controller.clickPageDownHandler;this.pageUpIcon.onclick=this.treeViewer.controller.clickPageUpHandler}};obips.Tree.NodeViewer.prototype.getScreenReaderText=function(){var a=obips.Tree.Utilities.getResourceString("kmsgJAWSTreeNode_ScreenReaderFormatString");var c=obips.Tree.Utilities.getResourceString(this.treeNodeTypeInfo.canHaveChildren?(this.isDisclosureExpanded()?"kmsgJAWSTreeNode_AlreadyExpanded":"kmsgJAWSTreeNode_Expandable"):"kmsgJAWSTreeNode_NotExpandable");var f=(this.treeViewer.viewModel.selectionType==obips.Tree.ViewModel.SelectionType.NONE)?"":obips.Tree.Utilities.getResourceString(this.isSelected()?"kmsgJAWSTreeNode_Selected":"kmsgJAWSTreeNode_NotSelected");var i=(this.treeNodeTypeInfo&&this.treeNodeTypeInfo.description?this.treeNodeTypeInfo.description:"");var h=(this.tNodeStatusTypeInfo&&this.tNodeStatusTypeInfo.tooltip?this.tNodeStatusTypeInfo.tooltip:"");var d=this.getParentNodeViewer(true);var e=obips.Tree.Utilities.getResourceString(d?"kmsgJAWSTreeNode_IsChildNodeOfStaticText":"kmsgJAWSTreeNode_NoParentNodeStaticText");var g=(d?d.getShortScreenReaderText(true):"");var b=a.replace("@{TreeNodeType}",i).replace("@{Label}",this.treeNode.name).replace("@{IsSelected}",f).replace("@{StatusText}",h).replace("@{IsExpandable}",c).replace("@{description}",this.treeNode.description).replace("@{IsChildNodeOfStaticText}",e).replace("@{ParentNodeFormatedText}",g);return b};obips.Tree.NodeViewer.prototype.isRootTreeNodeViewer=function(){return(this==this.treeViewer.rootTreeNodeViewer?true:false)};obips.Tree.NodeViewer.prototype.getParentNodeViewer=function(a){if(!this.isRootTreeNodeViewer()&&this.div.parentNode&&this.div.parentNode.parentNode){var c=null;if(this.div.parentNode.parentNode.treeNodeViewer){c=this.div.parentNode.parentNode.treeNodeViewer}else{if(this.div.parentNode.parentNode.parentNode&&this.div.parentNode.parentNode.parentNode.treeNodeViewer){c=this.div.parentNode.parentNode.parentNode.treeNodeViewer}}if(c){var b=(this.treeViewer.model.rootNode==this.treeViewer.model.originalRootNode&&this.treeViewer.hideRootNode);if(!c.isRootTreeNodeViewer()||!a||!b){return c}}}return null};obips.Tree.NodeViewer.prototype.appendChild=function(b,c){this.expandDisclosure(c);if(this.disclosure){this.disclosure.style.visibility="visible"}var a=new obips.Tree.NodeViewer(this.treeViewer,b,false,null,this.childrenDiv);return a};obips.Tree.NodeViewer.prototype.insertChild=function(c,b){this.expandDisclosure(false);var a=new obips.Tree.NodeViewer(this.treeViewer,c,null,b);return a};obips.Tree.NodeViewer.prototype.replaceChild=function(a){var b=new obips.Tree.NodeViewer(this.treeViewer,a,false,this,this.childrenDiv);this.div.parentNode.removeChild(this.div);return b};obips.Tree.NodeViewer.prototype.isDisclosureExpanded=function(){return this.bIsExpanded};obips.Tree.NodeViewer.prototype.expandDisclosure=function(b){var a=this.isDisclosureExpanded();this.treeViewer.viewModel.expandedNodes[this.treeNode.id]=true;if(this.pagingDiv){this.pagingDiv.style.display="block"}this.childrenDiv.style.display="block";if(this.disclosure){this.disclosure.src=obips.Tree.Utilities.getImagePath("imgTree_DisclosureExpanded");this.disclosure.alt="";this.disclosure.className="treeNodeDisclosure";if(this.treeNodeTypeInfo.toogleUrlIcon&&this.treeNodeIcon){this.treeNodeIcon.src=this.treeNodeTypeInfo.toogleUrlIcon;this.treeNodeIcon.alt=""}if(!a&&b){this.treeViewer.controller.oVPATController.announceSubTreeExpanded(this,3)}this.bIsExpanded=true}};obips.Tree.NodeViewer.prototype.collapseDisclosure=function(){var b=this.isDisclosureExpanded();delete this.treeViewer.viewModel.expandedNodes[this.treeNode.id];if(this.pagingDiv){this.pagingDiv.style.display="none"}this.childrenDiv.style.display="none";if(this.disclosure){this.disclosure.src=obips.Tree.Utilities.getImagePath("imgTree_DisclosureCollapsed");this.disclosure.alt="";if(this.treeNodeIcon){this.treeNodeIcon.src=(this.treeNode.cutInProgress&&this.treeNodeTypeInfo.urlIconGrayedOut)?this.treeNodeTypeInfo.urlIconGrayedOut:this.treeNodeTypeInfo.urlIcon;this.treeNodeIcon.alt=""}}if(b){var a=obips.Tree.Utilities.getResourceString("kmsgJAWSTree_SubTreeIsCollapsed");this.treeViewer.controller.oVPATController.setContainerCursor(a,false,null)}this.bIsExpanded=false};obips.Tree.NodeViewer.prototype.hover=function(){obips.CSS.addClassToElement(this.treeNodeTextSpan,"treeLineHover")};obips.Tree.NodeViewer.prototype.noHover=function(){obips.CSS.removeClassFromElement(this.treeNodeTextSpan,"treeLineHover")};obips.Tree.NodeViewer.prototype.isSelected=function(){return obips.CSS.isElementClassOf(this.treeNodeTextSpan,"treeLineSelected")};obips.Tree.NodeViewer.prototype.select=function(){obips.CSS.addClassToElement(this.treeNodeTextSpan,"masterTreeLineSelected");obips.CSS.addClassToElement(this.treeNodeTextSpan,"treeLineSelected")};obips.Tree.NodeViewer.prototype.deselect=function(){obips.CSS.removeClassFromElement(this.treeNodeTextSpan,"masterTreeLineSelected");obips.CSS.removeClassFromElement(this.treeNodeTextSpan,"treeLineSelected")};obips.Tree.NodeViewer.prototype.isActive=function(){return obips.CSS.isElementClassOf(this.treeNodeTextSpan,"treeLineActive")};obips.Tree.NodeViewer.prototype.activate=function(){obips.CSS.addClassToElement(this.treeNodeTextSpan,"masterTreeLineActive");obips.CSS.addClassToElement(this.treeNodeTextSpan,"treeLineActive")};obips.Tree.NodeViewer.prototype.deactivate=function(){obips.CSS.removeClassFromElement(this.treeNodeTextSpan,"masterTreeLineActive");obips.CSS.removeClassFromElement(this.treeNodeTextSpan,"treeLineActive")};obips.Tree.NodeViewer.prototype.enable=function(){obips.CSS.removeClassFromElement(this.treeNodeTextSpan,"treeLineDisabled")};obips.Tree.NodeViewer.prototype.disable=function(){obips.CSS.addClassToElement(this.treeNodeTextSpan,"treeLineDisabled")};obips.Tree.NodeViewer.prototype.turnOffCutMode=function(){this.updateType();obips.CSS.removeClassFromElement(this.treeNodeTextSpan,"treeLineDisabled")};obips.Tree.NodeViewer.prototype.turnOnCutMode=function(){this.updateType();obips.CSS.addClassToElement(this.treeNodeTextSpan,"treeLineDisabled")};obips.Tree.NodeViewer.prototype.updateStatus=function(){if(!this.treeViewer.model.supportsNodeStatus){return}this.tNodeStatusTypeInfo=(this.treeNode.status!=null&&this.treeViewer.nodeStatusTypeInfos[this.treeNode.status])?this.treeViewer.nodeStatusTypeInfos[this.treeNode.status]:obips.Tree.getUnKnownNodeStatusTypeInfo();this.treeNodeStatusIcon.src=this.tNodeStatusTypeInfo.iconURL;this.treeNodeStatusIcon.alt="";this.treeNodeStatusIcon.className="treeNodeStatusIcon";this.treeNodeStatusIcon.removeAttribute("width");this.treeNodeStatusIcon.removeAttribute("height");if(this.tNodeStatusTypeInfo.tooltip!=null){this.treeNodeStatusIcon.title=this.tNodeStatusTypeInfo.tooltip}};obips.Tree.NodeViewer.prototype.updateType=function(){this.treeNodeTypeInfo=(this.treeViewer.nodeViewerTypeInfos[this.treeNode.type])?this.treeViewer.nodeViewerTypeInfos[this.treeNode.type]:this.treeViewer.defaultNodeViewerTypeInfo;if(this.treeNodeIcon){this.treeNodeIcon.src=(this.treeNode.cutInProgress&&this.treeNodeTypeInfo.urlIconGrayedOut)?this.treeNodeTypeInfo.urlIconGrayedOut:this.treeNodeTypeInfo.urlIcon;this.treeNodeIcon.alt=""}};obips.Tree.NodeViewer.prototype.updateTooltip=function(a){if(this.treeNodeDetailsSpan){this.treeNodeDetailsSpan.title=a}};obips.Tree.NodeViewer.prototype.show=function(){if(this.div){this.div.style.display="block"}if(this.treeLine){this.treeLine.style.display="block"}};obips.Tree.NodeViewer.prototype.hide=function(){if(this.div){this.div.style.display="none"}if(this.treeLine){this.treeLine.style.display="none";if(this.childrenDiv&&this.childrenDiv.style.display=="block"){this.collapseDisclosure()}}};obips.Tree.NodeViewer.getTreeNodeViewerDivFromEvent=function(a){a=obips.BrowserEventFramework.normalizeEvent(a);var b=a.target;while(b.tagName!="DIV"&&b.className!="treeNode"){b=b.parentNode}return b};obips.Tree.NodeViewer.prototype.supportsDragDrop=function(){return this.isDraggable()||this.isDropTarget()};obips.Tree.NodeViewer.prototype.isDraggable=function(){return this.treeNodeTypeInfo.isDraggable()};obips.Tree.NodeViewer.prototype.isDropTarget=function(){return this.treeNodeTypeInfo.isDropTarget()};if(typeof(saw)!="undefined"&&saw.dnd){obips.Tree.ksDefaultDnDGroup="DefaultTreeDnDGroup";obips.Tree.NodeDragDropObject=function(b){var c=b.treeNodeTypeInfo.getDnDGroups();if(c&&c.length>0){obips.Tree.NodeDragDropObject.baseConstructor.call(this,b.treeNodeDetailsSpan,c[0]);for(var a=1;a<c.length;a++){this.addToGroup(c[a])}}else{obips.Tree.NodeDragDropObject.baseConstructor.call(this,b.treeNodeDetailsSpan,obips.Tree.ksDefaultDnDGroup)}this.draggingCursor="default";this.setIsDraggable(b.isDraggable());this.setIsTarget(b.isDropTarget());this.bCanDragAcrossIframe=true;this.borderWidth=0;this.nodeViewer=b;this.draggedNodes=null;this.scrollableElements=b.treeNodeTypeInfo.getScrollableElements()};extend(obips.Tree.NodeDragDropObject,saw.dnd.SimpleDragObj);obips.Tree.NodeDragDropObject.prototype.setDragObjContents=function(b){var c=this.getDragObj();c.style.border="none";c.style.whiteSpace="nowrap";c.style.height="auto";if(this.nodeViewer.treeViewer.viewModel.selectedNodes.length>1&&this.nodeViewer.treeViewer.viewModel.isNodeSelected(this.nodeViewer)){var a=document.createElement("img");a.alt="";a.src=obips.Tree.Utilities.getImagePath("imgTree_MultiNodeDrag");saw.clearInnerHTML(c);c.appendChild(a);c.style.width="20px"}else{obips.Tree.NodeDragDropObject.superClass.setDragObjContents.call(this,b)}};obips.Tree.NodeDragDropObject.prototype.autoOffset=function(b,a){if(this.nodeViewer.treeViewer.viewModel.selectedNodes.length>1&&this.nodeViewer.treeViewer.viewModel.isNodeSelected(this.nodeViewer)){this.setDelta(10,8)}else{obips.Tree.NodeDragDropObject.superClass.autoOffset.call(this,b,a)}};obips.Tree.NodeDragDropObject.prototype.willAcceptDropSource=function(a){return this.nodeViewer.treeViewer.controller.canAcceptDrop(a,this.nodeViewer)};obips.Tree.NodeDragDropObject.prototype.startDrag=function(b,a,f){var d,e,c;if(this.nodeViewer.treeViewer.isDraggingLocked){return}obips.Tree.NodeDragDropObject.superClass.startDrag.call(this,b,a,f);c=this.nodeViewer.treeViewer.viewModel;e=c.numSelectedNodes();if(c.isNodeSelected(this.nodeViewer)&&e>1){this.draggedNodes=[];for(d=0;d<e;d++){if(c.selectedNodes[d].isDraggable()){this.draggedNodes.push(c.selectedNodes[d])}}}else{this.draggedNodes=[this.nodeViewer]}};obips.Tree.NodeDragDropObject.prototype.onDrag=function(a){obips.Tree.NodeDragDropObject.superClass.onDrag.call(this,a);this.nodeViewer.treeViewer.controller.dragTreeNodeHandler(a,this)};obips.Tree.NodeDragDropObject.prototype.onDragEnter=function(a,b){if(this.willAcceptDropSource(b)){this.nodeViewer.treeViewer.controller.dragEnterHandler(a,b,this.nodeViewer)}};obips.Tree.NodeDragDropObject.prototype.onDragOver=function(a,b){if(this.willAcceptDropSource(b)){this.nodeViewer.treeViewer.controller.dragOverHandler(a,b,this.nodeViewer)}};obips.Tree.NodeDragDropObject.prototype.onDragExit=function(a,b){if(this.willAcceptDropSource(b)){this.nodeViewer.treeViewer.controller.dragLeaveHandler(a,b,this.nodeViewer)}};obips.Tree.NodeDragDropObject.prototype.onDragDrop=function(a,b){if(this.willAcceptDropSource(b)){this.nodeViewer.treeViewer.controller.dropHandler(a,b,this.nodeViewer)}}}obips.Tree.ViewModel=function(a){obips.Tree.ViewModel.baseConstructor.call(this);this.selectionType=a||obips.Tree.ViewModel.SelectionType.SINGLE;this.selectedNodes=new Array();this.activeNode=null;this.showingSystemNodes=false;this.expandedNodes=new Array()};extend(obips.Tree.ViewModel,obips.Observable);obips.Tree.ViewModel.prototype.isNodeSelected=function(a){var b=obips.Array.indexOf(this.selectedNodes,a);return b>-1};obips.Tree.ViewModel.prototype.numSelectedNodes=function(){var a=0;if(this.selectedNodes!=null){a=this.selectedNodes.length}return a};obips.Tree.ViewModel.prototype.selectNode=function(b,c){if(b.treeNode.isDisabled==true){return}if(!this.isNodeSelected()){this.selectedNodes.push(b);this.notify(new obips.Observable.Event(obips.Tree.ViewModel.EventType.TREE_NODE_VIEWER_SELECTED,b));this.lastSelectedNodeViewer=b;if(!c){var a=new obips.Tree.ViewModelEventContext.SelectionChangeEventContext(this.selectedNodes,null,[b]);this.notify(new obips.Observable.Event(obips.Tree.ViewModel.EventType.TREE_NODE_VIEWER_SELECTION_CHANGED,a))}}};obips.Tree.ViewModel.prototype.activateNode=function(a){if(a.treeNode.isDisabled==true){return}if(a!=this.activeNode){this.deactivateNode();this.activeNode=a;this.notify(new obips.Observable.Event(obips.Tree.ViewModel.EventType.TREE_NODE_VIEWER_ACTIVATED,this.activeNode))}else{this.notify(new obips.Observable.Event(obips.Tree.ViewModel.EventType.TREE_NODE_VIEWER_REACTIVATED,this.activeNode))}};obips.Tree.ViewModel.prototype.getActiveNode=function(){return this.activeNode};obips.Tree.ViewModel.prototype.deactivateNode=function(){var a=this.getActiveNode();if(a){this.notify(new obips.Observable.Event(obips.Tree.ViewModel.EventType.TREE_NODE_VIEWER_DEACTIVATED,a));this.activeNode=null}};obips.Tree.ViewModel.prototype.deselectNode=function(b,c){var d=obips.Array.indexOf(this.selectedNodes,b);if(d>-1){this.selectedNodes.splice(d,1);this.notify(new obips.Observable.Event(obips.Tree.ViewModel.EventType.TREE_NODE_VIEWER_DESELECTED,b));if(this.selectedNodes.length>0){this.lastSelectedNodeViewer=this.selectedNodes[this.selectedNodes.length-1]}else{this.lastSelectedNodeViewer=null}if(!c){var a=new obips.Tree.ViewModelEventContext.SelectionChangeEventContext(this.selectedNodes,[b],null);this.notify(new obips.Observable.Event(obips.Tree.ViewModel.EventType.TREE_NODE_VIEWER_SELECTION_CHANGED,a))}}};obips.Tree.ViewModel.prototype.clearSelection=function(d){var c=this.selectedNodes.slice();for(var b=this.selectedNodes.length-1;b>=0;b--){this.deselectNode(this.selectedNodes[b],true)}if(!d&&c.length>0){var a=new obips.Tree.ViewModelEventContext.SelectionChangeEventContext(this.selectedNodes,c,null);this.notify(new obips.Observable.Event(obips.Tree.ViewModel.EventType.TREE_NODE_VIEWER_SELECTION_CHANGED,a))}};obips.Tree.ViewModel.prototype.selectSingleNode=function(c){if(this.selectionType==obips.Tree.ViewModel.SelectionType.NONE){return}if(c.treeNode.isDisabled==true){return}var b=[];for(var e=this.selectedNodes.length-1;e>=0;e--){if(this.selectedNodes[e]!=c){b.push(this.selectedNodes[e]);this.deselectNode(this.selectedNodes[e],true)}}var d=[];if(this.selectedNodes.length==0){this.selectNode(c,true);d.push(c)}if(b.length>0||d.length>0){var a=new obips.Tree.ViewModelEventContext.SelectionChangeEventContext(this.selectedNodes,b,d);this.notify(new obips.Observable.Event(obips.Tree.ViewModel.EventType.TREE_NODE_VIEWER_SELECTION_CHANGED,a))}};obips.Tree.ViewModel.prototype.setNodeSelection=function(b){var c=new Array;for(var e=this.selectedNodes.length-1;e>=0;e--){if(obips.Array.indexOf(b,this.selectedNodes[e])==-1){c.push(this.selectedNodes[e]);this.deselectNode(this.selectedNodes[e],true)}}var d=new Array;for(e=0;e<b.length;e++){if(!this.isNodeSelected(b[e])){if(b[e].treeNode.isDisabled==true){continue}d.push(b[e]);this.selectNode(b[e],true)}}if(c.length>0||d.length>0){var a=new obips.Tree.ViewModelEventContext.SelectionChangeEventContext(this.selectedNodes,c,d);this.notify(new obips.Observable.Event(obips.Tree.ViewModel.EventType.TREE_NODE_VIEWER_SELECTION_CHANGED,a))}};obips.Tree.ViewModel.prototype.deselectSingleNode=function(a){this.deselectNode(a)};obips.Tree.ViewModel.prototype.deselectRemovedNodes=function(b){var c=0;var a=new Array;for(c=0;c<this.selectedNodes.length;++c){if(!b.nodes[this.selectedNodes[c].treeNode.id]){a.push(this.selectedNodes[c])}}this.deselectNodes(b,a)};obips.Tree.ViewModel.prototype.deselectSubtree=function(c){var b=c.treeViewer.model;var d=0;var a=new Array;for(d=0;d<this.selectedNodes.length;++d){if(this.selectedNodes[d]==c||b.isDescendant(this.selectedNodes[d].treeNode,c.treeNode)){a.push(this.selectedNodes[d])}}this.deselectNodes(b,a)};obips.Tree.ViewModel.prototype.deselectNodes=function(d,c){if(c.length>0){var e=0;for(e=0;e<c.length;++e){var f=c[e];var b=obips.Array.indexOf(this.selectedNodes,c[e]);this.selectedNodes.splice(b,1);this.notify(new obips.Observable.Event(obips.Tree.ViewModel.EventType.TREE_NODE_VIEWER_DESELECTED,f))}var a=new obips.Tree.ViewModelEventContext.SelectionChangeEventContext(this.selectedNodes,c,null);this.notify(new obips.Observable.Event(obips.Tree.ViewModel.EventType.TREE_NODE_VIEWER_SELECTION_CHANGED,a))}};obips.Tree.ViewModel.prototype.showSystemNodes=function(){this.showingSystemNodes=true;this.notify(new obips.Observable.Event(obips.Tree.ViewModel.EventType.SHOW_SYSTEM_NODES,null))};obips.Tree.ViewModel.prototype.hideSystemNodes=function(){this.showingSystemNodes=false;this.notify(new obips.Observable.Event(obips.Tree.ViewModel.EventType.HIDE_SYSTEM_NODES,null))};obips.Tree.ViewModel.SelectionType=function(){};obips.Tree.ViewModel.SelectionType.NONE="selectionDisabled";obips.Tree.ViewModel.SelectionType.SINGLE="singleSelection";obips.Tree.ViewModel.SelectionType.MULTIPLE="multiSelection";obips.Tree.ViewModel.EventType=function(){};obips.Tree.ViewModel.EventType.TREE_NODE_VIEWER_CLICKED="treeNodeViewerClicked";obips.Tree.ViewModel.EventType.TREE_NODE_VIEWER_DOUBLE_CLICKED="treeNodeViewerDoubleClicked";obips.Tree.ViewModel.EventType.TREE_NODE_VIEWER_DESELECTED="treeNodeDeselected";obips.Tree.ViewModel.EventType.TREE_NODE_VIEWER_SELECTED="treeNodeSelected";obips.Tree.ViewModel.EventType.TREE_NODE_VIEWER_DEACTIVATED="treeNodeDeactivated";obips.Tree.ViewModel.EventType.TREE_NODE_VIEWER_ACTIVATED="treeNodeViewerActivated";obips.Tree.ViewModel.EventType.TREE_NODE_VIEWER_REACTIVATED="treeNodeViewerReactivated";obips.Tree.ViewModel.EventType.TREE_NODE_VIEWER_SELECTION_CHANGED="treeNodeSelectionChanged";obips.Tree.ViewModel.EventType.TREE_NODE_VIEWER_CONTEXT_MENU="treeNodeRightClicked";obips.Tree.ViewModel.EventType.SHOW_SYSTEM_NODES="showSystemNodes";obips.Tree.ViewModel.EventType.HIDE_SYSTEM_NODES="hideSystemNodes";obips.Tree.ViewModel.EventType.OBJECT_DROPPED_ON_TREE_NODE="objectDroppedOnTreeNode";obips.Tree.ViewModel.EventType.DRAG_ENTER_TREE_NODE="dragEnterTreeNode";obips.Tree.ViewModel.EventType.DRAG_OVER_TREE_NODE="dragOverTreeNode";obips.Tree.ViewModel.EventType.DRAG_LEAVE_TREE_NODE="dragLeaveTreeNode";obips.Tree.ViewModel.EventType.DRAG_TREE_NODE="dragTreeNode";obips.Tree.ViewModelEventContext=function(){};obips.Tree.ViewModelEventContext.CommonEventContext=function(b,a){this.treeNodeViewer=b;this.evt=a};obips.Tree.ViewModelEventContext.SelectionChangeEventContext=function(c,a,b){this.selected=c;this.removed=a;this.added=b};obips.Tree.ViewModelEventContext.DragDropEventContext=function(b,c,a){this.dragSourceObj=b;this.targetTreeNodeViewer=c;this.evt=a};obips.Tree.ViewModelEventContext.ContextMenuEventContext=function(b,a){this.treeNodeViewer=b;this.evt=a};obips.Tree.NodeViewerTypeInfo=function(a,b,g,i,c,h,f,e,d){this.type=a;this.urlIcon=b;this.urlIconGrayedOut=d;this.description=g||"";this.canHaveChildren=i||false;this._isDraggable=c||false;this._isDropTarget=h||false;this._dndGroups=f||null;this._fNodeEndRenderer=null;if(typeof(e)!="undefined"){this._bExpandChildrenOnDblclk=e}else{this._bExpandChildrenOnDblclk=true}this.isLink=false;this._scrollableElements=null};obips.Tree.NodeViewerTypeInfo.prototype.setScrollableElements=function(a){this._scrollableElements=a};obips.Tree.NodeViewerTypeInfo.prototype.getScrollableElements=function(a){return this._scrollableElements};obips.Tree.NodeViewerTypeInfo.prototype.setIsLink=function(a){this.isLink=a};obips.Tree.NodeViewerTypeInfo.prototype.setCustomCss=function(a){this.customCss=a};obips.Tree.NodeViewerTypeInfo.prototype.setNodeEndRendererCallback=function(a){if(a&&a.exec){this._fNodeEndRenderer=a}};obips.Tree.NodeViewerTypeInfo.prototype.hasNodeEndRenderer=function(){return this._fNodeEndRenderer&&this._fNodeEndRenderer.exec};obips.Tree.NodeViewerTypeInfo.prototype.getNodeEndRendererCallback=function(){return this._fNodeEndRenderer};obips.Tree.NodeViewerTypeInfo.prototype.isDraggable=function(){return this._isDraggable};obips.Tree.NodeViewerTypeInfo.prototype.setIsDraggable=function(a){this._isDraggable=a?true:false};obips.Tree.NodeViewerTypeInfo.prototype.isDropTarget=function(){return this._isDropTarget};obips.Tree.NodeViewerTypeInfo.prototype.setIsDropTarget=function(a){this._isDropTarget=a?true:false};obips.Tree.NodeViewerTypeInfo.prototype.getDnDGroups=function(){return this._dndGroups};obips.Tree.NodeViewerTypeInfo.prototype.setDnDGroups=function(a){this._dndGroups=a||null};obips.Tree.NodeStatusTypeInfo=function(c,b,a){this.id=c;this.iconURL=b;this.tooltip=a};obips.Tree.UnknownNodeStatusTypeInfo=null;obips.Tree.getUnKnownNodeStatusTypeInfo=function(){if(!obips.Tree.UnknownNodeStatusTypeInfo){obips.Tree.UnknownNodeStatusTypeInfo=new obips.Tree.NodeStatusTypeInfo("",obips.Tree.Utilities.getImagePath("imgTree_NoStatus"),null)}return obips.Tree.UnknownNodeStatusTypeInfo};obips.Tree.DefaultNodeStatusTypeInfos=function(){};obips.Tree.DefaultNodeStatusTypeInfos.OK=null;obips.Tree.DefaultNodeStatusTypeInfos.Warning=null;obips.Tree.DefaultNodeStatusTypeInfos.Error=null;obips.Tree.getDefaultNodeStatusTypeInfos=function(){obips.Tree.DefaultNodeStatusTypeInfos.getOKInfo();obips.Tree.DefaultNodeStatusTypeInfos.getWarningInfo();obips.Tree.DefaultNodeStatusTypeInfos.getErrorInfo();return obips.Tree.DefaultNodeStatusTypeInfos};obips.Tree.DefaultNodeStatusTypeInfos.getOKInfo=function(){if(!obips.Tree.DefaultNodeStatusTypeInfos.OK){obips.Tree.DefaultNodeStatusTypeInfos.OK=new obips.Tree.NodeStatusTypeInfo("OK",obips.Tree.Utilities.getImagePath("imgTree_OK"),obips.Tree.Utilities.getResourceString("kmsgUICTreeOKTooltips"))}return obips.Tree.DefaultNodeStatusTypeInfos.OK};obips.Tree.DefaultNodeStatusTypeInfos.getWarningInfo=function(){if(!obips.Tree.DefaultNodeStatusTypeInfos.Warning){obips.Tree.DefaultNodeStatusTypeInfos.Warning=new obips.Tree.NodeStatusTypeInfo("Warning",obips.Tree.Utilities.getImagePath("imgTree_Warning"),obips.Tree.Utilities.getResourceString("kmsgUICTreeWarningTooltips"))}return obips.Tree.DefaultNodeStatusTypeInfos.Warning};obips.Tree.DefaultNodeStatusTypeInfos.getErrorInfo=function(){if(!obips.Tree.DefaultNodeStatusTypeInfos.Error){obips.Tree.DefaultNodeStatusTypeInfos.Error=new obips.Tree.NodeStatusTypeInfo("Error",obips.Tree.Utilities.getImagePath("imgTree_Error"),obips.Tree.Utilities.getResourceString("kmsgUICTreeErrorTooltips"))}return obips.Tree.DefaultNodeStatusTypeInfos.Error};obips.Tree.Controller=function(){this.treeViewer=null};obips.Tree.Controller.prototype.attachVPATController=function(){this.oVPATController=new obips.Tree.Controller.VPATController(this.treeViewer.div,this)};obips.Tree.Controller.prototype.setViewer=function(a){this.treeViewer=a;if(this.treeViewer.isReroot!=true){this.treeViewer.model.addEventListener(new obips.Observable.EventListener(obips.Tree.Model.EventType.TREE_NODE_ADDED,new obips.Callback(this,this.treeNodeAddedHandler)));this.treeViewer.model.addEventListener(new obips.Observable.EventListener(obips.Tree.Model.EventType.TREE_NODE_REMOVED,new obips.Callback(this,this.treeNodeRemovedHandler)));this.treeViewer.model.addEventListener(new obips.Observable.EventListener(obips.Tree.Model.EventType.TREE_NODE_MOVED,new obips.Callback(this,this.treeNodeMovedHandler)));this.treeViewer.model.addEventListener(new obips.Observable.EventListener(obips.Tree.Model.EventType.TREE_NODE_UPDATED,new obips.Callback(this,this.treeNodeUpdatedHandler)));this.treeViewer.model.addEventListener(new obips.Observable.EventListener(obips.Tree.Model.EventType.PARENT_HAS_NO_CHILDREN,new obips.Callback(this,this.parentHasNoChildrenHandler)));this.treeViewer.model.addEventListener(new obips.Observable.EventListener(obips.Tree.Model.EventType.TREE_NODE_SHOWN,new obips.Callback(this,this.treeNodeShownHandler)));this.treeViewer.model.addEventListener(new obips.Observable.EventListener(obips.Tree.Model.EventType.TREE_NODE_HIDDEN,new obips.Callback(this,this.treeNodeHiddenHandler)));this.treeViewer.model.addEventListener(new obips.Observable.EventListener(obips.Tree.Model.EventType.TREE_NODE_EXPANDED,new obips.Callback(this,this.treeNodeExpandedHandler)));this.treeViewer.model.addEventListener(new obips.Observable.EventListener(obips.Tree.Model.EventType.TREE_NODE_DISABLED,new obips.Callback(this,this.treeNodeDisabledHandler)));this.treeViewer.model.addEventListener(new obips.Observable.EventListener(obips.Tree.Model.EventType.TREE_NODE_ENABLED,new obips.Callback(this,this.treeNodeEnabledHandler)));this.treeViewer.model.addEventListener(new obips.Observable.EventListener(obips.Tree.Model.EventType.TREE_NODE_CUT_IN_PROGRESS_ON,new obips.Callback(this,this.treeNodeCutModeOnHandler)));this.treeViewer.model.addEventListener(new obips.Observable.EventListener(obips.Tree.Model.EventType.TREE_NODE_CUT_IN_PROGRESS_OFF,new obips.Callback(this,this.treeNodeCutModeOffHandler)));this.treeViewer.model.addEventListener(new obips.Observable.EventListener(obips.Tree.Model.EventType.CHILD_NODES_NEXT_PAGE,new obips.Callback(this,this.childrenNextPageHandler)));this.treeViewer.model.addEventListener(new obips.Observable.EventListener(obips.Tree.Model.EventType.CHILD_NODES_PREVIOUS_PAGE,new obips.Callback(this,this.childrenPreviousPageHandler)));this.treeViewer.model.addEventListener(new obips.Observable.EventListener(obips.Tree.Model.EventType.CHILD_NODES_SET,new obips.Callback(this,this.childrenSetHandler)))}this.treeViewer.viewModel.addEventListener(new obips.Observable.EventListener(obips.Tree.ViewModel.EventType.TREE_NODE_VIEWER_SELECTED,new obips.Callback(this,this.treeNodeSelectedHandler)));this.treeViewer.viewModel.addEventListener(new obips.Observable.EventListener(obips.Tree.ViewModel.EventType.TREE_NODE_VIEWER_DESELECTED,new obips.Callback(this,this.treeNodeDeselectedHandler)));this.treeViewer.viewModel.addEventListener(new obips.Observable.EventListener(obips.Tree.ViewModel.EventType.TREE_NODE_VIEWER_ACTIVATED,new obips.Callback(this,this.treeNodeActivatedHandler)));this.treeViewer.viewModel.addEventListener(new obips.Observable.EventListener(obips.Tree.ViewModel.EventType.TREE_NODE_VIEWER_DEACTIVATED,new obips.Callback(this,this.treeNodeDeactivatedHandler)));this.treeViewer.viewModel.addEventListener(new obips.Observable.EventListener(obips.Tree.ViewModel.EventType.SHOW_SYSTEM_NODES,new obips.Callback(this,this.showSystemNodes)));this.treeViewer.viewModel.addEventListener(new obips.Observable.EventListener(obips.Tree.ViewModel.EventType.HIDE_SYSTEM_NODES,new obips.Callback(this,this.hideSystemNodes)));if(this.treeViewer.model.supportsNodeStatus){this.treeViewer.model.addEventListener(new obips.Observable.EventListener(obips.Tree.Model.EventType.TREE_NODE_STATUS_UPDATED,new obips.Callback(this,this.treeNodeStatusUpdatedHandler)))}this.treeViewer.model.addEventListener(new obips.Observable.EventListener(obips.Tree.Model.EventType.TREE_NODE_TYPE_UPDATED,new obips.Callback(this,this.treeNodeTypeUpdatedHandler)));this.treeViewer.model.addEventListener(new obips.Observable.EventListener(obips.Tree.Model.EventType.TREE_NODE_TOOLTIP_UPDATED,new obips.Callback(this,this.treeNodeTooltipUpdatedHandler)));this.attachVPATController()};obips.Tree.Controller.getChildren=function(b){var a=obips.Tree.NodeViewer.getTreeNodeViewerDivFromEvent(b);var c=a.treeNodeViewer;c.treeViewer.controller.getChildrenForTreeNodeViewer(c,true)};obips.Tree.Controller.prototype.getChildrenForTreeNodeViewer=function(g,f){var c=g.treeViewer;if(g.disclosure){g.disclosure.onclick=obips.Tree.Controller.toggleDisclosure}var k=c.model.getChildren(g.treeNode.id,g);if(!k){if(g.disclosure){g.disclosure.src=obips.Tree.Utilities.getImagePath("imgTree_ProcessingAnimated");g.disclosure.className="treeNodeProcessing";if(f){var b=obips.Tree.Utilities.getResourceString("kmsgJAWSTree_SubTreeIsExpandingPleaseWait");this.treeViewer.controller.oVPATController.setContainerCursor(b,false,null)}}}else{for(var e=0,d=0;e<k.length;e++){var a=c.model.nodes[k[e]];var h=new obips.Tree.NodeViewer(c,a,false,null,g.childrenDiv);if(a.isHidden||(!h.treeViewer.viewModel.showingSystemNodes&&a.isSystem)){h.hide()}else{h.show();d++}}g.nNumChildren=d;g.expandDisclosure(f)}g.childrenDiv.style.display="block";if(g.pagingDiv){g.pagingDiv.style.display="block"}};obips.Tree.Controller.prototype.findTreeNodeViewer=function(a){var c=null;var b=this.treeViewer.container.id+"$"+a;obips.Tree.complaint_about_the_use_of_document_getElementById();var d=document.getElementById(b);if(d&&d.treeNodeViewer){c=d.treeNodeViewer}return c};obips.Tree.Controller.VPATController=function(a,c){this.tTreeController=c;var d=a;var b=this.tTreeController.treeViewer.getScrollbarDiv();obips.Tree.Controller.VPATController.baseConstructor.call(this,a,d,b,null);this._installAdditionalListerners()};extend(obips.Tree.Controller.VPATController,obips.SimpleContainerTabStop);obips.Tree.Controller.VPATController.prototype._getDefaultScreenReaderProperties=function(){var a=new obips.SimpleContainerTabStop.ScreenReaderProperties();a.sFormatString=this._getScreenReaderFormatString();a.aTokenizerMatrix=this._getScreenReaderFormatTokenizer();a.nJAWSLabelSpanIndex=1;a.nJAWSCurrentValueSpanIndex=3;a.nJAWSCursorValueSpanIndex=5;return a};obips.Tree.Controller.VPATController.prototype._initLabelSpanIndices=function(a){this.aJAWSLabelSpanIndex=a[this.oScreenReaderProperties.nJAWSLabelSpanIndex];this.aJAWSCurrentValueSpanIndex=a[this.oScreenReaderProperties.nJAWSCurrentValueSpanIndex];this.aJAWSCursorValueSpanIndex=a[this.oScreenReaderProperties.nJAWSCursorValueSpanIndex]};obips.Tree.Controller.VPATController.prototype.setScreenReaderCursorValue=function(a){this.setScreenReaderLabelOnIndex(a,this.aJAWSCursorValueSpanIndex)};obips.Tree.Controller.VPATController.prototype._getScreenReaderControlType=function(){if(this.tTreeController.treeViewer.viewModel.selectionType==obips.Tree.ViewModel.SelectionType.MULTIPLE){return obips.Tree.Utilities.getResourceString("kmsgJAWSTree_ControlTypeIsMultiSelectTree")}else{if(this.tTreeController.treeViewer.viewModel.selectionType==obips.Tree.ViewModel.SelectionType.SINGLE){return obips.Tree.Utilities.getResourceString("kmsgJAWSTree_ControlTypeIsSingleSelectTree")}else{if(this.tTreeController.treeViewer.viewModel.selectionType==obips.Tree.ViewModel.SelectionType.NONE){return obips.Tree.Utilities.getResourceString("kmsgJAWSTree_ControlTypeIsNotSelectableTree")}else{return obips.Tree.Utilities.getResourceString("kmsgJAWSTree_ControlTypeIsSingleSelectTree")}}}};obips.Tree.Controller.VPATController.prototype._getScreenReaderFormatString=function(){return obips.Tree.Utilities.getResourceString("kmsgJAWSTree_DefaultAnnouncementFormatString")};obips.Tree.Controller.VPATController.prototype._getScreenReaderFormatTokenizer=function(){var a=[["@{ControlType}",this._getScreenReaderControlType()],["@{Label}",""],["@{CurrentValueStaticText}",obips.Tree.Utilities.getResourceString("kmsgJAWSTree_CurrentSelectedValuesAre")],["@{CurrentValues}",obips.Tree.Utilities.getResourceString("kmsgJAWSTree_SelectedValueIsNone")],["@{CursorPositionStaticText}",obips.Tree.Utilities.getResourceString("kmsgJAWSTree_CursorNodeIs")],["@{CursorValue}",""],["@{Instructions}",obips.Tree.Utilities.getResourceString("kmsgJAWSTree_OperatingInstructions")]];return a};obips.Tree.Controller.VPATController.prototype.getCursorText=function(a){return a.getScreenReaderText()};obips.Tree.Controller.VPATController.prototype.announceSubTreeExpanded=function(c,b){var a=obips.Tree.Utilities.getResourceString("kmsgJAWSTree_SubTreeIsExpandedFormatString");var f=c.getShortScreenReaderText(false);var d=c.nNumChildren;var e=a.replace("@{CurrentSubTreeText}",f).replace("@{NumberOfChildren}",d+"");this.setContainerCursor(e,false,null)};obips.Tree.Controller.VPATController.prototype._installAdditionalListerners=function(){if(this.tTreeController.treeViewer.bAllowTabIntoNodes){}else{var b=new obips.BrowserEventFramework.EventRouter(this.tElement,"onfocus");b.addEventListener(new obips.Observable.EventListener(null,new obips.Callback(this,this.onFocus)));var a=new obips.BrowserEventFramework.EventRouter(this.tElement,"onblur");a.addEventListener(new obips.Observable.EventListener(null,new obips.Callback(this,this.onBlur)))}this.tTreeController.treeViewer.viewModel.addEventListener(new obips.Observable.EventListener(obips.Tree.ViewModel.EventType.TREE_NODE_VIEWER_SELECTION_CHANGED,new obips.Callback(this,this.onTreeNodeSelectionChanged)));this.tTreeController.treeViewer.model.addEventListener(new obips.Observable.EventListener(obips.Tree.Model.EventType.JAWS_TREE_NODE_EXPANDED,new obips.Callback(this,this.onTreeNodeExpanded)))};obips.Tree.Controller.VPATController.prototype.onTreeNodeExpanded=function(d){if(d.oRequestChildrenTask.shouldViewerReactToModelEvent(this.tTreeController.treeViewer)){var a=this.tTreeController.treeViewer.container.id+"$"+d.context.id;obips.Tree.complaint_about_the_use_of_document_getElementById();var b=document.getElementById(a);if(b&&d.oRequestChildrenTask.shouldJAWSReactToModelEvent(this.tTreeController.treeViewer)){var c=b.treeNodeViewer;this.announceSubTreeExpanded(c,1)}}};obips.Tree.Controller.VPATController.prototype.onFocus=function(a){if(!this._shouldHandleOnFocus()){this.stopEvent(a,true);return}if(this.tTreeController.treeViewer.bAllowTabIntoNodes){}else{this._setToAnnounceLabel();this.stopEvent(a,true)}};obips.Tree.Controller.VPATController.prototype.onBlur=function(a){if(!this._shouldHandleOnBlur()){this.stopEvent(a,true);return}if(this.tTreeController.treeViewer.bAllowTabIntoNodes){this._setToAnnounceLabel()}else{if(this.tTreeController.treeViewer.curFocusNode){this.tTreeController.treeViewer._unfocusNode(this.tTreeController.treeViewer.curFocusNode)}this._setToAnnounceLabel();this.stopEvent(a,true)}};obips.Tree.Controller.VPATController.prototype.onTreeNodeSelectionChanged=function(a){var b=this.tTreeController.treeViewer.viewModel.selectedNodes;var d="";if(b.length>0){for(var c=0;c<b.length;c++){if(c!=0){d+=","}d+=b[c].getShortScreenReaderText(false)}}else{d=obips.Tree.Utilities.getResourceString("kmsgJAWSTree_SelectedValueIsNone")}this.setScreenReaderCurrentValue(d)};obips.Tree.Controller.VPATController.prototype.handleOtherKeyPress=function(a){if(!a.altKey&&!a.shiftKey){switch(a.keyCode){case obips.AdvTabStop.kKeys.nLeftArrowKey:if(!a.ctrlKey){this._ActivateLeftArrowKey(a);return}break;case obips.AdvTabStop.kKeys.nRightArrowKey:if(!a.ctrlKey){this._ActivateRightArrowKey(a);return}break;case obips.AdvTabStop.kKeys.nUpArrowKey:this._PrevMenuItem(a);return;case obips.AdvTabStop.kKeys.nDownArrowKey:this._NextMenuItem(a);return;case obips.AdvTabStop.kKeys.nHomeKey:if(!a.ctrlKey){this._FocusFirstItem(a);return}break;case obips.AdvTabStop.kKeys.nEndKey:if(!a.ctrlKey){this._FocusLastItem(a);return}break;case obips.AdvTabStop.kKeys.nEnterKey:this._ActivateEnterKey(a);return}switch(this._getKeyCode(a)){case obips.AdvTabStop.kKeys.nWhiteSpaceKey:this._ActivateSpaceBar(a);return}}};obips.Tree.Controller.VPATController.prototype._getEventTargetTreeNodeViewer=function(a){if(this.tTreeController.treeViewer.bAllowTabIntoNodes){var b=obips.BrowserEventFramework.getViewerFromEvent(a,"treeNodeViewer");return(b?b:null)}else{if(this.tTreeController.treeViewer.curFocusNode){return obips.BrowserEventFramework.getViewerFromElement(this.tTreeController.treeViewer.curFocusNode,"treeNodeViewer")}else{return null}}};obips.Tree.Controller.VPATController.prototype._ActivateLeftArrowKey=function(a){var b=this._getEventTargetTreeNodeViewer(a);if(b){b.collapseDisclosure()}this.stopEvent(a)};obips.Tree.Controller.VPATController.prototype._ActivateRightArrowKey=function(a){var b=this._getEventTargetTreeNodeViewer(a);if(b){if(b.disclosure){if(b.disclosure.onclick==obips.Tree.Controller.getChildren){b.treeViewer.controller.getChildrenForTreeNodeViewer(b,true)}else{b.expandDisclosure(true)}}}this.stopEvent(a)};obips.Tree.Controller.VPATController.prototype._NextMenuItem=function(a){var b=this._getEventTargetTreeNodeViewer(a);this.tTreeController._focusNextTreeNodeViewer(b);this.stopEvent(a)};obips.Tree.Controller.VPATController.prototype._PrevMenuItem=function(a){var b=this._getEventTargetTreeNodeViewer(a);this.tTreeController._focusPreviousTreeNodeViewer(b);this.stopEvent(a)};obips.Tree.Controller.VPATController.prototype._FocusFirstItem=function(a){this.tTreeController._focusNextTreeNodeViewerThatIsInArray(null,false,[]);this.stopEvent(a)};obips.Tree.Controller.VPATController.prototype._FocusLastItem=function(a){this.tTreeController._focusLastVisibleTreeNodeViewer();this.stopEvent(a)};obips.Tree.Controller.VPATController.prototype._ActivateSpaceBar=function(a){var b=this._getEventTargetTreeNodeViewer(a);if(b){obips.Tree.Controller._handleClickTreeNodeHandler(a,b,a.ctrlKey)}this.stopEvent(a)};obips.Tree.Controller.VPATController.prototype._ActivateEnterKey=function(a){this._ActivateSpaceBar(a)};obips.Tree.Controller._findVisibleLastDescendantTreeNodeViewer=function(c){var b=c;if(obips.CSS.getComputedStyle(b.childrenDiv).display!="none"){var e=b.childrenDiv.childNodes;for(var d=e.length-1;d>=0;d--){var a=e[d].treeNodeViewer;if(obips.CSS.getComputedStyle(a.div).display!="none"){b=obips.Tree.Controller._findVisibleLastDescendantTreeNodeViewer(a);break}}}return b};obips.Tree.Controller._findVisiblePreviousSiblingTreeNodeViewer=function(b){var a=null;var c=b.div;while(c.previousSibling){c=c.previousSibling;if(obips.CSS.getComputedStyle(c).display!="none"){a=c.treeNodeViewer;break}}return a};obips.Tree.Controller.prototype._setElementFocus=function(c,a){if(this.treeViewer.bAllowTabIntoNodes){if(a&&c.div.firstChild.focus){c.div.firstChild.focus();var b=c.getShortScreenReaderText(false);this.oVPATController.setScreenReaderCursorValue(b);var d=this.oVPATController.getCursorText(c);this.oVPATController.setContainerCursor(d,false,null)}}else{this.treeViewer._focusNode(c.treeNodeTextSpan);var b=c.getShortScreenReaderText(false);this.oVPATController.setScreenReaderCursorValue(b);var d=this.oVPATController.getCursorText(c);this.oVPATController.setContainerCursor(d,true,c.treeLine)}};obips.Tree.Controller.prototype._findPreviousTreeNodeViewer=function(d){if(!d){return null}var e=d.div;var b=obips.Tree.Controller._findVisiblePreviousSiblingTreeNodeViewer(d);var a=(d==this.treeViewer.rootTreeNodeViewer?null:d.getParentNodeViewer(false));var f=null;if(b){f=obips.Tree.Controller._findVisibleLastDescendantTreeNodeViewer(b)}else{if(a){f=a}}var c=(this.treeViewer.model.rootNode==this.treeViewer.model.originalRootNode&&this.treeViewer.hideRootNode);if(f&&(!c||f!=this.treeViewer.rootTreeNodeViewer)){return f}else{return null}};obips.Tree.Controller.prototype._focusPreviousTreeNodeViewer=function(a){var b=this._findPreviousTreeNodeViewer(a);if(b){this._setElementFocus(b,true)}};obips.Tree.Controller.prototype._focusLastVisibleTreeNodeViewer=function(){var a=this._findLastVisibleTreeNodeViewer();if(a){this._setElementFocus(a,true)}};obips.Tree.Controller.prototype._findLastVisibleTreeNodeViewer=function(){var b=null;for(var a=this._findNextTreeNodeViewerThatIsInArray(null,false,[]);a;){for(var c=a.div;c;c=c.nextSibling){if(c.treeNodeViewer&&obips.CSS.getComputedStyle(c.treeNodeViewer.div).display!="none"){b=c}}if(b&&b.treeNodeViewer&&obips.CSS.getComputedStyle(b.treeNodeViewer.childrenDiv).display!="none"&&b.treeNodeViewer.childrenDiv.firstChild){a=b.treeNodeViewer.childrenDiv.firstChild.treeNodeViewer}else{a=null}}if(b&&b.treeNodeViewer&&obips.CSS.getComputedStyle(b.treeNodeViewer.div).display!="none"&&(!this.treeViewer.hideRootNode||b.treeNodeViewer!=this.treeViewer.rootTreeNodeViewer)){return b.treeNodeViewer}else{return null}};obips.Tree.Controller.prototype._focusNextTreeNodeViewer=function(a){this._focusNextTreeNodeViewerThatIsInArray(a,false,[])};obips.Tree.Controller.prototype._focusNextTreeNodeViewerThatIsInArray=function(c,a,d){var b=this._findNextTreeNodeViewerThatIsInArray(c,a,d);if(b){this._setElementFocus(b,true)}};obips.Tree.Controller.prototype._findNextTreeNodeViewerThatIsInArray=function(a,l,g){var b=a;var f=null;if(!b){if(this.treeViewer.bAllowTabIntoNodes){return null}else{b=this.treeViewer.rootTreeNodeViewer;var h=(this.treeViewer.model.rootNode==this.treeViewer.model.originalRootNode&&this.treeViewer.hideRootNode);if(!h&&(!l||obips.Array.indexOf(g,b)>=0||g.length==0)){return b}else{if(!h){f=b}}}}var d=null;var k=false;do{k=false;var c=b.div;var j=b.childrenDiv.firstChild;var e=c.nextSibling;while(e&&e.treeNodeViewer&&obips.CSS.getComputedStyle(e.treeNodeViewer.div).display=="none"){e=e.nextSibling}d=null;if(obips.CSS.getComputedStyle(b.childrenDiv).display!="none"&&j&&j.treeNodeViewer!=null){d=j;if(obips.CSS.getComputedStyle(d.treeNodeViewer.div).display=="none"){k=true}}else{if(e&&e.treeNodeViewer!=null){d=e}else{for(var i=(c.treeNodeViewer?c.treeNodeViewer.getParentNodeViewer(false):null);i;i=i.getParentNodeViewer(false)){var m=i.div;var e=m.nextSibling;while(e&&e.treeNodeViewer&&obips.CSS.getComputedStyle(e.treeNodeViewer.div).display=="none"){e=e.nextSibling}if(e){d=e;if(obips.CSS.getComputedStyle(d).display=="none"){k=true}break}}}}b=(d?d.treeNodeViewer:null);if(!f&&!k){f=b}}while(d&&d.treeNodeViewer&&(k||l&&g.length>0&&obips.Array.indexOf(g,b)<0));if(d&&d.treeNodeViewer){return d.treeNodeViewer}else{if(f){return f}else{return null}}};obips.Tree.Controller.toggleDisclosure=function(c){var b=obips.Tree.NodeViewer.getTreeNodeViewerDivFromEvent(c);var a=b.treeNodeViewer;if(a.childrenDiv.style.display=="none"){a.expandDisclosure(true)}else{a.collapseDisclosure(true)}};obips.Tree.Controller.prototype._getTreeModelEventSourceNodeViewer=function(f,d){var b=null;if(f.oRequestChildrenTask.shouldViewerReactToModelEvent(this.treeViewer)){if(d==1&&(f.oRequestChildrenTask.loadingTreeNodeViewer||f.oRequestChildrenTask.activeLoadingTreeNodeViewer)){var e=(f.oRequestChildrenTask.loadingTreeNodeViewer?f.oRequestChildrenTask.loadingTreeNodeViewer:f.oRequestChildrenTask.activeLoadingTreeNodeViewer);if(e){b=e}}else{obips.Tree.complaint_about_the_use_of_document_getElementById();var c=this.treeViewer.container.id+"$"+((d==1)?f.context.parentID:f.context.id);var a=document.getElementById(c);if(a){b=a.treeNodeViewer}}}return b};obips.Tree.Controller.prototype.treeNodeAddedHandler=function(b){var a=this._getTreeModelEventSourceNodeViewer(b,1);if(a){if((!a.disclosure||a.disclosure.onclick==obips.Tree.Controller.getChildren)&&!this.treeViewer.model.dontIncludeDisclosures){this.treeViewer.model.getChildren(a.treeNode.id,a)}if(a.disclosure){a.disclosure.onclick=obips.Tree.Controller.toggleDisclosure}if(!a.disclosure||a.disclosure.onclick==obips.Tree.Controller.toggleDisclosure){a.appendChild(b.context,b.oRequestChildrenTask.shouldJAWSReactToModelEvent(this.treeViewer));if(!b.context.isHidden&&(a.treeViewer.viewModel.showingSystemNodes||!b.context.isSystem)){a.nNumChildren++}}}};obips.Tree.Controller.prototype.treeNodeRemovedHandler=function(h){var g=this.treeViewer.container.id+"$"+h.context.id;obips.Tree.complaint_about_the_use_of_document_getElementById();var c=document.getElementById(g);if(c){var a=c.treeNodeViewer;var f=a.getParentNodeViewer(false);if(f&&!c.isHidden&&(a.treeViewer.viewModel.showingSystemNodes||!c.isSystem)){f.nNumChildren--}this.treeViewer.viewModel.deselectRemovedNodes(a.treeViewer.model);var b=a.treeViewer.model.getKnownDescendantIDs(a.treeNode);b.push(a.treeNode.id);for(var d=0;d<b.length;d++){var e=b[d];delete a.treeViewer.viewModel.expandedNodes[e]}c.parentNode.removeChild(c)}};obips.Tree.Controller.prototype.treeNodeMovedHandler=function(j){var n=j.context.nodeToBeMovedGuid;var m=j.context.originalParentGuid;var h=j.context.referenceNodeGuid;var p=j.context.newParentGuid;var d=j.context.operation;var k=this.treeViewer.container.id+"$"+n;obips.Tree.complaint_about_the_use_of_document_getElementById();var l=document.getElementById(k);var q=this.treeViewer.container.id+"$"+p;obips.Tree.complaint_about_the_use_of_document_getElementById();var b=document.getElementById(q);if(d==obips.Tree.Model.MOVE_NODE_OPERATION.CHILD){b.lastChild.appendChild(l)}else{var c=this.treeViewer.container.id+"$"+h;obips.Tree.complaint_about_the_use_of_document_getElementById();var f=document.getElementById(c);if(d==obips.Tree.Model.MOVE_NODE_OPERATION.BEFORE){b.lastChild.insertBefore(l,f)}else{if(d==obips.Tree.Model.MOVE_NODE_OPERATION.AFTER){if(f.nextSibling){b.lastChild.insertBefore(l,f.nextSibling)}else{b.lastChild.appendChild(l)}}}}if(p!=m){var o=this.treeViewer.model.nodes[p];var g=this.treeViewer.model.nodes[m];this.treeViewer.model.notify(new obips.Observable.Event(obips.Tree.Model.EventType.TREE_NODE_UPDATED,new obips.Tree.ModelEventContext.TreeNodeUpdatedContext(o,o)));this.expandNode(m);this.expandNode(p);var a=this.treeViewer.model.getKnownDescendantIDs(this.treeViewer.model.nodes[p]);for(var e=0;e<a.length;e++){if(this.treeViewer.viewModel.expandedNodes[a[e]]){this.expandNode(a[e],true)}}}if(j.context.bSelectMovedNode){obips.asyncCall(new obips.Callback(this,this.selectMovedNode),10,n)}};obips.Tree.Controller.prototype.expandNode=function(f,h){var d=false;var b=this.treeViewer.container.id+"$"+f;obips.Tree.complaint_about_the_use_of_document_getElementById();var c=document.getElementById(b);if(!c&&!h){var g=this.treeViewer.model.nodes[f];var e=this.expandNode(g.parentID);if(e){d=this.expandNode(f,true)}}else{if(c){var a=c.treeNodeViewer;if((a.childrenDiv!=null)&&(a.childrenDiv.style.display!="block")){obips.Tree.Controller.simulateClick(a.disclosure)}d=true}}return d};obips.Tree.Controller.prototype.selectMovedNode=function(c){var d=this.treeViewer.container.id+"$"+c;obips.Tree.complaint_about_the_use_of_document_getElementById();var b=document.getElementById(d);var a=b.treeNodeViewer;obips.Tree.Controller.simulateClick(a.treeNodeDetailsSpan)};obips.Tree.Controller.simulateClick=function(b){if(!b.click){var a=b.ownerDocument.createEvent("MouseEvents");a.initMouseEvent("click",true,true,b.ownerDocument.defaultView,1,0,0,0,0,false,false,false,false,0,null);b.dispatchEvent(a)}else{b.click()}};obips.Tree.Controller.prototype.treeNodeUpdatedHandler=function(h){var c=h.context.oldTreeNode;var k=h.context.newTreeNode;obips.Tree.complaint_about_the_use_of_document_getElementById();var j=this.treeViewer.container.id+"$"+c.id;var b=document.getElementById(j);var d=null;if(c.id!=k.id){if(b){var l=b.treeNodeViewer;l.div.parentNode.removeChild(l.div);if(this.treeViewer.viewModel.activeNode&&this.treeViewer.viewModel.activeNode.treeNode.id==c.id){this.treeViewer.viewModel.activeNode.treeNode=k}}var i=this.treeViewer.model.nodes[k.parentID];if(i){var g=this.treeViewer.container.id+"$"+i.id;var a=document.getElementById(g);if(a){var f=a.treeNodeViewer;d=f.appendChild(k,false)}}}else{if(b){var l=b.treeNodeViewer;d=l.replaceChild(k)}}if(b){var l=b.treeNodeViewer;var e=this.treeViewer.viewModel.isNodeSelected(l);this.treeViewer.viewModel.deselectSubtree(l);if(e){this.treeViewer.viewModel.selectNode(d)}}};obips.Tree.Controller.prototype.treeNodeStatusUpdatedHandler=function(c){var e=c.context;var b=this.treeViewer.container.id+"$"+e.id;obips.Tree.complaint_about_the_use_of_document_getElementById();var a=document.getElementById(b);if(a){var d=a.treeNodeViewer;d.updateStatus()}};obips.Tree.Controller.prototype.treeNodeTypeUpdatedHandler=function(c){var e=c.context;var b=this.treeViewer.container.id+"$"+e.id;obips.Tree.complaint_about_the_use_of_document_getElementById();var a=document.getElementById(b);if(a){var d=a.treeNodeViewer;d.updateType()}};obips.Tree.Controller.prototype.treeNodeTooltipUpdatedHandler=function(e){var d=e.context;var b=this.treeViewer.container.id+"$"+d.id;obips.Tree.complaint_about_the_use_of_document_getElementById();var a=document.getElementById(b);if(a){var c=a.treeNodeViewer;c.updateTooltip(d.description||d.name)}};obips.Tree.Controller.prototype.parentHasNoChildrenHandler=function(b){var a=this._getTreeModelEventSourceNodeViewer(b,0);if(a){a.childrenDiv.style.display="none";if(a.disclosure!=null){a.disclosure.style.visibility="hidden"}this.oVPATController.announceSubTreeExpanded(a,2)}};obips.Tree.Controller.prototype.mouseOverTreeNodeHandler=function(b){var a=obips.Tree.NodeViewer.getTreeNodeViewerDivFromEvent(b);var c=a.treeNodeViewer;c.hover()};obips.Tree.Controller.prototype.mouseOutTreeNodeHandler=function(b){var a=obips.Tree.NodeViewer.getTreeNodeViewerDivFromEvent(b);var c=a.treeNodeViewer;c.noHover()};obips.Tree.Controller.prototype.clickTreeNodeHandler=function(b){var a=obips.Tree.NodeViewer.getTreeNodeViewerDivFromEvent(b);var c=a.treeNodeViewer;b=obips.BrowserEventFramework.normalizeEvent(b);obips.Tree.Controller._handleClickTreeNodeHandler(b,c,b.ctrlKey,b.shiftKey)};obips.Tree.Controller._handleClickTreeNodeHandler=function(o,k,c,q){var e=k.treeViewer,m=e.viewModel,j,p,h,b=m.lastSelectedNodeViewer,l,g,a,f,d;if(q&&m.selectionType==obips.Tree.ViewModel.SelectionType.MULTIPLE){h=m.numSelectedNodes();if(h===0){m.selectNode(k);m.activateNode(k)}else{if(b){l=b.getParentNodeViewer(false);j=k.getParentNodeViewer(false);if(j===l){a=k.div;g=[];while(a&&a!=b.div){g.unshift(a.treeNodeViewer);a=a.previousSibling}if(a!=b.div){a=k.div;g=[];while(a&&a!=b.div){g.unshift(a.treeNodeViewer);a=a.nextSibling}}g.unshift(b);m.setNodeSelection(g);m.lastSelectedNodeViewer=b;m.activateNode(k)}else{m.selectSingleNode(k);m.activateNode(k)}}}}else{if(c&&m.selectionType==obips.Tree.ViewModel.SelectionType.MULTIPLE){if(m.isNodeSelected(k)){m.deselectNode(k);m.deactivateNode()}else{m.selectNode(k);m.activateNode(k)}}else{if(m.selectionType!=obips.Tree.ViewModel.SelectionType.NONE){m.selectSingleNode(k);m.activateNode(k)}}}if(!k.treeNode.isDisabled){e.controller._setElementFocus(k,false)}m.notify(new obips.Observable.Event(obips.Tree.ViewModel.EventType.TREE_NODE_VIEWER_CLICKED,new obips.Tree.ViewModelEventContext.CommonEventContext(k,o||window.event)))};obips.Tree.Controller.prototype.clickPageUpHandler=function(a){a=obips.BrowserEventFramework.normalizeEvent(a);var b=a.target.treeNodeViewer;b.treeViewer.model.notify(new obips.Observable.Event(obips.Tree.Model.EventType.CHILD_NODES_PREVIOUS_PAGE,b))};obips.Tree.Controller.prototype.childrenPreviousPageHandler=function(c){var a=c.context;var b=a.treeViewer;a.setCurrentChildIndex(a.currentChildIndex-b.model.pageSize);b.model.getChildren(a.treeNode.id,a,true)};obips.Tree.Controller.prototype.clickPageDownHandler=function(a){a=obips.BrowserEventFramework.normalizeEvent(a);var b=a.target.treeNodeViewer;b.treeViewer.model.notify(new obips.Observable.Event(obips.Tree.Model.EventType.CHILD_NODES_NEXT_PAGE,b))};obips.Tree.Controller.prototype.childrenNextPageHandler=function(c){var a=c.context;var b=a.treeViewer;a.setCurrentChildIndex(a.currentChildIndex+b.model.pageSize);b.model.getChildren(a.treeNode.id,a,true)};obips.Tree.Controller.prototype.childrenSetHandler=function(f){var c=f.oRequestChildrenTask;var e=f.numChildNodesRetrieved;var d=c.activeLoadingTreeNodeViewer;if(!d){d=c.loadingTreeNodeViewer}if(!d){var b=this.treeViewer.container.id+"$"+c.parentNodeID;var a=document.getElementById(b);if(a){d=a.treeNodeViewer}}if(d&&c.enablePaging){if(d.currentChildIndex==0){if(e>c.pageSize&&d.treeNode.childNodeIDs.length<=obips.Tree.Model.DEFAULT_CHILD_LIMIT){d.showPagingIcons()}else{d.hidePagingIcons()}}else{if(e>c.pageSize&&d.treeNode.childNodeIDs.length<=obips.Tree.Model.DEFAULT_CHILD_LIMIT){d.showPagingIcons()}else{d.hidePagingIcons()}}}};obips.Tree.Controller.prototype.treeNodeSelectedHandler=function(a){a.context.select()};obips.Tree.Controller.prototype.treeNodeDeselectedHandler=function(a){a.context.deselect()};obips.Tree.Controller.prototype.treeNodeActivatedHandler=function(a){a.context.activate()};obips.Tree.Controller.prototype.treeNodeDeactivatedHandler=function(a){a.context.deactivate()};obips.Tree.Controller.prototype.treeNodeShownHandler=function(c){var a=this.treeViewer.container.id+"$"+c.context.id;obips.Tree.complaint_about_the_use_of_document_getElementById();var b=document.getElementById(a);if(b){b.treeNodeViewer.show()}};obips.Tree.Controller.prototype.treeNodeHiddenHandler=function(c){var a=this.treeViewer.container.id+"$"+c.context.id;obips.Tree.complaint_about_the_use_of_document_getElementById();var b=document.getElementById(a);if(b){b.treeNodeViewer.hide()}};obips.Tree.Controller.prototype.treeNodeDisabledHandler=function(c){var a=this.treeViewer.container.id+"$"+c.context.id;obips.Tree.complaint_about_the_use_of_document_getElementById();var b=document.getElementById(a);if(b){this.treeViewer.viewModel.deselectSingleNode(b.treeNodeViewer);b.treeNodeViewer.disable()}};obips.Tree.Controller.prototype.treeNodeEnabledHandler=function(c){var a=this.treeViewer.container.id+"$"+c.context.id;obips.Tree.complaint_about_the_use_of_document_getElementById();var b=document.getElementById(a);if(b){b.treeNodeViewer.enable()}};obips.Tree.Controller.prototype.treeNodeCutModeOnHandler=function(c){var a=this.treeViewer.container.id+"$"+c.context.id;obips.Tree.complaint_about_the_use_of_document_getElementById();var b=document.getElementById(a);if(b){b.treeNodeViewer.turnOnCutMode()}};obips.Tree.Controller.prototype.treeNodeCutModeOffHandler=function(c){var a=this.treeViewer.container.id+"$"+c.context.id;obips.Tree.complaint_about_the_use_of_document_getElementById();var b=document.getElementById(a);if(b){b.treeNodeViewer.turnOffCutMode()}};obips.Tree.Controller.prototype.treeNodeExpandedHandler=function(d){if(d.oRequestChildrenTask.shouldViewerReactToModelEvent(this.treeViewer)){var a=this.treeViewer.container.id+"$"+d.context.id;obips.Tree.complaint_about_the_use_of_document_getElementById();var b=document.getElementById(a);if(b){var c=b.treeNodeViewer;if((null!=c.childrenDiv)&&(c.childrenDiv.style.display!="block")){c.treeViewer.controller.getChildrenForTreeNodeViewer(c,d.oRequestChildrenTask.shouldJAWSReactToModelEvent(this.treeViewer))}}}};obips.Tree.Controller.prototype.dblClickTreeNodeHandler=function(b){var a=obips.Tree.NodeViewer.getTreeNodeViewerDivFromEvent(b);var c=a.treeNodeViewer;if(c.disclosure&&c.disclosure.onclick&&c.treeNodeTypeInfo._bExpandChildrenOnDblclk==true){c.disclosure.onclick(b)}c.treeViewer.controller._setElementFocus(c,false);c.treeViewer.viewModel.notify(new obips.Observable.Event(obips.Tree.ViewModel.EventType.TREE_NODE_VIEWER_DOUBLE_CLICKED,c))};obips.Tree.Controller.prototype.dragTreeNodeHandler=function(a,b){b.nodeViewer.treeViewer.viewModel.notify(new obips.Observable.Event(obips.Tree.ViewModel.EventType.DRAG_TREE_NODE,new obips.Tree.ViewModelEventContext.DragDropEventContext(b,null,a)))};obips.Tree.Controller.prototype.dragEnterHandler=function(a,b,c){c.treeNodeTextSpan.className=c.treeNodeTextSpan.className+" treeLineDropTarget";c.treeViewer.viewModel.notify(new obips.Observable.Event(obips.Tree.ViewModel.EventType.DRAG_ENTER_TREE_NODE,new obips.Tree.ViewModelEventContext.DragDropEventContext(b,c,a)))};obips.Tree.Controller.prototype.dragOverHandler=function(a,b,c){c.treeViewer.viewModel.notify(new obips.Observable.Event(obips.Tree.ViewModel.EventType.DRAG_OVER_TREE_NODE,new obips.Tree.ViewModelEventContext.DragDropEventContext(b,c,a)))};obips.Tree.Controller.prototype.dragLeaveHandler=function(a,b,c){obips.CSS.removeClassFromElement(c.treeNodeTextSpan,"treeLineDropTarget");c.treeViewer.viewModel.notify(new obips.Observable.Event(obips.Tree.ViewModel.EventType.DRAG_LEAVE_TREE_NODE,new obips.Tree.ViewModelEventContext.DragDropEventContext(b,c,a)))};obips.Tree.Controller.prototype.dropHandler=function(a,b,c){obips.CSS.removeClassFromElement(c.treeNodeTextSpan,"treeLineDropTarget");c.treeViewer.viewModel.notify(new obips.Observable.Event(obips.Tree.ViewModel.EventType.OBJECT_DROPPED_ON_TREE_NODE,new obips.Tree.ViewModelEventContext.DragDropEventContext(b,c,a)))};obips.Tree.Controller.prototype.contextMenuHandler=function(b){b=b||window.event;var a=obips.Tree.NodeViewer.getTreeNodeViewerDivFromEvent(b);var c=a.treeNodeViewer;c.treeViewer.viewModel.selectSingleNode(c);c.treeViewer.viewModel.notify(new obips.Observable.Event(obips.Tree.ViewModel.EventType.TREE_NODE_VIEWER_CONTEXT_MENU,new obips.Tree.ViewModelEventContext.ContextMenuEventContext(c,b)));return false};obips.Tree.Controller.prototype.rerootTreeToTreeNode=function(f){var d=this.treeViewer.model;var b=this.treeViewer.container;var a=this.treeViewer.nodeViewerTypeInfos;var h=this.treeViewer.defaultNodeViewerTypeInfo;var g=f;d.rootNode=g;var c=globalRegister.getObjectID(this.treeViewer);var e=new obips.Tree.Viewer(d,b,obips.Tree.Utilities.getResourceManager(),a,true,this.treeViewer.hideRootNode,true);e.setDefaultTreeNodeViewerTypeInfo(h);e.viewModel.listeners=this.treeViewer.viewModel.listeners;globalRegister.addObject(c,e);this.treeViewer.viewModel.notify(new obips.Observable.Event(obips.Tree.ViewerEventType.NEW_TREE_VIEWER,e))};obips.Tree.Controller.prototype.showSystemNodes=function(){var a=this.treeViewer.div.getElementsByTagName("div");for(var b=0;b<a.length;b++){if(a[b].className.indexOf("systemTreeNode")!=-1){a[b].style.display="block"}}};obips.Tree.Controller.prototype.hideSystemNodes=function(){var a=this.treeViewer.div.getElementsByTagName("div");for(var b=0;b<a.length;b++){if(a[b].className.indexOf("systemTreeNode")!=-1){a[b].style.display="none"}}};obips.Tree.Controller.prototype.canAcceptDrop=function(a,c){if(a.draggedNodes){for(var b=0;b<a.draggedNodes.length;b++){if(c.treeNode==a.draggedNodes[b].treeNode||this.treeViewer.model.isDescendant(c.treeNode,a.draggedNodes[b].treeNode)){return false}}}return true};obips.Tree.Controller.prototype.getExpandedNodes=function(b,e){var c=this.treeViewer.model.nodes;if(e.childNodeIDs){for(var d=0;d<e.childNodeIDs.length;d++){var f=c[e.childNodeIDs[d]];var a=this.findTreeNodeViewer(f.id);if(a&&a.isDisclosureExpanded()&&!obips.Array.contains(b,f.id)){b.push(f.id);if(f.childrenRetrieved){this.getExpandedNodes(b,f)}}}}return b};