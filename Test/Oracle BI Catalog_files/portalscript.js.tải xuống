if(typeof(portalscript_js)=="undefined"){portalscript_js=true;if(!saw.dashboard){saw.dashboard=function(){}}saw.dashboard.impl=function(){};saw.dashboard.resourceFile="dashboards/publishdashboard.xml";var g_SeleniumTestFlag=false;saw.dashboard.getLocMessage=function(a){return obips.ResourceManager.getSingleton().getResource(saw.dashboard.resourceFile,a).getString()};saw.dashboard.getDashboardReportStatepaths=function(){return vReportIds.toString()};saw.dashboard.showMsgDialog=function(b,a,e){var c=new obips.MessageDialog.Model(b,a,null,(!saw.checkObjectReference(e)?obips.MessageDialog.TITLE_IMAGE_ERROR:obips.MessageDialog.TITLE_IMAGE_INFO));var d=new obips.MessageDialog.Viewer(c,obips.FloatingWindow.Manager.getSingleton(),true)};saw.dashboard.loadEditCustomizationHeader=function(){saw.ondemandload.retrieveAndAddResources({messageTemplate:"kuiSavedSelectionPermissionsEditorHead"},null,new obips.Callback(null,saw.dashboard.loadEditCustomizationHandler))};saw.dashboard.loadEditCustomizationHandler=function(){obidash.EditCustomizationDialog.launch()};var vRefresh=null;var vGFPRefresh=null;var vSecRefresh=[];var vFormattedReportLinkRefresh=null;var bFirstLoad=true;var vReportIds=[];var vGFPIds=[];var vFormattedReportLinkIds=[];var vSecIds=[];var vFormattedReportIds=[];var vSimpleObjectIds=[];var sSectionIdStyleInfo=[];var vScorecardIds=[];var vScorecardObjects=[];var sEmbedFrameID="idEmbed";var sEmbedFrameDivID="idEmbedFrameDiv";var bDescShown=false;var sMobileLayoutOptimized="3";var sMobileLayoutNonOptimized="4";SetPortalLogo=function(b){var a=parent.frames.banner;a.document.images.PortalImage.src=b};SetPageBackground=function(a){document.body.background=a};HideSectionHeading=function(){};siteMapShowDesc=function(){if(bDescShown){sVal="none"}else{sVal="inline"}bDescShown=!bDescShown;var a=parent.document.getElementsByTagName("div");for(var b=0;b<a.length;b++){var d=a[b];if(d.getAttribute("type")=="desc"){try{d.style.display=sVal}catch(c){}}}};dashboardFormSubmit=function(a){if(obips.BreadCrumbs){var b=obips.BreadCrumbs.Manager.getSingleton();b._updateOnPageUnload()}obips.launcher.Manager.getInstance().removeAllPageGuards();saw.submitForm(a)};DashboardChangePage=function(d,f){var e=document.getElementById("idViewStateDiv");var c=e.getAttribute("statePath");if(!c){c="d:dashboard"}var b=obips.views.ViewController.getController(c).getClientStateManager();if(e){saw.addHiddenInput(d,"ViewState",e.getAttribute("stateID"));saw.addHiddenInput(d,"StateAction","NewPage");saw.addHiddenInput(d,"ClientStateXml",b.getCurrentStateXmlAsString())}if(f&&typeof(biadf)!="undefined"&&biadf.syndicate){f.targetView=c;var a=biadf.issueBIAdfGetRptXmlContextualEventCurrentRef(b,f)}dashboardFormSubmit(d);return false};GuidedNav=function(c,a){var b=document.getElementById("idViewStateDiv");if(b&&a){c+="&ViewState="+b.getAttribute("stateID");c+="&StateAction=NewPage"}saw.runThisURL(c);return false};toggleAdvancedReportVersions=function(b,m,l,a,o,g){var h=document.getElementById(b);var f=document.getElementById(m);var c=document.getElementById(l);var k=document.getElementById(a);var n=document.getElementById(o);var e=document.getElementById(g);if(f.style.display==""){f.style.display="none";c.style.display="none";k.style.display="none";h.style.display=""}else{f.style.display="";h.style.display="none";var j=(null!=n.loaded)?n.loaded:n.getAttribute("loaded");if(j=="true"){c.style.display="";k.style.display="none"}else{n.setAttribute("loaded","false");c.style.display="none";k.style.display="";var d=(null!=e.pSrc)?e.pSrc:e.getAttribute("pSrc");e.src=d}}};loadAdvancedReportVersions=function(g,a,j,d){var b=document.getElementById(g);var f=document.getElementById(a);var h=document.getElementById(j);var c=document.getElementById(d);if(null==h||null==b||null==f||null==c){return}var e=(null!=h.loaded)?h.loaded:h.getAttribute("loaded");if(e=="false"){b.style.display="";f.style.display="none";h.innerHTML=c.contentWindow.document.body.innerHTML;h.setAttribute("loaded","true")}};RefreshPage=function(b,e){var a=obidash.getViewController();var f=saw.commandToURL("Dashboard");f+="&PortalPath="+saw.encodeURIComponent(a.getViewEnvParam("PortalPath"));f+="&Page="+saw.encodeURIComponent(a.getViewEnvParam("Page"));var d=document.getElementById("idViewStateDiv");if(d){f+="&Action=RefreshAll";f+="&ViewState="+d.getAttribute("stateID");f+="&StateAction=samePageState"}if(!e&&obidash){e=obidash.getCurrPageDelayedState()}if(e){f+="&PageDelayedState="+saw.encodeURIComponent(e)}if(typeof(b)!="undefined"&&b!=null){switch(b){case sMobileLayoutOptimized:f+="&optimized=true";break;case sMobileLayoutNonOptimized:f+="&optimized=false";break}}var c=saw.createForm("tempForm");c.action=f;saw.submitForm(c,null,{ensureFreshUrl:true});return false};EditPage=function(a){window.location.href=a;return false};DashboardReportLink=function(b,h,g,a){var c=document.getElementById("idViewStateDiv");if(c){b+="&ViewState="+c.getAttribute("stateID");b+="&StateAction=samePageState";b+="&ViewID="+h;g+="&ViewState="+encodeURIComponent(c.getAttribute("stateID"))}if(a&&!obips.launcher.Manager.getInstance()._isMobileAppSession()){b+="&Done=Close";obips.launcher.launchNewWindow(b,"_blank","",{ensureFreshUrl:true})}else{if(typeof(biadf)!="undefined"&&biadf.syndicate){var e=obips.views.ViewController.getController(h).getClientStateManager();var d={actionType:"DashboardReportLink",targetView:h,targetType:biadf.TargetType.kBIReport,params:{sLink:b,sDone:g,bNewWindow:a,StateAction:"samePageState"}};var j=biadf.issueBIAdfGetRptXmlContextualEventCurrentRef(e,d)}if(obidash){var f=obidash.getCurrPageDelayedState();if(f){g+="&PageDelayedState="+saw.encodeURIComponent(f)}}b+="&Done="+saw.encodeURIComponent(g);obips.launcher.launchURL(b,{ensureFreshUrl:true})}return false};PortalPrint=function(k,m,b,d,f){var j=new Object;j.format=(d!==null)?d:"html";var g=document.getElementById("idViewStateDiv");var a=g.getAttribute("statePath");var h=obips.views.ViewController.getController(a).getClientStateManager();if(vScorecardObjects.length>0&&!f){saw.dashboard.handleScorecardItemsForPrint(k,m,d,b,h)}else{var e=saw.createForm("dashboardPrintForm",saw.commandToURL("Dashboard"));saw.addHiddenInput(e,"DownloadId",j.id);if(b){e.target=((g_SeleniumTestFlag||obips.selenium.testEnabled)&&!d)?"obipsDashboardPrnWnd":"_blank"}saw.addHiddenInput(e,"Action","Print");saw.addHiddenInput(e,"PortalPath",k);saw.addHiddenInput(e,"Page",m);if(saw.checkObjectReference(d)){saw.addHiddenInput(e,"Format",d)}var l=h.getCurrentStateXmlAsString();saw.addHiddenInput(e,"ClientStateXML",l);var c=g.getAttribute("stateID");saw.addHiddenInput(e,"ViewState",c);NQWClearActiveMenu();saw.submitForm(e)}return false};saw.dashboard.DisplayBipLayoutsCallback=function(e){var c=saw.dashboard.ConstructDisplayNameList(e.sPortalPath,e.sPage,e.bExportEnabled,e.exportFormat);var f;switch(e.exportFormat){case"pdf":f=document.getElementById("idDashboardPrintDisplayLayoutMenu");break;case"excel":f=document.getElementById("idDashboardExportToExcelMenu");break;default:}var a=f.getElementsByTagName("td")[0];obips.HTMLDOM.removeChildNodes(a);var d=0;if(c[0]==="Printable PDF"||c[0]==="Printable HTML"||c[0]==="currentPage"||c[0]==="entireDashboard"){d++}if(c[1]==="Printable PDF"||c[1]==="Printable HTML"||c[1]==="currentPage"||c[1]==="entireDashboard"){d++}for(var l=0;l<c.length;++l){if(l==d&&l!=0){var q=document.createElement("div");q.setAttribute("class","NQWMenuItemSeparator");a.appendChild(q)}var n=document.createElement("a");n.setAttribute("class","masterMenuItem NQWMenuItem NQWMenuItemWIconMixin");var b='return saw.dashboard.HandleLayoutClick("'+saw.encode.encodeJavaScript(e.sPortalPath)+'", "'+saw.encode.encodeJavaScript(e.sPage)+'","'+saw.encode.encodeJavaScript(c[l])+'","'+saw.encode.encodeJavaScript(e.exportFormat)+'");';n.setAttribute("onclick",b);n.setAttribute("href","javascript:void(null)");if((g_SeleniumTestFlag||obips.selenium.testEnabled)&&c[l]=="Printable HTML"){n.setAttribute("target","obipsDashboardPrnWnd")}a.appendChild(n);var g=document.createElement("table");g.setAttribute("class","MenuItemTable");g.setAttribute("cellspacing","0");g.setAttribute("cellpadding","0");n.appendChild(g);var o=document.createElement("tbody");g.appendChild(o);var p=document.createElement("tr");o.appendChild(p);var h=document.createElement("td");h.setAttribute("class","MenuItemIconCell");p.appendChild(h);var k=document.createElement("img");if(c[l]!="Printable HTML"&&e.exportFormat==="pdf"){k.src=saw.catalog.getImgUrl("catalog/printtopdf_ena.png")}else{if(e.exportFormat==="excel"){k.src=saw.catalog.getImgUrl("catalog/exporttoexcel_ena.png")}else{k.src=saw.catalog.getImgUrl("catalog/printtohtml_ena.png")}}k.setAttribute("alt","");h.appendChild(k);var j=document.createElement("td");j.setAttribute("class","MenuItemTextCell");p.appendChild(j);var m;if(c[l]=="Printable PDF"){m=document.createTextNode(obidash.getResourceString(obidash.builderResourceFile,"kmsgDashboardEditorPrintAsPDF"))}else{if(c[l]=="Printable HTML"){m=document.createTextNode(obidash.getResourceString(obidash.builderResourceFile,"kmsgDashboardEditorPrintAsHTML"))}else{if(c[l]=="currentPage"){m=document.createTextNode(obidash.getResourceString(obidash.builderResourceFile,"kmsgDashboardExportToExcelCurrentPage"))}else{if(c[l]=="entireDashboard"){m=document.createTextNode(obidash.getResourceString(obidash.builderResourceFile,"kmsgDashboardExportToExcelEntireDashboard"))}else{m=document.createTextNode(c[l])}}}}j.appendChild(m)}saw.menuItemMouseOver(e.event,e.menuId);return false};saw.dashboard.ConstructDisplayNameList=function(n,p,g,e){if(g=="false"){switch(e){case"pdf":return["Printable PDF","Printable HTML"];case"excel":return["currentPage","entireDashboard"];default:break}}var h=obidash.getDashboardPageXml(n,p);var o=obidash.getBipReportPath(n,p,h);var b=[];if(saw.catalog.getCatalogManager().isItemExist(o)){b=obidash.getBipLayoutsNameList(saw.catalog.toBIPublisherPath(o))}var f;switch(e){case"pdf":b.unshift("Printable PDF","Printable HTML");f=obips.XMLDOM.selectNodes(h,"//saw:bipLayout");break;case"excel":b.unshift("currentPage","entireDashboard");f=obips.XMLDOM.selectNodes(h,"//saw:bipLayoutForExcel");break;default:break}var m=[];for(var d=0;d<f.length;d++){m.push(obips.XMLDOM.getNodeText(f[d]))}var a=[];for(var d=0;d<b.length;d++){for(var c=0;c<m.length;c++){if(b[d]===m[c]){a.push(b[d]);break}}}var l=obips.XMLDOM.selectSingleNode(h,"//saw:bipLayoutsList");var k=obips.XMLDOM.selectSingleNode(h,"//saw:bipLayoutsListForExcel");if(!l&&e==="pdf"){a.unshift("Printable PDF","Printable HTML")}else{if(!k&&e==="excel"){a.unshift("currentPage","entireDashboard")}}return a};saw.dashboard.HandleLayoutClick=function(h,l,j,b){if(j=="Printable PDF"){return PortalPrint(h,l,true,"pdf")}else{if(j=="Printable HTML"){return PortalPrint(h,l,true,null)}else{if(j=="currentPage"){return saw.dashboard.exportToExcel(h,l,true)}else{if(j=="entireDashboard"){return saw.dashboard.exportToExcel(h,l,false)}}}}var d=document.getElementById("idViewStateDiv");var a=d.getAttribute("statePath");var f=d.getAttribute("stateID");var g=obips.views.ViewController.getController(a).getClientStateManager();var k=g.getCurrentStateXmlAsString();var c=saw.createForm("dashboardPrintToPdfForm",saw.commandToURL("ExecuteReportObject"));var e=obidash.getBipReportPath(h,l);saw.addHiddenInput(c,"Path",e);saw.addHiddenInput(c,"bipPath",saw.catalog.toBIPublisherPath(e));saw.addHiddenInput(c,"statePath",a);saw.addHiddenInput(c,"stateId",f);saw.addHiddenInput(c,"PortalPath",h);saw.addHiddenInput(c,"Page",l);if(b=="pdf"){saw.addHiddenInput(c,"DisplayMode","print")}else{if(b=="excel"){saw.addHiddenInput(c,"DisplayMode","exportExcel")}}saw.addHiddenInput(c,"NameBipLayout",j);saw.addHiddenInput(c,"ClientStateXML",k);c.target="_blank";NQWClearActiveMenu();saw.submitForm(c);return false};saw.dashboard.DisplayLayouts=function(f,g,e,c,b,a){var d=["res/b_mozilla/webserviceproxies/catalogmanager.js","res/b_mozilla/deliversShared/obids.namespaceMap.js"];saw.ondemandload.addJavaScriptSources(d,new obips.Callback(null,saw.dashboard.DisplayBipLayoutsCallback),{sPortalPath:e,sPage:c,event:f,menuId:g,bExportEnabled:b,exportFormat:a});return false};smartviewExportPage=function(c,f,b,e){var d=e.split(",");var a="scope: "+c+"\ncurrrent page name: "+b+"\n";var g="current portal path:"+f+"\ncurrent page path:"+f+"/"+b};smartviewExportDashboard=function(d,g,b,f){var c=f.split(",");var a="scope: "+d+"\ncurrrent dashboard portal path: "+g+"\n";var h="";for(var e=0;e<c.length-1;e++){h=h+"\npagePath: "+c[e]}};PortalPrintScorecardMonitor=function(e,b,g,a,c,f,d){this.portalPath=e;this.page=b;this.isNewWindow=g;this.format=a;this.numScorecardViews=c;this.clientStateManager=f;this.numberViewsReady=0;this.isCurrentPage=d};PortalPrintScorecardMonitor.prototype.handleDonePrepareViewForPrint=function(){this.numberViewsReady++;if(this.numberViewsReady>=this.numScorecardViews){if(this.format=="excelx"){saw.dashboard.exportToExcel(this.portalPath,this.page,this.isCurrentPage,true)}else{PortalPrint(this.portalPath,this.page,this.isNewWindow,this.format,true)}}};PortalPrintScorecardMonitor.prototype.setStateForScorecardView=function(c,b,a){this.clientStateManager.setStateValue(c,b,a)};PopupBBWindow=function(e,h,d,b,a){saw.clearActiveMenu();var g=document.getElementById("idViewStateDiv");var j=null;if(g!=undefined){a+="&ViewState="+g.getAttribute("StateID")}var c=null;var f=new saw.ondemandload.FuncProxy("obips.briefingbook.launchAddToBBDialog",{messageTemplate:"kuiAddToBriefingBookDialogHead"});f.exec(e,h,d,b,a,c);return false};RefreshDashboard=function(b){var a=document.getElementById("idViewStateDiv");if(a!=undefined){b+="&ViewState="+a.getAttribute("StateID")}saw.runThisURL(b)};saw.dashboard.needsRefresh=function(a){if(saw.aViewsToRefresh){return(saw.aViewsToRefresh.all||saw.aViewsToRefresh[a])}else{return false}};getCopySwf=function(e,f,d,c,a){var b='<object tabindex="0" classid="'+e+'" id="'+d+'" width="35" height="21"codebase="'+f+'"><param name="movie" value="'+c+'"/><param name="quality" value="high"/><param name="bgcolor" value="#FFFFFF"/><param name="wmode" value="transparent"/><param name="play" value="true"/><param name="flashvars" value="'+a+'" /><param name="allowScriptAccess" value="sameDomain" /></object>';return b};saw.dashboard.handleCopyLinkFlashMovies=function(n,j){if(!is_ie){return}var e=j.getElementById("idStatePathDiv");var k;if(e){k=e.getAttribute("statePath")}var c;var a;var l;var m;var d;var h=j.getElementById(k);if(h){d="copy2cliptest"+k;var g=j.getElementById(d);l=g.getAttribute("classid");m=g.getAttribute("codeBase");for(var f=0;f<g.childNodes.length;++f){var b=g.childNodes[f];if(b.getAttribute("name").toLowerCase()=="flashvars"){a=b.getAttribute("value")}if(b.getAttribute("name").toLowerCase()=="movie"){c=b.getAttribute("value")}}n.push({clipBoardSpanId:k,classid:l,codeBase:m,objectEleId:d,movieValue:c,flashValue:a})}};saw.dashboard.transferToParent=function(d,a,e){var c=d.getBlockById("head").data;var b=new obips.Callback(null,function(){saw.dashboard.transferToParentImpl(d,a,e)});saw.ondemandload.addHtmlFragments(c,null,null,b)};saw.dashboard.transferToParentImpl=function(h,n,l){if(!vRefresh){saw.dashboard.impl.setReloadView(-1,true)}var k=saw.getExistingResourceFiles(null,saw.ResourceTypes.SCRIPT);var f=saw.getExistingResourceFiles(null,saw.ResourceTypes.CSS);var c=(saw.userAgent.is_ie7||saw.userAgent.is_ie8)?null:saw.createHiddenIFrame(sEmbedFrameID,sEmbedFrameID);saw.dashboard.preHandleViewStates(h,c,f,k);var j=[];var m=[];var g=[];var d=0;try{var a=saw.dashboard.handleMinimizeSections(h,c,f,k);if(a){g.push(a)}d++;a=saw.dashboard.handleSectionsAndReports(h,c,n,j,m,f,k);if(a){g.push(a)}d++;a=saw.dashboard.handlePrompts(h,c,f,k);if(a){g.push(a)}d++;a=saw.dashboard.handleBIPublisherReportsLinks(h,c,f,k);if(a){g.push(a)}d++;a=saw.dashboard.handleScorecardsKPI(h,c,f,k);if(a){g.push(a)}d++;a=saw.dashboard.handleIFramesBIPublisherReports(h,c,f,k);if(a){g.push(a)}d++;a=saw.dashboard.handleTextsLinksURLsImagesActionLinks(h,c,f,k);if(a){g.push(a)}d++;a=saw.dashboard.postHandleViewStates(h,c,n,j,f,k);if(a){g.push(a)}d++;a=saw.dashboard.handleCopyXml(h,c,m,f,k);if(a){g.push(a)}d++;a=saw.dashboard.finishLoading(l);if(a){g.push(a)}d++}catch(b){var e="item "+d+" "+saw.getStackTraceFromError(b);g.push(e);if(g.length>0&&obips.selenium&&obips.selenium.testEnabled){alert(e)}throw b}if(g.length>0&&obips.selenium&&obips.selenium.testEnabled){alert(g.toString())}};saw.dashboard.preHandleViewStates=function(e,d,c,f){var a=e.getBlockById("pageMetadata").data;var b=a.reloadTargets.split(",");saw.aViewsToRefresh=[];obips.Array.forEach(b,function(g){if(g){saw.aViewsToRefresh[g]=true}})};saw.dashboard.handleMinimizeSections=function(j,b,e,l){for(var f=0;f<vSecIds.length;f++){var a=vSecIds[f];if(saw.dashboard.needsRefresh(a)){var m=j.getBlockById(a+"Content");if(!m){continue}var g=saw.dashboard.parseHTMLInDocument(m.data,b?b.contentDocument:null);var d="Embed"+a;var h=g.getElementById(d);var k=document.getElementById(d);if(k!=null&&h!=null){var c=h.getAttribute("minimized");if(c!="true"){k.innerHTML=h.innerHTML;k.setAttribute("loaded","true")}vSecRefresh[a]=false;k.setAttribute("minimized",c);saw.ajax.loadCSSFiles(m.data,null,e);saw.ajax.evalScriptsInString(m.data,l)}}}return null};saw.dashboard.handlePrompts=function(j,b,e,l){for(var f=0;f<vGFPIds.length;f++){var a=vGFPIds[f];var m=j.getBlockById(a+"Content");if(!m){continue}var g=saw.dashboard.parseHTMLInDocument(m.data,b?b.contentDocument:null);var d="EmbedView"+a;var h=g.getElementById(d);var k=document.getElementById(d);var c=document.getElementById(a+"Result");if(k!=null&&h!=null){if((c&&c.result!="searching")&&(c.loaded&&c.loaded=="true"||!c.loaded)&&(!saw.dashboard.needsRefresh(a)||bFirstLoad)){vGFPRefresh[a]=false;continue}XUICloseActiveDiv();obips.views.ViewController.updatePromptContent(a,k,h,c,m);k.setAttribute("loaded","true");vGFPRefresh[a]=false;saw.ajax.evalScriptsInString(m.data,l)}}};saw.dashboard.handleBIPublisherReportsLinks=function(j,b,e,l){for(var f=0;f<vFormattedReportLinkIds.length;f++){var a=vFormattedReportLinkIds[f];var m=j.getBlockById(a+"Content");if(!m){continue}var g=saw.dashboard.parseHTMLInDocument(m.data,b?b.contentDocument:null);var d="EmbedView"+a;var h=g.getElementById(d);var k=document.getElementById(d);var c=document.getElementById(a+"Result");if(k!=null&&h!=null){if((c&&c.result!="searching")&&(c.loaded&&c.loaded=="true"||!c.loaded)&&(!vFormattedReportLinkRefresh[a]||bFirstLoad)){vFormattedReportLinkRefresh[a]=false;continue}k.innerHTML=h.innerHTML;k.setAttribute("loaded","true");vFormattedReportLinkRefresh[a]=false}}};saw.dashboard.handleSectionsAndReports=function(b,B,L,u,I,l,n){var j=L&&L.callerAction||"reload";var p=[];try{var k=[];var r=[];for(var H=0;H<vReportIds.length;H++){var z=vReportIds[H];var a=b.getBlockById(z+"Content");if(!a){continue}var C=(z.indexOf("~n:")>0);var t=(z.indexOf("~s:")>0);var K=(z.indexOf("~r:")>0);if(K){r.push({sID:z,tRespBlock:a})}else{if(C){p.push({sID:z,tRespBlock:a})}else{if(t){k.push({sID:z,tRespBlock:a})}else{r.push({sID:z,tRespBlock:a})}}}}for(var H=0;H<k.length;H++){p.push(k[H])}for(var H=0;H<r.length;H++){p.push(r[H])}}catch(x){var y="ii# sort "+saw.getStackTraceFromError(x);if(obips.selenium&&obips.selenium.testEnabled){alert(y)}throw x}var H=0;for(;H<p.length;H++){var z=p[H].sID;var a=p[H].tRespBlock;if(!a){continue}var E=null;try{E=saw.dashboard.parseHTMLInDocument(a.data,B?B.contentDocument:null)}catch(x){var y="report parsing html id= "+z+" i = "+H+" data = "+a.data+" stacktrace "+saw.getStackTraceFromError(x);if(obips.selenium&&obips.selenium.testEnabled){alert(y)}throw x}var C=(z.indexOf("~n:")>0);try{saw.dashboard.handleCopyLinkFlashMovies(I,E)}catch(x){var y="report copylink flash movies  id= "+z+" i = "+H+" stacktrace "+saw.getStackTraceFromError(x);if(obips.selenium&&obips.selenium.testEnabled){alert(y)}throw x}try{var A="EmbedView"+z;var q=E.getElementById(A);var d=document.getElementById(A);var G=document.getElementById(z+"Result");var F=E.getElementById(z+"Result");var f=E.getElementById(z+"NavDone");var g=E.getElementById(z+"NavSearch");var s=E.getElementById(z+"NavContent");if(F!=null){var h=false;if(F.getAttribute("result")!="searching"){try{if(q!=null){if(g!=null&&f!=null){var w=f.getAttribute("doneflag");if(w==null||w!="true"){g.style.display="none";g.style.position="absolute";try{f.setAttribute("doneflag","true")}catch(J){}if(C){var o=F.getAttribute("needReload");if(o&&o=="false"){if(d!=null&&q!=null){if(G){G.setAttribute("result",F.getAttribute("result"))}d.setAttribute("loaded","true");if(F.getAttribute("result")!="searching"){vRefresh[z]=false}}continue}}if(F.getAttribute("result")=="errorStop"){if(C&&!h){saw.dashboard.destroyObjectsInConditionalSection(z);h=true}q.innerHTML=F.innerHTML}else{if(F.getAttribute("result")=="finished"&&F.getAttribute("conditionMet")=="false"){if(C&&!h){saw.dashboard.destroyObjectsInConditionalSection(z);h=true}q.innerHTML=""}}if(s!=null){s.style.display=""}}}}}catch(D){var y=saw.getStackTraceFromError(D)+" : \nreport/section result not searching id="+z+" i="+H;if(obips.selenium&&obips.selenium.testEnabled){alert(y)}throw D}}else{if(q!=null){vRefresh[z]=true}}if(d!=null&&q!=null){var M=false;try{M=(G&&G.getAttribute("minimized")&&G.getAttribute("minimized")=="true"&&j=="maximize")?true:false;if((G&&G.getAttribute("result")!="searching"&&!M)&&(G.getAttribute("loaded")=="true"||!G.getAttribute("loaded"))&&(!saw.dashboard.needsRefresh(z)||bFirstLoad)){vRefresh[z]=false;continue}}catch(D){var y=saw.getStackTraceFromError(D)+" : \nreport/section actualresultDiv id="+z+" i="+H;if(obips.selenium&&obips.selenium.testEnabled){alert(y)}throw D}if(saw.dashboard.needsRefresh(z)||bFirstLoad||M||(G&&G.getAttribute("result")=="searching")){if(!C){try{u.push(z);obips.views.ViewController.updateReportContent(z,d,q,G,a,L)}catch(D){var y=saw.getStackTraceFromError(D)+" : \nreport/section updateReportConent id="+z+" i="+H;if(obips.selenium&&obips.selenium.testEnabled){alert(y)}throw D}}else{var v=false;if(v){}else{try{if(C&&!h){saw.dashboard.destroyObjectsInConditionalSection(z);h=true}if(saw.userAgent.is_ie){saw.clearInnerHTML(d);while(q.firstChild){d.appendChild(q.firstChild)}}else{d.innerHTML=q.innerHTML}}catch(D){var y=saw.getStackTraceFromError(D)+" : \nreport/section reload conditonal xml id="+z+" i="+H+" \nhtml = "+q.innerHTML;if(obips.selenium&&obips.selenium.testEnabled){alert(y)}throw D}}}}if(G){G.setAttribute("result",F.getAttribute("result"))}d.setAttribute("loaded","true");if(F.getAttribute("result")!="searching"){vRefresh[z]=false}var m=d.getElementsByTagName("iframe");if(m){for(var N=0;N<m.length;N++){var c=m[N].getAttribute("pSrc");if(c){m[N].src=c}}}}saw.ajax.loadCSSFiles(a.data,null,l);saw.ajax.evalScriptsInString(a.data,n,null,true)}}catch(x){var y=saw.getStackTraceFromError(x)+" : \nreport/section outer id="+z+" i="+H;if(obips.selenium&&obips.selenium.testEnabled){alert(y)}throw x}}return null};saw.dashboard.handleScorecardsKPI=function(q,g,e,k){for(var b=0;b<vScorecardIds.length;++b){var m=null;var h=vScorecardIds[b];if(!vScorecardRefresh[h]){continue}var p=q.getBlockById(h+"Content");if(!p){continue}if(globalRegister&&globalRegister.getObject){var c=globalRegister.getObject(h);if(c){var g=document.getElementById(h);if(g.contentWindow&&g.contentWindow.dimensionModel){var o=obips.XMLDOM.createXMLDomFromString(p.data);var l=obips.XMLDOM.selectNodes(o,"//sawsel:appliedStates",saw.xml.commonNamespaces);var d=l[0];var f=l[1];var s;for(var n=0;n<vScorecardObjects.length;n++){if(vScorecardObjects[n].id==h){s=vScorecardObjects[n].type;break}}if(s=="kpiContributionWheel"){var a=c._controller.getDimensionValuesFromPromptElements(d,f);c.applyExternalDimensionValues(a)}else{var r=(d)?obips.XMLDOM.getXMLString(d):null;var t=(f)?obips.XMLDOM.getXMLString(f):null;g.contentWindow.dimensionModel.updateDimensionModels(r,t);c.updateAssessments()}}vScorecardRefresh[h]=false}}}return null};saw.dashboard.handleIFramesBIPublisherReports=function(h,b,d,k){for(var c=0;c<vFormattedReportIds.length;++c){var g=null;var a=vFormattedReportIds[c];if(!vFormattedReportRefresh[a]){continue}var l=h.getBlockById(a+"Content");if(!l){continue}var e=saw.dashboard.parseHTMLInDocument(l.data,b?b.contentDocument:null);g=e.getElementById(a);if(g!=null){var f=document.getElementById(vFormattedReportIds[c]);if(f!=null){var j=g.getAttribute("pSrc");if(j){f.src=j}vFormattedReportRefresh[a]=false}}}return null};saw.dashboard.handleTextsLinksURLsImagesActionLinks=function(j,b,e,m){for(var f=0;f<vSimpleObjectIds.length;f++){var a=vSimpleObjectIds[f];var n=j.getBlockById(a+"Content");if(!n){continue}var g=saw.dashboard.parseHTMLInDocument(n.data,b?b.contentDocument:null);var d="EmbedView"+a;var h=g.getElementById(d);if(!h){h=g.getElementById("idResponseHTMLDiv")}var k=document.getElementById(d);if(k!=null&&h!=null){k.innerHTML=h.innerHTML;saw.ajax.loadCSSFiles(n.data,null,e);saw.ajax.evalScriptsInString(n.data,m)}}var c=vReportIds;for(var f=0;f<c.length;f++){var a=c[f];var n=j.getBlockById(a+"Caption");if(!n){continue}var l=document.getElementById(a+"Caption");if(l){l.innerHTML=n.data;saw.ajax.loadCSSFiles(n.data,null,e);saw.ajax.evalScriptsInString(n.data,m)}}return null};saw.dashboard.postHandleViewStates=function(m,b,p,n,f,o){var g=m.getBlockById("pageMetadata").data;var e=m.getBlockById("viewState");if(e){saw.ajax.evalScriptsInString(e.data,o)}var l=m.getBlockById("onload");if(l){saw.ajax.evalScriptsInString(l.data,o)}var k=document.getElementById("idViewStateDiv");var a=k.getAttribute("statePath");var d=obips.views.ViewController.getController(a);d.setViewEnv(g.viewEnv,p.viewActions,p.serverCallOptions);var h=d.getClientStateManager();if(k){k.setAttribute("stateID",d.viewEnv.viewState);h._loadUpdatedStateXmlFromServer();h._loadSavedSelectionStateXmlForADF();if(document.getElementById("idViewStateDisplay")){document.getElementById("idViewStateDisplay").innerHTML=d.viewEnv.viewState}}for(var c=0;c<n.length;c++){h._loadUpdatedReportXmlFromServer(n[c])}return null};saw.dashboard.handleCopyXml=function(g,e,d,c,h){if(is_ie&&saw.userAgent.is_ie10down){for(var b=0;b<d.length;b++){var f=d[b];var a=document.getElementById(f.clipBoardSpanId);if(a){a.innerHTML=getCopySwf(f.classid,f.codeBase,f.objectEleId,f.movieValue,f.flashValue)}}}return null};saw.dashboard.finishLoading=function(a){bFirstLoad=false;document.body.style.cursor="";tLoadingDoc=null;NQWDefaultCursor();saw.dashboard.reload("ignoreBypassCache");if(a){a.exec()}return null};saw.dashboard.addReportId=function(a){for(var b=0;b<vReportIds.length;b++){var c=vReportIds[b];if(c==a){return}}vReportIds[vReportIds.length]=a};saw.dashboard.addScorecardObject=function(a,f,c,e){for(var b=0;b<vScorecardIds.length;b++){var g=vScorecardIds[b];if(g==a){return}}vScorecardIds[vScorecardIds.length]=a;var d=new Object();d.id=a;d.portalPath=f;d.page=c;d.type=e;vScorecardObjects[vScorecardObjects.length]=d};saw.dashboard.addGFPId=function(a){for(var b=0;b<vGFPIds.length;b++){var c=vGFPIds[b];if(c==a){return}}vGFPIds[vGFPIds.length]=a};saw.dashboard.addFormattedReportLinkId=function(a){for(var b=0;b<vFormattedReportLinkIds.length;b++){var c=vFormattedReportLinkIds[b];if(c==a){return}}vFormattedReportLinkIds[vFormattedReportLinkIds.length]=a};saw.dashboard.addSectionId=function(a){if(!obips.Array.contains(vSecIds,a)){vSecIds.push(a)}};saw.dashboard.markSectionContainer=function(b,a){var c=document.getElementById("sectiontable_"+b);if(c&&obips.selenium&&obips.selenium.testEnabled){c.setAttribute("obitestdbseccaption",a)}};saw.dashboard.addSimpleObjectId=function(a){if(!obips.Array.contains(vSimpleObjectIds,a)){vSimpleObjectIds.push(a)}};saw.dashboard.destroyObjectsInConditionalSection=function(c){var a=c.indexOf("~n:");if(a>0){var b=c.substr(0,a);if(b&&b!=""){if(typeof(PromptManager)!="undefined"){PromptManager.getPromptManager().deleteAllPromptCollectionsInDashboardSection(b)}}}};saw.dashboard.impl.setReloadView=function(a,e){if(!vRefresh){vRefresh=[];vGFPRefresh=[];vFormattedReportLinkRefresh=[];vSecRefresh=[];vFormattedReportRefresh=[];vScorecardRefresh=[]}if(a==-1){for(var c=0;c<vReportIds.length;c++){vRefresh[vReportIds[c]]=e}for(var c=0;c<vGFPIds.length;c++){vGFPRefresh[vGFPIds[c]]=true}for(var c=0;c<vFormattedReportLinkIds.length;c++){vFormattedReportLinkRefresh[vFormattedReportLinkIds[c]]=true}for(var c=0;c<vFormattedReportIds.length;c++){vFormattedReportRefresh[vFormattedReportIds[c]]=true}for(var c=0;c<vScorecardIds.length;c++){vScorecardRefresh[vScorecardIds[c]]=true}}else{var b=0,c=0;for(;c<vReportIds.length;c++){if(vReportIds[c]==a){vRefresh[a]=e;var d=document.getElementById(a+"Result");if(d!=null){d.setAttribute("result","searching")}break}}for(c=0;c<vGFPIds.length;c++){if(vGFPIds[c]==a){vGFPRefresh[a]=e;break}}for(c=0;c<vFormattedReportLinkIds.length;c++){if(vFormattedReportLinkIds[c]==a){vFormattedReportLinkRefresh[a]=e;break}}b=0;for(c=0;c<vSecIds.length;c++){if(vSecIds[c]==a){vSecRefresh[a]=e;break}}for(c=0;c<vFormattedReportIds.length;++c){if(vFormattedReportIds[c]==a){vFormattedReportRefresh[a]=e;break}}for(c=0;c<vScorecardIds.length;++c){if(vScorecardIds[c]==a){vScorecardIds[a]=e;break}}}};saw.dashboard.impl.getReloadCall=function(b){var a=document.getElementById("idReloadCall");if(a){return a.getAttribute("call")}else{return b}};saw.dashboard.getSearchingIds=function(c){var b=c?c+",":"";var a=vReportIds.length;for(var e=0;e<a;e++){var g=vReportIds[e];if(g==c){continue}var f=document.getElementById(g+"Result");if(f!=null&&f.getAttribute("result")=="searching"){if(g.lastIndexOf("r:navReport")!=-1){g=g.substr(0,g.length-12)}b+=g+","}}for(var d=0;d<vGFPIds.length;d++){var g=vGFPIds[d];if(g==c){continue}var f=document.getElementById(g+"Result");if(f!=null&&f.getAttribute("result")=="searching"){b+=g+","}}if(b){b=b.substr(0,b.length-1)}return b};saw.dashboard.getDashboardViewController=function(){var c=document.getElementById("idViewStateDiv");var b=c.getAttribute("statePath");var a=obips.views.ViewController.getController(b);return a};saw.dashboard.getDashboardClientStateManger=function(){return saw.dashboard.getDashboardViewController().getClientStateManager()};saw.dashboard.reload=function(b){var c=saw.dashboard.getDashboardClientStateManger();c.finishGlobalLevelClientStateChange();var a=saw.dashboard.getSearchingIds();if(!a){setTimeout(function(){saw.createHiddenIFrame(sEmbedFrameID,sEmbedFrameID)},100);return}else{setTimeout(function(){var d=saw.createHiddenIFrame(sEmbedFrameID,sEmbedFrameID);var e=a;setTimeout(function(){saw.dashboard._reloadAlt(e,b)},200)},100)}};saw.dashboard._reloadAlt=function(b,d){var h=document.getElementById(sEmbedFrameDivID);if(h){var g=true;if(g){var c={IgnoreBypassCacheOption:d};var a={commandRequest:obips.views.ViewController.CommandRequest.CURRENT,loadingIndicator:new saw.ajax.DummyLoadingIndicator(),actionProperties:{searchingReports:b}};if(obips.views.ViewController.handleViewAction("","",c,a,null,{canChangeStateId:false})){return}}else{var f=saw.createFormFromString(h.getAttribute("src"));f.ViewState.value=document.getElementById("idViewStateDiv").getAttribute("stateID");saw.addHiddenInput(f,"reloadTargets",b);var e=new saw.ajax.Request(saw.commandToURL(saw.dashboard.impl.getReloadCall()),saw.dashboard.transferToParent,null,"reload");e.setFatalErrorHandler(saw.dashboard.showError);saw.ajax.createConnection(e).postForm(f)}}};saw.dashboard.remove_height_width=function(c){var b="";var a=c.split(";");for(i=0;i<a.length;i++){if((-1!=a[i].search("height"))){}else{b=b.concat(a[i]);b=b.concat(";")}}return b};saw.dashboard.setSectionStyle=function(d,e,a){var b=d.childNodes;for(var c=0;c!=b.length;c++){if(b[c].nodeType==1){if(b[c].nodeName=="TABLE"){if(a==true&&e==""){e="border:none;"}b[c].style.cssText=e}}}};saw.dashboard.getSectionStyle_trim=function(d){var a=d.childNodes;var e="";for(var b=0;b!=a.length;b++){if(a[b].nodeType==1){if(a[b].nodeName=="TABLE"){e=a[b].getAttribute("style");if(typeof e=="object"&&e!=null){e=e.cssText.toLowerCase()}var c="";if(e!=null){c=saw.dashboard.remove_height_width(e)}a[b].style.cssText=c;break}}}return e};saw.dashboard.onToggleSection=function(o,b){var j=document.getElementById(o+"Contents");var l=document.getElementById(o+"Max");var g=document.getElementById(o+"Min");var m=document.getElementById("Embed"+o);var f=saw.getFirstChildElement(m);var e=f&&f.rows&&f.rows[0].cells[0];var n="minimize";var p=saw.dashboard.isSectionMinimized(o);if(p&&p.bSectionExist&&p.bSectionMinimized){n="maximize"}var a=false;if(m.getAttribute("headeron")=="true"){a=true}var d="";if(j){if(n=="maximize"){var h=document.getElementById(o+"SearchingImg");if(h){h.style.display=""}j.style.display="";l.style.display="none";if(l.getAttribute("name")=="FirstSectionElement"){l.tabIndex=-1;l.removeAttribute("name");g.tabIndex=0;g.setAttribute("name","FirstSectionElement")}g.style.display="";if(e){obips.CSS.removeClassFromElement(e,"AccordionPaneCollapsed")}m.setAttribute("minimized","false");for(var k=0;k<vSecIds.length;k++){var c=vSecIds[k];if(c==o){d=sSectionIdStyleInfo[o];saw.dashboard.setSectionStyle(m,d,a);break}}}else{if(n=="minimize"){j.style.display="none";g.style.display="none";if(g.getAttribute("name")=="FirstSectionElement"){g.tabIndex=-1;g.removeAttribute("name");l.tabIndex=0;l.setAttribute("name","FirstSectionElement")}l.style.display="";if(e){obips.CSS.addClassToElement(e,"AccordionPaneCollapsed")}m.setAttribute("minimized","true");d=saw.dashboard.getSectionStyle_trim(m)}}saw.dashboard.addSectionId(o);sSectionIdStyleInfo[o]=d;vSecRefresh["Embed"+o]=true;obips.views.ViewController.handleViewAction(n,o);saw.dashboard.resizeLayout()}};saw.dashboard.isSectionMinimized=function(b){var f=false;var c=false;var d=true;var e=document.getElementById("Embed"+b);if(e){f=true;if(e.getAttribute("minimized")=="true"){c=true}}else{var a=document.getElementById("EmbedView"+b+"~n:condition");if(a){f=true;d=false}}return{bSectionExist:f,bSectionMinimized:c,bConditionalMet:d}};saw.dashboard.isObjectInMinimizedOrNotVisibleSection=function(c){if(c==null||c==""){return false}for(var a=0;a<vSecIds.length;a++){var d=vSecIds[a];if(c.indexOf(d)==0){var b=saw.dashboard.isSectionMinimized(d);if(b&&b.bSectionExist){if(b.bSectionMinimized||!b.bConditionalMet){return true}}}}return false};saw.dashboard.showError=function(e,b){var d=document.getElementById("DashboardErrorDiv");for(var c=0;c<b.length;c++){var a=b[c].getMessage();var f=document.createElement("div");f.appendChild(document.createTextNode(a));d.appendChild(f)}d.style.display=""};saw.dashboard.parseHTMLInDocument=function(g,f){var a=f;if(!a){a=document.createDocumentFragment()}else{var c=f.getElementsByTagName("base")[0];if(!c){c=f.createElement("base");c.href=saw.getBaseURL();var d=f.getElementsByTagName("head")[0];if(d){d.appendChild(c)}}}var h=a.getElementById("idResponseHTMLDiv");if(h){while(h.childNodes.length){h.removeChild(h.firstChild)}}else{h=a.createElement("div")}h.id="idResponseHTMLDiv";if(h.style){h.style.display="none"}if(a.body){a.body.appendChild(h)}else{a.appendChild(h)}var e=h;var b=g;if(typeof(g)!="undefined"&&g!=null&&g!=""){b=saw.ondemandload.removeScriptAndCSS(g);var b=saw.ltrim(b);if(b.indexOf("<tr ")==0||b.indexOf("<tr>")==0){b="<table>"+b+"</table>"}else{if(b.indexOf("<td ")==0||b.indexOf("<td>")==0){b="<table><tr>"+b+"</tr></table>"}}}e.innerHTML=b;return a};saw.replaceImageSrc=function(m){var d=/src\=\"(.*)\"/i;var e=/<img.*?>/i;var h=document;var f=document.getElementsByTagName("img");var l=document.getElementsByTagName("script");for(var c=0;c<f.length;++c){var n=f[c];var g=n.getAttribute("src");var a=g.indexOf("./");var b="";if(a>=0){b=g.substr(a+1)}else{var j=g.lastIndexOf("/");if(j>=0){var k=g.substr(0,j-1);j=k.lastIndexOf("/");b=g.substr(j)}}var o=m;o+=("&Path="+saw.encodeURIComponent(b));n.src=o}};WorksheetLoader=function(a){this.eid=a};WorksheetLoader.prototype.loadWorksheet=function(){saw.loadWorksheetUrl(this.eid)};saw.loadWorksheetUrl=function(b,c){var a=parent.document.getElementById(b);if(a&&a.status&&a.status=="ready"){return}var f=a.getAttribute("onloadSrc");if(c&&c!=""&&c!=a.getAttribute("sawdiscoquerykey")){f=f.replace(new RegExp("&QueryKey=[^&]*","gi"),"")}if(f.indexOf("&QueryKey=")<0){f+=("&QueryKey="+saw.encodeURIComponent(c));a.setAttribute("onloadSrc",f);a.setAttribute("sawdiscoquerykey",c)}f+="&eid="+saw.encodeURIComponent(b);f+=("&timebuster="+new Date().getTime());var e=new sawr.serverRequest(f,saw.processWorksheet);var d=new sawr.xhrConnection(e);d.get()};saw.processWorksheet=function(f){var g=f.getXML();var j=g.selectSingleNode("//result");var e=j.getAttribute("status");var b=j.getAttribute("eid");if(e=="ready"){var d=parent.document.getElementById(b);var c=(null!=d.src)?d.src:d.getAttribute("src");if(c.indexOf("&QueryKey=")<0){var a=d.getAttribute("sawdiscoquerykey");c+=("&QueryKey="+saw.encodeURIComponent(a))}c+="&status=ready";d.src=c;d.status="ready"}else{if(e=="failed"){}else{var h=new WorksheetLoader(b);h.loadWorksheet()}}};saw.submitWorksheetParameters=function(c,d){var a=parent.document.getElementById(c);if(a&&a.status&&a.status=="ready"){return}var f=parent.document.getElementById("idWorksheetParametersTable");if(!f){return}var h=f.rows.length;if(h==0){return}d+=("&nParams="+h);for(var e=0;e<f.rows.length;e++){var g=XUIGetAttributeBool(f.rows[e],"isRequired",false);var b=f.rows[e].cells[1].firstChild;d+=("&discovererParamName"+e+"="+saw.encodeURIComponent(b.name));d+=("&discovererParamValue"+e+"="+saw.encodeURIComponent(b.value))}d+=("&timebuster="+new Date().getTime());a.src=d};saw.resetIframeStatus=function(b){var a=parent.document.getElementById(b);if(a){a.status=null}};saw.dashboard.postProcessPageSelectHandler=function(a){if(saw.dashboard.revertPriorTabIdInTabBar){saw.dashboard.tabViewer.controller.restoreToPriorTabIndex();saw.dashboard.revertPriorTabIdInTabBar=false}};saw.dashboard.createComponentHeader=function(h,l,k,m,n,f){var c=null;if(m){var e=[];var g;for(var j=0;j<h.length;++j){g=h[j];var d="dashboard_page_"+j;var c=new obips.TabBar.TabModel(d,g.caption,g.descript,true);c.dashboard_page_name=g.name;e.push(c)}c=new obips.TabBar.Model("DashboardPageTabs",obips.TabBar.Model.Level.SECONDARY_LEVEL,e,l,false,true,null,"DashTabsToolbarCell");c.addEventListener(new obips.Observable.EventListener(obips.TabBar.EventType.TAB_SELECTED,new obips.Callback(null,saw.dashboard.pageTabSelectHandler)));c.addEventListener(new obips.Observable.EventListener(obips.TabBar.EventType.AFTER_TAB_SELECTED,new obips.Callback(null,saw.dashboard.postProcessPageSelectHandler)))}var a=saw.dashboard.createOptionsMenu(n);var b=saw.header.FavoriteHeaderMenu.getSingleton();if(b){b.setCurrentItemPath(f)}saw.componentheader.createHeader(c,null,a,obidash.getResourceManager());saw.dashboard.tabViewer=saw.componentheader.getTabbarViewer()};saw.dashboard.createSubPages=function(g,h,k,c){var e=null;if(g!=null){var j=[];for(var f=0;f<g.length;++f){var d=g[f];var b="dashboard_subpage_"+f;var a=new obips.TabBar.TabModel(b,d.caption,d.descript,true);a.dashboard_page_name=d.name;j.push(a)}e=new obips.TabBar.Model("DashboardSubPageTabs",obips.TabBar.Model.Level.QUATERNARY_LEVEL,j,h,false,true,null,"DashTabsToolbarCell");e.addEventListener(new obips.Observable.EventListener(obips.TabBar.EventType.TAB_SELECTED,new obips.Callback(null,saw.dashboard.pageTabSelectHandler)));var l=saw.dashboard.createOptionsMenu(k);saw.componentheader.createSubHeader(e,l,obidash.getResourceManager())}};saw.dashboard.skipToContentEltFinder=function(){if(saw.dashboard.tabViewer){PageTabsHotKeyPressed()}else{currentSectionNumber=null;sectionHotKeyPressed(true)}};saw.dashboard.createOptionsMenu=function(b){if(!obips.ToolbarHeader){return null}var a=[];var e=obidash.getResourceString(obidash.seedResourceFile,"kmsgDashboardPageHelpButton");a.push({sTooltip:e,callback:new obips.Callback(null,saw.dashboard.helpButtonHandler),id:"help",additionalCSSClass:"ComponentHeaderUberBarButtonSpan",additionalImgCSSClass:"ComponentHeaderUberBarImg"});var d=[];if(!saw.getSessionInfos().isEnableSection508()){var g=document.getElementById("DashboardPageOptions");if(b){e=obidash.getResourceString(obidash.seedResourceFile,"kmsgDashboardPageOptionsMenu");icons=new obips.UberBar.IconSet(obidash.getResourceURL(obidash.seedResourceFile,"popupmenu_ena"),obidash.getResourceURL(obidash.seedResourceFile,"popupmenu_dis"),obidash.getResourceURL(obidash.seedResourceFile,"popupmenu_ovr"),obidash.getResourceURL(obidash.seedResourceFile,"popupmenu_dwn"));var c=new obips.UberBar.PopupMenuButtonModel("dashboardpageoptions",icons,"",e,true,"idPersonalizationMenu","ComponentHeaderUberBarButtonSpan",true);d.push(c)}}var f=new obips.ToolbarHeader.Model(a,d);f.bRenderAsToolBarRoles=false;return f};saw.dashboard._setupPageContentDiv=function(a){if(a){a.style.overflow=document.getElementById("dashboard_anchor_div")?"hidden":"auto";if(obips.launcher.Manager.getInstance()._isMobileAppSession()){document.body.style.paddingLeft="0px"}}};saw.dashboard.initialize=function(d){var a=document.getElementById("DashboardPageContentDiv");saw.dashboard._setupPageContentDiv(a);saw.dashboard.resizeAnchorDiv();if(d){return}if(saw.dashboard.tabViewer){saw.dashboard.tabViewer.ensureVisibleSelectedTab()}if(obidash.alertsNode){var b=obips.XMLDOM.parseXML(obidash.alertsNode);var c=obips.XMLDOM.selectSingleNode(b,"Alerts");if(c){saw.dashboard.renderAlertLinks(c)}}saw.header.registerSkipToContentEltFinder(saw.dashboard.skipToContentEltFinder)};saw.dashboard.renderAlertLinks=function(d){if(d!=null&&d.childNodes.length>0){var a=document.getElementById("idDashAlerts");if(a){var b=new saw.alertsui.Model(d);saw.dashboard.alertsViewer=new saw.alertsui.Viewer(b,a);document.getElementById("idDashAlertsRow").style.display=""}}else{var c=document.getElementById("idDashAlertsRow");if(c){c.style.display="none"}}};saw.dashboard.helpButtonHandler=function(){obips.launcher.launchHelp(new saw.help.ModelBase(obidash.getResourceURL(obidash.seedResourceFile,"helpUrlDashboardPage"),null))};saw.dashboard.pageTabSelectHandlerImpl=function(j,d){var c=obidash.getViewController();if(c==null){return false}try{var a=saw.commandToURL(c.getViewEnvParam("currentCommand")||"Dashboard");var b=saw.createForm("dashPageChange",a);var k=c.getViewEnvParam("PortalPath");saw.addHiddenInput(b,"PortalPath",k);saw.addHiddenInput(b,"Page",j);saw.addHiddenInput(b,"icharset",document.charset||document.characterSet);if(d){for(arg in d){saw.addHiddenInput(b,arg,d[arg])}}if(obips.BreadCrumbs){var h=obips.BreadCrumbs.Manager.getSingleton().getPageDelayedState(k,j);if(h){saw.addHiddenInput(b,"PageDelayedState",h)}}var f=null;if(typeof(biadf)!="undefined"&&biadf.syndicate){f={actionType:"DashboardChangePage",portalPath:k,page:j,itemName:j,targetType:biadf.TargetType.kBIDashboard,params:{StateAction:"NewPage"}}}DashboardChangePage(b,f)}catch(g){return false}return true};saw.dashboard.pageTabSelectHandler=function(a){var b=new saw.answers.GrayLoadingMessage("loadViewEditor","DashboardPageContentDiv");b.show();if(saw.dashboard.pageTabSelectHandlerImpl(a.context.dashboard_page_name)==false){saw.dashboard.revertPriorTabIdInTabBar=true;b.hide()}};saw.dashboard.pageTabSelectHandlerForMobile=function(a,b){if(typeof(obips.FloatingWindow)!="undefined"){obips.FloatingWindow.Manager.getSingleton().hideTransientWindow()}saw.dashboard.pageTabSelectHandlerImpl(a,{optimized:b})};saw.dashboard.resizeEmptyDiv=function(){var b=document.getElementById("EmptyDashboardDiv");if(b){var a=document.getElementById("DashboardPageContentDiv");saw.setOuterHeight(b,saw.cssLengthToInt(a.style.height))}};saw.dashboard._setContentContainerSize=function(){if(saw.userAgent.is_ie){if(saw.getClientWidth()==saw.dashboard.lastClientWidth&&saw.getClientHeight()==saw.dashboard.lastClientHeight){return}saw.dashboard.lastClientWidth=saw.getClientWidth();saw.dashboard.lastClientHeight=saw.getClientHeight()}var b;if(saw.componentheader){saw.componentheader.layoutOuterDiv();var c=saw.componentheader.getPageContentOuterDiv();b=saw.cssLengthToInt(c.style.height)}else{b=window.innerHeight}var a=document.getElementById("DashboardPageContentDiv");saw.setOuterHeight(a,b);saw.dashboard._setupPageContentDiv(a);saw.dashboard.resizeAnchorDiv();saw.dashboard.resizeEmptyDiv()};saw.dashboard._hideHorizontalScrollbar=function(b){if(b.offsetHeight<b.scrollHeight&&Math.abs(b.offsetWidth-b.scrollWidth)<5){if(saw.userAgent.is_ie){var a="17px";if(saw.isRToL()){b.style.paddingLeft=a}else{b.style.paddingRight=a}}else{b.style.overflowX="auto";b.style.overflowY="scroll"}}};saw.dashboard.resizeAnchorDiv=function(){var g=document.getElementById("dashboard_anchor_div");if(g){var h=g.getAttribute("anchor");var c=document.getElementById("DashboardPageContentDiv");if(h=="vertical"){var k=saw.cssLengthToInt(c.style.height);var n=saw.getPreviousSiblingElement(g);var d=true;if(!n){n=saw.getNextSiblingElement(g);d=false}while(n){if(n.className=="PageTable"||n.className=="DashboardPageWarningBar"){var j=saw.Region.getRegion(n);if(j){var a=saw.getComputedStyle(n);k-=j.getHeight()+saw.cssLengthToInt(a.marginTop)+saw.cssLengthToInt(a.marginBottom)}}n=d?saw.getPreviousSiblingElement(n):saw.getNextSiblingElement(n);if(!n&&d){d=false;n=saw.getNextSiblingElement(g)}}saw.setOuterHeight(g,k);saw.dashboard._hideHorizontalScrollbar(g);var b=document.getElementById("begin_anchor");if(b){saw.setOuterHeight(b,k);saw.dashboard._hideHorizontalScrollbar(b)}var e=saw.getParentElement(g);if(e&&obips.CSS.isElementClassOf(e,"FitContent")){var l=saw.findFirstDescendant(g,"div","class","FitContent");if(l){obips.CSS.removeClassFromElement(e,"FitContent");if(g.offsetWidth>l.offsetWidth){if(saw.userAgent.is_nav||saw.userAgent.is_ie8){saw.setFloat(g,saw.isRToL()?"right":"left")}obips.CSS.addClassToElement(e,"FitContent")}}}}else{if(h=="horizontal"){var q=saw.getFirstChildElement(c);var m=saw.cssLengthToInt(c.style.height);do{if(q.className=="PageTable"||q.className=="DashboardPageWarningBar"){var j=saw.Region.getRegion(q);if(j){m-=j.getHeight()}}}while(q=saw.getNextSiblingElement(q));saw.setOuterHeight(g,m);saw.dashboard._hideHorizontalScrollbar(g);var b=document.getElementById("begin_anchor");if(b){saw.setOuterHeight(b,m);saw.dashboard._hideHorizontalScrollbar(b)}var p=document.getElementById("end_anchor");if(p){saw.setOuterHeight(p,m);var o=[p];if(b){o.push(b)}var k=saw.Region.getRegion(c).getWidth();for(var f=0;f<o.length;++f){var j=saw.Region.getRegion(o[f]);var a=saw.getComputedStyle(o[f]);k-=j.getWidth()+saw.cssLengthToInt(a.marginLeft)+saw.cssLengthToInt(a.marginRight)}k-=5;saw.setOuterWidth(g,k)}}}}};saw.dashboard.initializeLayout=function(){var a=saw.getSessionInfos().getSyndicate()=="adf"?"PortalBodyADFEmbedded":"PortalBodyInteractiveSyndicate";var b=obips.launcher.Manager.getInstance()._isMobileAppSession()?"MobileHTMLBody":"HTMLBody";obips.CSS.addClassToElement(document.body,saw.getSessionInfos().getSyndicate()?a:b);saw.dashboard._setContentContainerSize();saw.addEventListener(window,"resize",saw.dashboard.resizeLayout)};saw.dashboard.resizeLayout=function(){if(!saw.isCurrentlyInResizeHandler()){saw.checkInResizeHandler();try{saw.dashboard._setContentContainerSize()}catch(a){saw.checkOutResizeHandler();throw a}saw.checkOutResizeHandler()}};saw.dashboard.ViewControllerExt=function(){saw.dashboard.ViewControllerExt.baseConstructor.call(this,"dashboard")};saw.extend(saw.dashboard.ViewControllerExt,obips.views.ViewController.Extension);new saw.dashboard.ViewControllerExt();saw.dashboard.ViewControllerExt.prototype.determineInlineReload=function(c,a,b){if(b.reloadInplace==null){if(b.commandRequest=="current"||saw.getReloadInline(a[0].viewID)||((b.commandRequest=="drill")&&(obips.views.getExpandedViewId()||obips.views.getExpandedMapViewId()))){b.reloadInplace=true}}};saw.dashboard.ViewControllerExt.prototype.prepareViewActionRequest=function(l,a,m,d){var j=d.reloadInplace;var g=this.viewEnv||new obips.views.ViewController.ViewEnv();if(j){saw.createHiddenIFrame(sEmbedFrameID,sEmbedFrameID)}if(g.portalPath){a.PortalPath=g.portalPath}if(g.page){a.Page=g.page}if(g.style){a.Style=g.style}var b="ApplyFilter";var f="PromptAgain";var e="PromptFinishAll";if(m[0].action==f||m[0].action==b||m[0].action==e){a.reloadTargets="all";saw.dashboard.impl.setReloadView(-1,true)}else{var h=obidash.getViewController().isFetchJSDataLayoutActionOnly(m);if(h){a.bNotSaveCommand="true"}var k=obips.Array.map(m,function(n){var o=obips.views.ViewController._getReportStatePath(n.viewID);if(!h){saw.dashboard.impl.setReloadView(o,true)}return o}).join(",");var c=j&&!h?saw.dashboard.getSearchingIds(k):k;a.reloadTargets=c}if(j){d.command=d.command||saw.dashboard.impl.getReloadCall("ReloadDashboard");bFirstLoad=false}};saw.dashboard.ViewControllerExt.prototype.processViewActionResponse=function(g,f,b,d,c,e){var a=new obips.Callback(null,function(){e.exec(c,d)});saw.dashboard.transferToParent(f,{viewActions:d,serverCallOptions:c},a)};saw.dashboard.folder=function(){};saw.dashboard.folder.AnalysisSignature="queryitem1";saw.dashboard.folder.BBSignature="cobriefingbook1";saw.dashboard.folder.filter=function(){saw.dashboard.folder.filter.baseConstructor.call(this,false)};extend(saw.dashboard.folder.filter,saw.catalog.ObjectFilter);saw.dashboard.folder.filter.prototype.canAccept=function(a){if(saw.catalog.isMyCompanySharedFolder(a)){return true}if(a.type==obips.catalog.ItemType.FOLDER){if(!a.isHidden()){return true}else{return false}}else{if(a.type==obips.catalog.ItemType.LINK){switch(a.targetSignature){case saw.dashboard.folder.AnalysisSignature:case saw.dashboard.folder.BBSignature:return true;default:return false}}else{switch(a.signature){case saw.dashboard.folder.AnalysisSignature:case saw.dashboard.folder.BBSignature:return true;default:return false}}}};saw.dashboard.folder.addTypeInfos=function(a){var b=new saw.catalogtree.DndProperties(false,false);a[saw.catalogtree.ksNodeTypeVirtualFolder]=new saw.catalogtree.NodeTypeInfo(saw.catalogtree.ksNodeTypeVirtualFolder,obidash.getResourceURL(obidash.runtimeResourceFile,"treeFolderClosedIcon"),"Folder",true,b,obidash.getResourceURL(obidash.runtimeResourceFile,"treeFolderOpenIcon"));a.Folder=new saw.catalogtree.NodeTypeInfo("Folder",obidash.getResourceURL(obidash.runtimeResourceFile,"treeFolderClosedIcon"),"Folder",true,b,obidash.getResourceURL(obidash.runtimeResourceFile,"treeFolderOpenIcon"));a[saw.dashboard.folder.AnalysisSignature]=new saw.catalogtree.NodeTypeInfo(saw.dashboard.folder.AnalysisSignature,obidash.getResourceURL(obidash.runtimeResourceFile,"treeAnalysisIcon"),"Analysis",false,b);a[saw.dashboard.folder.BBSignature]=new saw.catalogtree.NodeTypeInfo(saw.dashboard.folder.BBSignature,obidash.getResourceURL(obidash.runtimeResourceFile,"treeBBIcon"),"Briefing Book",false,b)};getLinks=function(e){var d=null;var c;if(e.xml!=null){c=saw.parseXML(e.xml);var b=c.selectNodes(".//sawst:container[@xsi:type='sawst:section']");if(b!=null){for(var a=0;a<b.length;++a){d=b[a].getAttribute("links");if(d!=null){break}}}}return d};saw.dashboard.folder.clickHandler=function(m,c){var a=document.getElementById(c);var d=m.context.itemInfo;if(d.type==obips.catalog.ItemType.LINK){try{var f=saw.catalog.getCatalogManager().getItemInfo(d.targetPath);if(f&&!f.isError()&&f.itemInfo){d=f.itemInfo}else{return}}catch(k){return}}switch(d.signature){case saw.dashboard.folder.AnalysisSignature:var l=obidash.getViewController();var b="";if(saw.getSessionInfos().getSyndicate()){b=saw.commandToURL("Go")}else{b=saw.commandToURL("PortalGo");b+="&PortalPath="+saw.encodeURIComponent(l.getViewEnvParam("PortalPath"));b+="&NavFromViewID="+a.getAttribute("navfromviewid")}b+="&Action=Prompt&Path="+saw.encodeURIComponent(d.path);if(l.getViewEnvParam("style")){b+="&Style="+style}if(d.properties.showView){b+="&ViewName="+d.properties.showView}var j=l.getClientStateManager();var n=getLinks(j.clientStateXml);if(n!=null){b+="&Options="+n}if(d.properties.display=="new"){b+="&Done=Close";obips.launcher.launchURL(b,{targetWindow:"_blank"})}else{var g=l.getCommand();g+="&PortalPath="+saw.encodeURIComponent(l.getViewEnvParam("PortalPath"));g+="&Page="+saw.encodeURIComponent(l.getViewEnvParam("Page"));if(obidash){var h=obidash.getCurrPageDelayedState();if(h){g+="&PageDelayedState="+saw.encodeURIComponent(h)}}b+="&Done="+saw.encodeURIComponent(g);obips.launcher.launchURL(b)}break}};saw.dashboard.folder.contextMenuHandler=function(q,c){var a=document.getElementById(c);var d=q.context.treeNode.itemInfo;switch(d.signature){case saw.dashboard.folder.BBSignature:var j=[];var o=obidash.getResourceString(obidash.runtimeResourceFile,"kmsgDashboardEditBriefbook");var l=obidash.getResourceString(obidash.runtimeResourceFile,"kmsgCatalogActionExportMhtml");var e=obidash.getResourceString(obidash.runtimeResourceFile,"kmsgCatalogActionExportPdf");var b=[o,l,e];var m=[];m.push(new obips.Callback(null,function(){var r=new saw.ondemandload.FuncProxy("obips.briefingbook.launchEditBBDialog",{messageTemplate:"kuiAddToBriefingBookDialogHead"});r.exec(d.path)}));var g=saw.commandToURL("DownloadBriefbook");g+="&path="+saw.encodeURIComponent(d.path);var f=g;g+="&format=mhtml";m.push(new obips.Callback(null,function(){obips.launcher.launchURL(g,{targetWindow:"_blank"})}));f+="&format=pdf";m.push(new obips.Callback(null,function(){obips.launcher.launchURL(f,{targetWindow:"_blank"})}));for(var k=0;k<b.length;++k){var n=new obips.ContextMenu.MenuOption(b[k],"",null,m[k]);j.push(n)}var h=new obips.ContextMenu.Model(null,j);var p=q.context.evt;obips.ContextMenu.Manager.getSingleton().displayAtPosition(h,saw.Position.createByEvent(p));saw.stopEventPropagation(p);break}};saw.dashboard.renderFolder=function(c,m,d){var f=saw.catalogtree.createRootNode();var e=new saw.dashboard.folder.filter(false);var j=new saw.catalogtree.Model(null,f,e);var l=saw.catalog.getCatalogManager().getItemInfo(m).itemInfo;var b=[];var k=saw.catalogtree.createVirtualFolderNode(j.rootTreeNode.id,m,l.caption,l);k.isAutoExpanded=true;b.push(k);j.treeModel.setChildrenShortCut(j.rootTreeNode.id,b);var a=[];saw.dashboard.folder.addTypeInfos(a);var h=document.getElementById(c);var g=new saw.catalogtree.Viewer(j,h,a);g.addEventListener(new obips.Observable.EventListener(saw.catalogtree.Viewer.EventType.TREE_NODE_CONTEXT_MENU,new obips.Callback(null,function(n){saw.dashboard.folder.contextMenuHandler(n,c)})));g.addEventListener(new obips.Observable.EventListener(saw.catalogtree.Viewer.EventType.TREE_NODE_CLICKED,new obips.Callback(null,function(n){saw.dashboard.folder.clickHandler(n,c)})));if(h.getAttribute("expand")=="true"){j.getSubItems(m)}};saw.dashboard.openLinkItem=function(a,c,e){if(obips.BreadCrumbs&&obips.history&&e=="page"){var j=obips.history.getQueryStringParameter("PortalPath",a);var l=obips.history.getQueryStringParameter("Page",a);var h=obips.BreadCrumbs.Manager.getSingleton().getPageDelayedState(j,l);if(h){a+="&PageDelayedState="+saw.encodeURIComponent(h)}}if(!(c&&c!="_self")){if(typeof(biadf)!="undefined"&&biadf.syndicate){var d=document.getElementById("idViewStateDiv");var b=(d?d.getAttribute("statePath"):null);if(!b){b="d:dashboard"}var g=obips.views.ViewController.getController(b).getClientStateManager();var f={actionType:"DashboardOpenLinkItem",targetView:b,targetType:biadf.TargetType.kURL,path:a,params:{sUrl:a}};var k=biadf.issueBIAdfGetRptXmlContextualEventCurrentRef(g,f)}}obips.launcher.launchURL(a,{targetWindow:c,mobileModule:e});return false};saw.dashboard.getAnalysisMetaDataInDashboard=function(b,a,c){if(b){var d=b.contentWindow.saw.dashboard.analysisOnDashboardPageAPI(b,a,c);return d}else{return"tFrame is undefined"}};analysisOnDashboardPage=function(d,a,c){var b=[];b.push([d,a,c]);return d};saw.dashboard.analysisOnDashboardPageAPI=function(b,a,c){var e=b.contentWindow.g_oListOfAnalysis;var d=0;if(b.contentWindow.g_oListOfAnalysis){d=b.contentWindow.g_oListOfAnalysis.length}if(a>d||a==0){return"report index is not valid"}return b.contentWindow.saw.dashboard.getDashboardAnalysisMetaData(e,a,c)};saw.dashboard.selenium_verifyReportXML=function(a){var b=a.selectNodes(".//sawx:expr[@xsi:type='sawx:sqlExpression']");if(b!=null){if(b.length==3){saw.dashboard.showMsgDialog("copy link","Copy link feature is OK.",true);return}}saw.dashboard.showMsgDialog("copy link","Copy link feature is broken.",true)};saw.dashboard.getAnalysisMetadataCallback=function(g,d){var b=g.aListOfAnalysis;var f=g.nReportIndex;var e=g.sUserCallback;f=f-1;var c=copyReportXMLToClipBoard("",b[f].sReportViewName,b[f].sReportCaption,b[f].sReportStatePath);var a="";if(c!=null){var j=c.selectSingleNode("sawcl:reportQuery");if(j){var h=j.selectSingleNode("saw:report");if(h){a=saw.getXmlText(h);if(g_SeleniumTestFlag){saw.dashboard.selenium_verifyReportXML(h)}}}}if(e){e(a)}else{return a}};saw.dashboard.getDashboardAnalysisMetaData=function(a,d,c){var b=new Object();b.aListOfAnalysis=a;b.nReportIndex=d;b.sUserCallback=c;saw.ondemandload.loadScripts({messageTemplate:"kuiCopyLink"},null,saw.dashboard.getAnalysisMetadataCallback,null,b)};saw.dashboard.getAnalysisMetaDataInDashboardByIndex=function(a,c){a=a-0;var f=g_oListOfAnalysis;var e=0;if(g_oListOfAnalysis){e=g_oListOfAnalysis.length}if(a>e||a==0){var d="report index is not valid";if(c){return c(d)}else{return d}}var b=saw.dashboard.getDashboardAnalysisMetaData(f,a,c);return b};saw.dashboard.executeFunctionByName=function(c){var d=c.split(".");var b=window;for(var a=0;a<d.length;a++){b=b[d[a]]}return b};saw.dashboard.getAnalysisMetaDataInDashboardByIndexArray=function(d){var a=d.nIndex;var c=d.sUserCallback;if(c==""){c="saw.dashboard.returnReportXML"}var b=saw.dashboard.executeFunctionByName(c);saw.dashboard.getAnalysisMetaDataInDashboardByIndex(a,b)};saw.dashboard.returnReportXML=function(a){return a};saw.dashboard.getReportXMLCallBack=function(a){return a};saw.dashboard.exportToExcel=function(k,m,g,e){var j=new Object;j.format="excel 2007";var b;if(vScorecardObjects.length==0||e){b=new obips.DownloadGuard(j)}var f=document.getElementById("idViewStateDiv");var a=f.getAttribute("statePath");var h=obips.views.ViewController.getController(a).getClientStateManager();if(vScorecardObjects.length>0&&!e){saw.dashboard.handleScorecardItemsForPrint(k,m,"excelx",true,h,g)}else{var d=saw.createForm("dashboardExportToExcelForm",saw.commandToURL("generateDashboardExcel"));saw.addHiddenInput(d,"DownloadId",j.id);saw.createHiddenIFrame("sawDownload","sawDownload",null);d.target="sawDownload";saw.addHiddenInput(d,"Action","Print");saw.addHiddenInput(d,"PortalPath",k);saw.addHiddenInput(d,"Page",m);if(g){saw.addHiddenInput(d,"printCurrentPage","true")}var l=h.getCurrentStateXmlAsString();saw.addHiddenInput(d,"ClientStateXML",l);var c=f.getAttribute("stateID");saw.addHiddenInput(d,"ViewState",c);NQWClearActiveMenu();saw.submitForm(d)}return false};saw.dashboard.handleScorecardItemsForPrint=function(l,o,c,a,h,g){var b=[];for(var e=0;e<vScorecardObjects.length;e++){var m=vScorecardObjects[e];if((m.portalPath==l)&&(m.page==o)){if(globalRegister&&globalRegister.getObject){var n=globalRegister.getObject(m.id);if(n){b.push(n)}}}}var k=new PortalPrintScorecardMonitor(l,o,a,c,b.length,h,g);for(var d=0;d<b.length;d++){var f=b[d];f.myWindow.obips.asyncCall(new f.myWindow.obips.Callback(f,f.updatePrintState),1000,k)}}};