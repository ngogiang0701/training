if(!saw.storage){saw.storage=function(){};saw.storage.HistoryStorage=function(){};saw.storage.HistoryStorage.bDebug=false;saw.storage.HistoryStorage.mMap={};saw.storage.HistoryStorage.bMapLoaded=false;saw.storage.HistoryStorage.textArea=null;saw.storage.HistoryStorage.isDirty=false;saw.storage.HistoryStorage.setValue=function(a,b){saw.storage.HistoryStorage._loadFromForm();saw.storage.HistoryStorage.mMap[a]=b;saw.storage.HistoryStorage.isDirty=true};saw.storage.HistoryStorage.getValue=function(a){saw.storage.HistoryStorage._loadFromForm();var b=saw.storage.HistoryStorage.mMap[a];if(typeof(b)=="undefined"){return null}else{return b}};saw.storage.HistoryStorage.removeValue=function(a){saw.storage.HistoryStorage._loadFromForm();delete saw.storage.HistoryStorage.mMap[a];saw.storage.HistoryStorage.isDirty=true};saw.storage.HistoryStorage.clear=function(){saw.storage.HistoryStorage.textArea.value="";saw.storage.HistoryStorage.mMap={};saw.storage.HistoryStorage.isDirty=true};saw.storage.HistoryStorage.hasValue=function(a){saw.storage.HistoryStorage._loadFromForm();if(typeof saw.storage.HistoryStorage.mMap[a]=="undefined"){return false}else{return true}};saw.storage.HistoryStorage.create=function(){if(document.getElementById("saw_historystorage_textArea_id")){return}var b="position: absolute; top: -1000px; display:none;";if(saw.storage.HistoryStorage.bDebug){b="width: 100px; height: 100px;"}var a="<form style='"+b+"'><textarea id='saw_historystorage_textArea_id' tabIndex='-1' style='"+b+"'></textarea></form>";document.write(a);saw.addEventListener(window,"beforeunload",saw.storage.HistoryStorage._saveToForm)};saw.storage.HistoryStorage._getTextArea=function(){if(!saw.storage.HistoryStorage.textArea){saw.storage.HistoryStorage.textArea=document.getElementById("saw_historystorage_textArea_id")}return saw.storage.HistoryStorage.textArea};saw.storage.HistoryStorage._loadFromForm=function(){if(!saw.storage.HistoryStorage.bMapLoaded){var a;if(saw.storage.HistoryStorage._getTextArea()){a=saw.storage.HistoryStorage._getTextArea().value}if(a!=""&&a!=null){saw.storage.HistoryStorage.mMap=saw.json.parse(a)}saw.storage.HistoryStorage.bMapLoaded=true}};saw.storage.HistoryStorage._saveToForm=function(){if(saw.storage.HistoryStorage.isDirty){saw.storage.HistoryStorage._getTextArea().value=saw.json.toString(saw.storage.HistoryStorage.mMap,true)}};saw.storage.privilegesResourceFile="common/privileges.xml";saw.storage.StorageType={SESSION_STORAGE:"sessionStorage",LOCAL_STORAGE:"localStorage"};saw.storage.ClientStorageManager=function(){var a=obips.getSingleton(saw.storage.ClientStorageManager.SINGLETON_NAME);if(a){return a}globalRegister.addObject(saw.storage.ClientStorageManager.SINGLETON_NAME,this);this.error=null;this.bEnabledClientStorage=saw.storage._getGDExpression("enableClientStorage");this.bSessionStorage=saw.storage._getGDExpression("enableSessionStorage")&&("sessionStorage" in window)&&window.sessionStorage!=null;this.bLocalStorage=saw.storage._getGDExpression("enableLocalStorage")&&("localStorage" in window)&&window.localStorage!=null};saw.storage.ClientStorageManager.SINGLETON_NAME="ClientStorageManager";saw.storage.ClientStorageManager.getSingleton=function(){var a=obips.getSingleton(saw.storage.ClientStorageManager.SINGLETON_NAME);if(!a){a=new saw.storage.ClientStorageManager()}return a};saw.storage.ClientStorageManager.prototype.setState=function(a,f,c,d){try{var h=this._getProvider(c,d);if(h!=null){var b=this._getKey(a);return h.setItem(b,f)}}catch(g){this.error=g;return false}return false};saw.storage.ClientStorageManager.prototype.getState=function(a,d,f){try{var h=this._getProvider(d,f);if(h!=null){var c=this._getKey(a);var b=h.getItem(c);return b}}catch(g){this.error=g;return null}return null};saw.storage.ClientStorageManager.prototype.isSupported=function(a,b){try{this.error=null;if(!this.bEnabledClientStorage&&!b){return false}if(saw.storage.StorageType.SESSION_STORAGE==a){return b||this.bSessionStorage}else{if(saw.storage.StorageType.LOCAL_STORAGE==a){return b||this.bLocalStorage}else{return b||this.bLocalStorage||this.bSessionStorage}}}catch(c){this.error=c;return false}return false};saw.storage.ClientStorageManager.prototype.getError=function(){return this.error};saw.storage.ClientStorageManager.prototype.removeState=function(a,c,d){try{var g=this._getProvider(c,d);if(g!=null){var b=this._getKey(a);return g.removeItem(b)}}catch(f){this.error=f;return false}return false};saw.storage.ClientStorageManager.prototype._getProvider=function(a,b){if(!this.isSupported(a,b)){return null}if(saw.storage.StorageType.SESSION_STORAGE==a){return window.sessionStorage}else{if(saw.storage.StorageType.LOCAL_STORAGE==a){return window.localStorage}}return this.bLocalStorage?window.localStorage:window.sessionStorage};saw.storage.ClientStorageManager.prototype._getKey=function(b){var a=saw.getSessionInfos().user;return this._getObfuscatedGUID(a.guid)+"."+b};saw.storage.ClientStorageManager.prototype._getObfuscatedGUID=function(a){var c="";for(var b=a.length-4;b>0;b=b-2){c=c+a.charAt(b)}return c};saw.storage.ClientStorageManager.prototype._showWarningMsg=function(){};saw.storage._getGDExpression=function(a){return obips.ResourceManager.getSingleton().getGDExpression(saw.storage.privilegesResourceFile,a).value}};