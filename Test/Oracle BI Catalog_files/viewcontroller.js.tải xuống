if(typeof(obips_views_viewcontroller_js)=="undefined"){obips_views_viewcontroller_js=1;(function(){if(!window.obips){obips=function(){}}if(!obips.views){obips.views={}}obips.views.resourceFile="common/saw.viewcontroller.xml";obips.views.EventType={MASTER_DETAIL:"masterDetail",VIEW_EXPAND:"viewZoomIn",VIEW_RESTORE:"viewRestore"};obips.views.Event=function(a,b){this.sourceViewID=a;this.type=b;this.ignoreDefaultHandler=false};obips.views.Event.prototype.getType=function(){return this.type};obips.views.Event.prototype.getGroup=function(){return this.sourceViewID};obips.views.Event.prototype.preventDefault=function(){this.ignoreDefaultHandler=true};obips.views.Event.prototype.getPreventDefault=function(){return this.ignoreDefaultHandler};obips.views.ViewExpandEvent=function(a,d,c,b){obips.views.ViewExpandEvent.baseConstructor.call(this,a,obips.views.EventType.VIEW_EXPAND);this.viewContainer=d;this.clientWidth=c;this.clientHeight=b};saw.extend(obips.views.ViewExpandEvent,obips.views.Event);obips.views.ViewRestoreEvent=function(a){obips.views.ViewExpandEvent.baseConstructor.call(this,a,obips.views.EventType.VIEW_RESTORE)};saw.extend(obips.views.ViewRestoreEvent,obips.views.Event);EventListenerBase=function(a,c,b){this.actionType=c;this.callback=a;this.viewID=b};EventListenerBase.prototype.getListenerId=function(){if(this.viewID){return this.getEventType()+this.getGroup()+this.viewID}return null};EventListenerBase.prototype.getEventType=function(){return this.actionType};EventListenerBase.prototype.getGroup=function(){return this.viewID};EventListenerBase.prototype.canHandle=function(){return true};obips.views.MaterDetailEventListener=function(b,a,c){obips.views.MaterDetailEventListener.baseConstructor.call(this,a,obips.views.EventType.MASTER_DETAIL,c);this.channelID=b;this.getGroup=function(){return this.channelID}};saw.extend(obips.views.MaterDetailEventListener,EventListenerBase);obips.views.MaterDetailEventListener.prototype.canHandle=function(a){return this.viewID!=a.sourceViewID};obips.views.ViewExpandEventListener=function(a,b){obips.views.ViewExpandEventListener.baseConstructor.call(this,a,obips.views.EventType.VIEW_EXPAND,b)};saw.extend(obips.views.ViewExpandEventListener,EventListenerBase);obips.views.ViewRestoreEventListener=function(a,b){obips.views.ViewExpandEventListener.baseConstructor.call(this,a,obips.views.EventType.VIEW_RESTORE,b)};saw.extend(obips.views.ViewRestoreEventListener,EventListenerBase);obips.views.registerIsViewExpandableCallback=function(b,a){obips.views._aIsViewExpandableCallbacks=obips.views._aIsViewExpandableCallbacks||{};obips.views._aIsViewExpandableCallbacks[b]=a};obips.views.ViewController=function(a){var b=obips.views.ViewController.getManager()._instances;if(b[a]){return b[a]}else{b[a]=this}this.id=a;this.listeners={};this.state=obips.views.ViewController.States.IDLE;this.clientEventQueue=[];this.viewActionQueue=[];this.serverRequestQueue=new ServerRequestQueue(this);this.loadingIndicator=new saw.ajax.LoadingIndicator();this.clientStateManager=new obips.views.ClientStateManager()};obips.views.ViewController.getController=function(a){var b=a.indexOf("m:portlet")==0?obips.views.ViewController._getReportStatePath(a):"bips";return new obips.views.ViewController(b)};obips.views.ViewController.States=function(){};obips.views.ViewController.States.IDLE=0;obips.views.ViewController.States.CLIENT_EVENT_HANDLING=1;obips.views.ViewController.States.SERVER_CALL_IN_PROGRESS=2;obips.views.ViewController.States.SERVER_RESPONSE_HANDLING=4;obips.views.ViewController.prototype.addEventListener=function(d){var f=d.getEventType();if(!this.listeners[f]){this.listeners[f]={}}var e=this.listeners[f][d.getGroup()];if(!e){e=[];this.listeners[f][d.getGroup()]=e}var a=d.getListenerId&&d.getListenerId();if(a){for(var b=0;b<e.length;b++){var c=e[b].getListenerId&&e[b].getListenerId();if(a==c){e[b]=d;return}}}obips.Array.append(e,d,true)};obips.views.ViewController.prototype.removeEventListener=function(b){try{var c=this.listeners[b.getEventType()][b.getGroup()];if(c){obips.Array.remove(c,b)}}catch(a){}};obips.views.ViewController.prototype._postClientEventImpl=function(a,c){var b=this.listeners[c.getType()];var f=b&&b[a];if(f){for(var d=0;d<f.length;++d){var e=f[d];if(e.canHandle(c)){e.callback.exec(c)}if(e!=f[d]){d--}}}};obips.views.ViewController.prototype.pushViewAction=function(a){this.viewActionQueue.push({viewAction:a})};obips.views.ViewController.prototype.postClientEvent=function(b,a){this.postEvent(a,b)};obips.views.ViewController.prototype.postEvent=function(b,a){a=a||b.getGroup();obips.Array.append(this.clientEventQueue,{group:a,evt:b});if(this.state==obips.views.ViewController.States.IDLE){this._handleEventsInQueue()}};obips.views.ViewController.prototype.fireEvent=function(a,b){this._postClientEventImpl(a,b)};obips.views.ViewController.prototype._handleEventsInQueue=function(){this.state=obips.views.ViewController.States.CLIENT_EVENT_HANDLING;while(1){var c=null;if(this.clientEventQueue.length!=0){var b=this.clientEventQueue.shift();var a=b.group;var c=b.evt}if(c){this._postClientEventImpl(a,c)}else{break}}this.state=obips.views.ViewController.States.IDLE;if(this.viewActionQueue.length>0){this._updateViews()}};obips.views.ViewController.prototype._updateViews=function(){var b=[];for(var a=0;a<this.viewActionQueue.length;a++){this.viewActionQueue[a].viewAction.params=this.viewActionQueue[a].viewAction.params||{};this.viewActionQueue[a].viewAction.refreshViewIDs=[this.viewActionQueue[a].viewAction.viewID];b.push(this.viewActionQueue[a].viewAction)}this.viewActionQueue=[];this.handleViewActions(b)};obips.views.ViewController.prototype._updateViewsCB=function(d,a,c,b){this._handleViewActionsResponse(d,a,c,b);this._handleEventsInQueue()};obips.views.MasterDetailEvent=function(b,a){obips.views.MasterDetailEvent.baseConstructor.call(this,b,obips.views.EventType.MASTER_DETAIL);this.sQDR=a};extend(obips.views.MasterDetailEvent,obips.views.Event);ServerRequestQueue=function(a){this.viewController=a;this.running=[];this.waiting=[];this.aborting=[]};ServerRequestQueue.prototype.addAndRun=function(d,c){var a=new ServerRequest(d,c);if(c&&c.sync){this.submitRequest(a);return}if(this.isDuplicate(a)){return}if(this.running.length>0||this.waiting.length>0){if(!a.requireUpToDateStateId(this)){this.submitRequest(a);return}this.checkAndAbortOverwrittenRequest(a)}this.waiting.push(a);var b=0;if(this.running.length==0&&this.waiting.length==1){b=this.waiting[0].getDelayStartMS()}this.runNext(b)};ServerRequestQueue.prototype.runNext=function(d){var b=50;if(this.canProceedToNext()){if(d){b=d}else{var c=this.waiting.shift();this.submitRequest(c)}}if(this.timer){clearTimeout(this.timer);this.timer=null}if(this.waiting.length>0){var a=this;this.timer=setTimeout(function(){a.runNext()},b)}};ServerRequestQueue.prototype.submitRequest=function(a){if(a.isInline()){this.running.push(a)}var b=new obips.Callback(this,this.submitRequestCB);this.viewController.sendViewActionsServerCall(a.viewActions,a.serverCallOptions,b)};ServerRequestQueue.prototype.submitRequestCB=function(d,a,c,b){this.viewController._updateViewsCB(d,a,c,b);this.findRequest(c,b,this.running,true)};ServerRequestQueue.prototype._isAbortedRequest=function(c,b){var a=this.findRequest(c,b,this.aborting,true);return a!=null};ServerRequestQueue.prototype.findRequest=function(e,d,b,a){for(var c=0;c<b.length;c++){if(b[c].viewActions==e){var f=b[c];if(a){b.splice(c,1)}return f}}return null};ServerRequestQueue.prototype.canProceedToNext=function(){for(var a=0;a<this.running.length;a++){if(this.running[a].canChangeStateId(this)){return false}}return true};ServerRequestQueue.prototype.isDuplicate=function(b){var a;for(a=0;a<this.running.length;a++){if(b.isDuplicate(this.running[a])){return true}}for(a=0;a<this.waiting.length;a++){if(b.isDuplicate(this.waiting[a])){return true}}return false};ServerRequestQueue.prototype.canCombine=function(b,a){return false};ServerRequestQueue.prototype.checkAndAbortOverwrittenRequest=function(c){var a=false;for(var b=0;b<this.running.length;b++){var d=this.running[b];if(c.canOverwrite(d)){this.aborting.push(d);this.running.splice(b,1);c.mergeRefreshViewIDs(d);b--;a=true}}for(var b=0;b<this.waiting.length;b++){d=this.waiting[b];if(c.canOverwrite(d)){this.waiting.splice(b,1);c.mergeRefreshViewIDs(d);b--;a=true}}return a};ServerRequest=function(b,a){this.viewActions=b;this.serverCallOptions=a||{}};ServerRequest.prototype.getDelayStartMS=function(){var a=this.viewActions[0].properties||{};return a.delayStartMS||0};ServerRequest.prototype.canChangeStateId=function(a){for(var b=0;b<this.viewActions.length;b++){var c=this.viewActions[b].properties||{};var d=c.canChangeStateId;if(d||d==null&&this.isInline()){return true}}return false};ServerRequest.prototype.requireUpToDateStateId=function(a){for(var b=0;b<this.viewActions.length;b++){var c=this.viewActions[b].properties||{};var d=c.requireUpToDateStateId;if(d||d==null&&this.isInline()){return true}}return false};ServerRequest.prototype.canOverwrite=function(c){if(this.viewActions.length==1&&c.viewActions.length==1){var f=this.viewActions[0];var e=c.viewActions[0];if(f.action=="cancel"&&obips.views.ViewController._getReportStatePath(f.viewID)==obips.views.ViewController._getReportStatePath(e.viewID)){return true}if(f.action=="viewRestore"&&f.viewID==e.viewID){return true}if(f.properties&&e.properties){if(f.properties.isCumulative&&e.properties.isCumulative){if(obips.views.ViewController._getReportStatePath(f.viewID)==obips.views.ViewController._getReportStatePath(e.viewID)){return true}}else{if(f.properties.overwriteId&&f.properties.overwriteId==e.properties.overwriteId){return true}}}var b=this.serverCallOptions.actionProperties&&this.serverCallOptions.actionProperties.searchingReports;if(b){if(e.refreshViewIDs){var d=obips.views.ViewController._getReportStatePath(e.refreshViewIDs[0]);if(d&&b.indexOf(d)>=0){return true}}}var a=c.serverCallOptions;var g=a.actionProperties&&a.actionProperties.searchingReports;if(g){return true}}return false};ServerRequest.prototype.mergeRefreshViewIDs=function(c){var b=this.viewActions[0];var a=c.viewActions[0];if(b.refreshViewIDs){if(a.refreshViewIDs){obips.Array.forEach(a.refreshViewIDs,function(d){obips.Array.append(b.refreshViewIDs,d)})}else{if(obips.views.ViewController._getReportStatePath(b.refreshViewIDs[0])==obips.views.ViewController._getReportStatePath(a.viewID)){b.refreshViewIDs=""}}}};ServerRequest.prototype.isInline=function(){return this.serverCallOptions.reloadInplace};ServerRequest.prototype.isDuplicate=function(b){if(this.viewActions.length!=b.viewActions.length){return false}for(var a=0;a<this.viewActions.length;a++){if(!this.viewActions[a].isDuplicate(b.viewActions[a])){return false}}for(var a in this.serverCallOptions){if(this.serverCallOptions[a]!=b.serverCallOptions[a]){return false}}return true};obips.views.ViewActionProperties=function(){this.isCumulative=null;this.overwriteId=null;this.canChangeStateId=null;this.requireUpToDateStateId=null;this.delayStartMS=0};obips.views.ViewActionProperties.isDuplicate=function(b,a){if(b.isCumulative!=a.isCumulative||b.overwriteId!=a.overwriteId||b.canChangeStateId!=a.canChangeStateId||b.requireUpToDateStateId!=a.requireUpToDateStateId||b.delayStartMS!=a.delayStartMS){return false}return true};obips.views.ViewAction=function(a,c,b,e,d){this.action=a;this.viewID=c;this.refreshViewIDs=typeof(e)=="string"?e.split(","):e;this.params=b;this.properties=d||new obips.views.ViewActionProperties};obips.views.ViewAction.prototype.toJSON=function(){var c={Action:this.action,ViewID:this.viewID};if(this.refreshViewIDs){c.refreshViewIDs=this.refreshViewIDs.join(",")}var a=this.params;if(a){for(var b in a){if(typeof(a[b])=="string"||typeof(a[b])=="number"){c[b]=a[b]}}}return c};obips.views.ViewAction.prototype.isDuplicate=function(b){if(this.viewID!=b.viewID||this.action!=b.action||this.refreshViewIDs!=b.refreshViewIDs){return false}if(this.params!=null&&b.params!=null){for(var a in this.params){if((typeof(this.params[a]=="string")||typeof(this.params[a])=="number")&&(this.params[a]!=b.params[a])){return false}}}else{if(this.params!=b.params){return false}}if(!obips.views.ViewActionProperties.isDuplicate(this.properties,b.properties)){return false}return true};obips.views.ViewAction.prototype.toJSONString=function(){return saw.json.toString(this.toJSON(),true)};obips.views.ViewAction.prototype.getViewState=function(){return this.params&&this.params.ViewState};obips.views.ViewController.ViewEnv=function(){this.enableViewLevelAjax=null;this.portalPath=null;this.page=null;this.viewState=null;this.done=null;this.style=null;this.argMap=null;this.clientStateXml=null};obips.views.ViewController.ViewEnv.parseJSON=function(b){var a=new obips.views.ViewController.ViewEnv();a.enableViewLevelAjax=b.enableViewLevelAjax;a.currentCommand=b.curCmd;a.drillCommand=b.drillCmd;a.goCommand=b.goCmd;a.fmapId=b.fmapid;a.portalPath=b.portalPath;a.page=b.page;a.viewState=b.viewState;a.done=b.done;a.style=b.style;a.argMap=b.argMap;return a};obips.views.ViewController.prototype.setViewEnv=function(d,c,b){if(!this.viewEnv||!this.viewEnv.viewState){this.viewEnv=obips.views.ViewController.ViewEnv.parseJSON(d)}else{var a=new ServerRequest(c,b);if(!c||a.canChangeStateId()){this.viewEnv.viewState=d.viewState}this.viewEnv.argMap=d.argMap}};obips.views.ViewController.prototype._mergeArgs=function(b,a){if(a){for(var c in a){if(typeof(a[c])=="string"||typeof(a[c])=="number"){b[c]=a[c]}}}};obips.views.ViewController._getStatePathWithType=function(b,d){var a=new RegExp(".+~"+d+":[^~]*");var c=b.match(a);return c&&c[0]||null};obips.views.ViewController._getReportStatePath=function(a){return obips.views.ViewController._getStatePathWithType(a,"r")||obips.views.ViewController._getStatePathWithType(a,"g")||a};obips.views.ViewController.prototype._combineViewActions=function(a){for(var c=1;c<a.length;c++){var e=obips.views.ViewController._getReportStatePath(a[c].viewID);var f=a[c];for(var b=0;b<c;b++){var d=a[b];if(e==obips.views.ViewController._getReportStatePath(d.viewID)){if(f.action=="updateReport"&&d.action=="updateReport"){if(f.params&&f.params.ReportXML){d.params=d.params||{};d.params.ReportXML=f.params.ReportXML}if(d.refreshViewIDs){if(f.refreshViewIDs){d.refreshViewIDs=d.refreshViewIDs.concat(f.refreshViewIDs)}else{d.refreshViewIDs=null}}a.splice(c,1);c--;break}else{}}}}};obips.views.ViewController.prototype._getViewState=function(b){var a=b[0].getViewState();return a||this.viewEnv&&this.viewEnv.viewState};obips.views.ViewController.prototype._updateViewState=function(a,d){if(obips.views.ClientStateManager){var c=this.getClientStateManager();this.viewEnv.clientStateXml=c.getCurrentStateXmlAsString()}if(!d){var h=this.viewEnv.done;if(h){if(this.viewEnv.portalPath&&h.indexOf("&PortalPath=")==-1){h+="&PortalPath="+saw.encodeURIComponent(this.viewEnv.portalPath)}if(this.viewEnv.page&&h.indexOf("&Page=")==-1){h+="&Page="+saw.encodeURIComponent(this.viewEnv.page)}if(obidash&&this.viewEnv.page&&h.indexOf("&PageDelayedState=")==-1){var f=obidash.getCurrPageDelayedState();if(f){h+="&PageDelayedState="+saw.encodeURIComponent(f)}}}a=a||this.viewEnv.viewState;if(h&&a){if(h.indexOf("ViewState")<0&&h.indexOf("javascript:")<0){h+="&ViewState="+a}else{var e=h.substr(h.indexOf("ViewState"));var g=e.indexOf("&");if(g<0){g=e.length}var b=new RegExp(e.substr(0,g),"gi");h=h.replace(b,"ViewState="+a)}this.viewEnv.done=h}}};obips.views.ViewController.ServerCallOptions=function(){this.command=null;this.commandRequest=obips.views.ViewController.CommandRequest.CURRENT;this.urlArgs=null;this.actionProperties={};this.reloadInplace=null;this.targetWindow=null;this.loadingIndicator=null;this.sync=false};obips.views.ViewController.prototype._showLoadingIndicator=function(b){var a=b.loadingIndicator||this.loadingIndicator;if(a){a.show()}};obips.views.ViewController.prototype._hideLoadingIndicator=function(b){var a=b.loadingIndicator||this.loadingIndicator;if(a){a.hide()}};obips.views.ViewController.prototype.sendViewActionsServerCall=function(t,k,a,h,l){if(!t||t.length==0){return}this._fireBeforeViewActionEvent(t,k);k=k||new obips.views.ViewController.ServerCallOptions();this.viewEnv=this.viewEnv||new obips.views.ViewController.ViewEnv();var j=this.viewEnv;var r={};var v=this._getViewState(t);var d=j.currentCommand=="PortalGo"||j.currentCommand=="Go";this._updateViewState(v,d);r.ViewState=v;if(j.done){r.Done=j.done}if(!k.ignoreClientStateXml&&saw.checkObjectReference(j.clientStateXml)){r.ClientStateXml=j.clientStateXml}if(j.fmapId){r.fmapId=j.fmapId}obips.views.ViewController.getManager().getExtension(this).prepareViewActionRequest(this,r,t,k);var e=k.command;var p=k.reloadInplace;this._mergeArgs(r,j.argMap);this._mergeArgs(r,k.urlArgs);if(t&&t.length>0){this._combineViewActions(t);if(t.length==1){var f=t[0].toJSON();this._mergeArgs(r,f)}else{var u=obips.Array.map(t,function(i){return i.toJSONString()});r.ViewActions="["+u.join(",")+"]"}}if(!e){e=this.getCommand(k.commandRequest)}if(typeof(biadf)!="undefined"&&biadf.syndicate){var g=this.getClientStateManager();biadf.handleViewControllerPreSubmit(g,r,e,p)}if(p){this._showLoadingIndicator(k);var m={viewActions:t,cb:a,errorCB:h,ctx:l,serverCallOptions:k};var n=new saw.ajax.Request(e,this._sendViewActionsServerCallCB,this,m);n.setLoadingMessageDisplayer(new saw.ajax.DummyLoadingIndicator());n.setFatalErrorHandler(this._handleViewActionsServerCallError);for(var o in r){n.addArg(o,r[o])}this.state=obips.views.ViewController.States.SERVER_CALL_IN_PROGRESS;var b=saw.ajax.createConnection(n);if(k.sync){b.setSync(true)}var q=b.post();if(q){if(q.response&&k.sync){return q.response}else{if(q.response){this._sendViewActionsServerCallCB(q.response,m)}}}}else{var c=saw.commandToURL(e);var s=saw.createForm("",c);if(k.targetWindow){s.target=k.targetWindow}for(var o in r){saw.addHiddenInput(s,o,r[o])}this.state=obips.views.ViewController.States.IDLE;if(obips.launcher!=null&&obips.launcher!="undefined"){obips.launcher.submitForm(s,{mobileModule:k.mobileNav})}this.isNavigatingAway=true}};obips.views.ViewController.CommandRequest=function(){};obips.views.ViewController.CommandRequest.CURRENT="current";obips.views.ViewController.CommandRequest.DRILL="drill";obips.views.ViewController.CommandRequest.GO="go";obips.views.ViewController.prototype.getCommand=function(a){if(a==obips.views.ViewController.CommandRequest.DRILL){return this.viewEnv.drillCommand}else{if(a==obips.views.ViewController.CommandRequest.GO){return this.viewEnv.goCommand}else{return this.viewEnv.currentCommand}}};obips.views.ViewController.prototype._sendViewActionsServerCallCB=function(b,a){if(a.cb){a.cb.exec(b,a.ctx,a.viewActions,a.serverCallOptions)}};obips.views.ViewController.prototype._handleViewActionsResponse=function(d,a,c,b){this.state=obips.views.ViewController.States.SERVER_RESPONSE_HANDLING;if(!this.serverRequestQueue._isAbortedRequest(c,b)){if(b.oCallback){b.oCallback.exec(d,a,c,b)}obips.views.ViewController.getManager().getExtension(this).processViewActionResponse(this,d,a,c,b,new obips.Callback(this,this._endViewActionProcess))}else{this._endViewActionProcess(b,c)}};obips.views.ViewController.prototype._endViewActionProcess=function(c,b){this._hideLoadingIndicator(c);if(!this.isFetchJSDataLayoutActionOnly(b)){if(obips.mobile&&obips.mobile.fireEvent){obips.mobile.fireEvent(obips.mobile.EventType.PAGE_UPDATED,b)}var a=obips.views.getExpandedViewViewer();if(a){a.renderReportLinks()}}this.state=obips.views.ViewController.States.IDLE};obips.views.ViewController.prototype._handleViewActionsServerCallError=function(d,c,a){this._endViewActionProcess(a.serverCallOptions,a.viewActions);if(a&&a.errorCB){a.errorCB.exec(d,c,a.ctx)}else{var b=obips.views.ViewController.getManager().getExtension(this);if(b&&b.handleViewActionFatalError){b.handleViewActionFatalError(d,c,a.ctx)}}};obips.views.ViewController.prototype._fireBeforeViewActionEvent=function(b,a){if(obips.mobile&&obips.mobile.fireEvent){if(!a||(!a.sync&&(!a.actionProperties||!a.actionProperties.searchingReports))){obips.mobile.fireEvent(obips.mobile.EventType.BEFORE_VIEW_ACTION,{viewActions:b,options:a})}}};obips.views.ViewController.prototype.getViewPreviewer=function(a,c){if(c&&c.sync){return null}var b="";if(a){b=a[0].params&&a[0].params.EditorID}if(!b){b=this.viewEnv&&this.viewEnv.argMap&&this.viewEnv.argMap.EditorID}if(b&&typeof(XUIPanel)!="undefined"){return XUIPanel.getEditor(b)}return null};obips.views.ViewController.prototype.getViewEnvParam=function(b){var c=b.toLowerCase();if(this.viewEnv){for(var a in this.viewEnv){if((""+a).toLowerCase()==c){return this.viewEnv[a]}}for(var a in this.viewEnv.args){if((""+a).toLowerCase()==c){return this.viewEnv.args[a]}}for(var a in this.viewEnv.argMap){if((""+a).toLowerCase()==c){return this.viewEnv.argMap[a]}}return this.viewEnv[c]||(this.viewEnv.args&&this.viewEnv.args[b])||(this.viewEnv.argMap&&this.viewEnv.argMap[b])||""}return""};obips.views.ViewController.updatePromptContent=function(d,b,c,e,a){if(typeof(PromptManager)!="undefined"&&PromptManager.updatePromptCollection(d,b,c,e,a)){return}var f=saw.getFirstChildElement(c);if(!f||!saw.getFirstChildElement(f)){return}b.innerHTML=c.innerHTML};obips.views.ViewController.updateReportContent=function(a,m,k,c,h,o){var p=obips.views.ViewController.getController(a).viewEnv;if(p&&p.enableViewLevelAjax){var g=m.ownerDocument==k.ownerDocument;c=c||m.ownerDocument.getElementById(a+"Result");if(c){var d=obips.views.ViewController.getViewContentUpdateHandler(c.getAttribute("viewType"));var l=a+"~v:"+c.getAttribute("viewName");if(d&&d(m,k,h,l,o)){var e=m.ownerDocument.getElementById(a+"Links");if(e){var f=saw.findFirstDescendant(k,"TABLE","id",a+"Links");if(f){if(!g&&saw.userAgent.is_webkit){e.innerHTML=f.innerHTML}else{var q=(g?f:XUIImportNode(e,f));e.parentNode.replaceChild(q,e)}}}return}}}if(saw.userAgent.is_ie){saw.clearInnerHTML(m);var g=m.ownerDocument==k.ownerDocument;var j=(g?k:XUIImportNode(m,k));while(j.firstChild){m.appendChild(j.firstChild)}}else{m.innerHTML=k.innerHTML}var b=obips.views.getExpandedViewId();if(b&&b.indexOf(a)==0){var i=obips.views.getExpandedViewViewer();i.originalViewContainer=document.getElementById(b+"ViewContainer");if(i.originalViewContainer){i.moveOriginalView(false)}else{var n=document.getElementById(a+"Result");if(n&&n.getAttribute("result")=="Error"){i.originalViewContainer=n;i.moveOriginalView(false);var e=document.getElementById(a+"Links");if(e){e.parentNode.removeChild(e)}}}}};obips.views.ViewController.updateViewContent=function(g,a,d,c,b,f){var e=obips.views.ViewController.getViewContentUpdateHandler(g);if(!e||!e(a,d,c,b,f)){if(saw.userAgent.is_ie){saw.clearInnerHTML(a);while(d.firstChild){a.appendChild(d.firstChild)}}else{a.innerHTML=d.innerHTML}}};obips.views.getExpandedViewViewer=function(){return obips.views.expandedViewTracker&&obips.views.expandedViewTracker.expandedViewViewer};obips.views.getExpandedViewId=function(){var a=obips.views.getExpandedViewViewer();return a&&a.getViewID()};obips.views.getExpandedMapViewId=function(){if(obips.Map&&obips.Map.expandedViewID){return obips.Map.expandedViewID}else{return null}};obips.views.ViewController.Manager=function(){this._instances={};this._viewContentUpdateHandlers={};this._extensions=[]};obips.views.ViewController.getManager=function(){if(!obips.views.ViewController._manager){obips.views.ViewController._manager=new obips.views.ViewController.Manager()}return obips.views.ViewController._manager};obips.views.ViewController.Manager.prototype.getExtension=function(c,b){for(var a=this._extensions.length-1;a>=0;a--){if(this._extensions[a].canHandle(c,b)){return this._extensions[a]}}};obips.views.ViewController.registerControllerExtension=function(a){obips.views.ViewController.getManager()._extensions.push(a)};obips.views.ViewController.Extension=function(a){this.id=a||"default";obips.views.ViewController.registerControllerExtension(this)};new obips.views.ViewController.Extension();obips.views.ViewController.Extension.prototype.canHandle=function(b,a){return true};obips.views.ViewController.Extension.prototype.determineInlineReload=function(c,a,b){b.reloadInplace=false};obips.views.ViewController.Extension.prototype.prepareViewActionRequest=function(d,c,a,b){};obips.views.ViewController.Extension.prototype.processViewActionResponse=function(e,a,c,b,d){};obips.views.ViewController.Extension.prototype.handleViewActionFatalError=function(c,b,a){throw new Error(obips.Array.map(b,function(d){return d.getMessage()}).join("\n"))};obips.views.ViewController.getViewContentUpdateHandler=function(a){return obips.views.ViewController.getManager()._viewContentUpdateHandlers[a]};obips.views.ViewController.setViewContentUpdateHandler=function(c,b){var a=obips.views.ViewController.getManager()._viewContentUpdateHandlers;if(a[c]){if(a[c]!=b){throw'View controller handler for view type "'+c+'" has already been registered!'}}else{a[c]=b}};obips.views.ViewController._compoundViewUpdateHandler=function(e,c,a,d,f){var h=saw.findFirstDescendant(c,"DIV","class","ViewLevelAjaxDiv");if(h){var j=saw.getFirstChildElement(h);while(j){var i=saw.findFirstDescendant(e,"TD","vid",j.id);if(i){var b=document.getElementById(j.id+"ExpandedViewContainer")||document.getElementById(j.id+"ViewContainer");var g=b&&b.getAttribute("viewType");obips.views.ViewController.updateViewContent(g,b,j,a,j.id,f)}j=saw.getNextSiblingElement(j)}return true}};obips.views.ViewController.setViewContentUpdateHandler("compoundView",obips.views.ViewController._compoundViewUpdateHandler);obips.views.ViewController.setViewContentUpdateHandler("canvas",obips.views.ViewController._compoundViewUpdateHandler);obips.views.ViewController.handleViewAction=function(a,c,b,d,f,e){if(d){d.oCallback=null}obips.views.ViewController.getController(c).handleViewActions([new obips.views.ViewAction(a,c,b,f?[f]:null,e)],d);return true};obips.views.ViewController.handleViewActionAndReturnViewContent=function(h,e,j,g,d,f){var i=[new obips.views.ViewAction(h,e,j,d?[d]:null,f)];g=g||new obips.views.ViewController.ServerCallOptions();var b=new ServerRequest(i,g);if(g&&g.sync){var a=obips.views.ViewController.getController(e);var c=a.sendViewActionsServerCall(b.viewActions,b.serverCallOptions,null);a._endViewActionProcess(g,b.viewActions);return c}return null};obips.views.ViewController.handleViewActionAndCallback=function(a,d,c,e,g,f,b){if(e&&b){e.oCallback=b}else{e.oCallback=null}obips.views.ViewController.getController(d).handleViewActions([new obips.views.ViewAction(a,d,c,g?[g]:null,f)],e);return true};obips.views.ViewController.drillDown=function(a,c){var b={P0:c.EncodeDrillColumns(),P1:c.EncodeQueryColumns(),P2:c.EncodeValues(),P3:c.EncodeFilterColumns(),P4:c.EncodeCodeColumns(),P5:c.EncodeCodeValues()};if(c.GetReportXmlText()){b.ReportXML=c.GetReportXmlText()}b.PivotAllPages=c.EncodePivotStartingPage();obips.views.ViewController.handleViewAction("drill",a,b,{commandRequest:obips.views.ViewController.CommandRequest.DRILL,mobileNav:"report"});return true};obips.views.ViewController.prototype.handleViewActions=function(c,b){var a=this.isFetchJSDataLayoutActionOnly(c);if(a||this.state!=obips.views.ViewController.States.CLIENT_EVENT_HANDLING){b=b||new obips.views.ViewController.ServerCallOptions();obips.views.ViewController.getManager().getExtension(this).determineInlineReload(this,c,b);this.serverRequestQueue.addAndRun(c,b)}return true};obips.views.ViewController.prototype.isFetchJSDataLayoutActionOnly=function(a){if(a&&a.length==1){if(a[0].action=="FetchJSDataLayout"){return true}}return false};obips.views.ViewController.runURL=function(e){var k=e.match(/\?([^#]*)/);if(k){var a=k[1];var f=a.split("&");var d={};for(var c=0;c<f.length;c++){var l=f[c].indexOf("=");if(l!=-1){var b=saw.decodeURIComponent(f[c].substring(0,l));var j=saw.decodeURIComponent(f[c].substring(l+1,f[c].length));if(b!="_scid"){if(b.toLowerCase()=="viewid"){var g=j}else{if(b.toLowerCase()=="action"){var h=j}else{d[b]=j}}}}}}obips.views.ViewController.handleViewAction(h,g,d)};obips.views.ViewController.getWaitingViewActions=function(e,g){var d=[];var a=obips.views.ViewController.getController(e).serverRequestQueue.waiting;if(a){for(var f=0;f<a.length;f++){var b=a[f].viewActions;for(var c=0;c<b.length;c++){if(!g||b[c].viewID==e){d.push(b[c])}}}}return d};obips.views.ViewController.prototype.setSessionId=function(a){this.sessionID=a};obips.views.ViewController.prototype.getClientStateManager=function(){return this.clientStateManager}})();obips.views._getAnalysisMetadataCallback=function(g,d){var e=g.sReportStatePath;var b=g.sViewName;var f=g.sUserCallback;var c;c=copyReportXMLToClipBoard("",b,"",e);var a="";if(c!=null){var i=c.selectSingleNode("sawcl:reportQuery");if(i){var h=i.selectSingleNode("saw:report");if(h){a=saw.getXmlText(h)}}}f(a)};obips.views.getAnalysisMetadata=function(c,d,b){var a=new Object();a.sReportStatePath=c;a.sViewName=d;a.sUserCallback=b;saw.ondemandload.loadScripts({messageTemplate:"kuiCopyLink"},null,obips.views._getAnalysisMetadataCallback,null,a)};obips.views.getEmbeddedAnalysisMetadata=function(d,c,a){var b=strPortletIDReporPrefix+d;obips.views.getAnalysisMetadata(b,c,a)}};